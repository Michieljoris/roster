<!DOCTYPE html>  <html> <head>   <title>pouch.alphal.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="bootstrap.html">                 bootstrap.js               </a>                                           <a class="source" href="date.html">                 date.js               </a>                                           <a class="source" href="font.html">                 font.js               </a>                                           <a class="source" href="livepage.html">                 livepage.js               </a>                                           <a class="source" href="logger.html">                 logger.js               </a>                                           <a class="source" href="pouch.alpha.min.html">                 pouch.alpha.min.js               </a>                                           <a class="source" href="pouch.alphal.html">                 pouch.alphal.js               </a>                                           <a class="source" href="pouch.html">                 pouch.js               </a>                                           <a class="source" href="utils.html">                 utils.js               </a>                                           <a class="source" href="vow.html">                 vow.js               </a>                                           <a class="source" href="when.html">                 when.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               pouch.alphal.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span> 
<span class="cm">/*! jQuery v1.7.1 jquery.com | jquery.org/license */</span>
<span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">function</span> <span class="nx">cy</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">isWindow</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">?</span><span class="nx">a</span><span class="o">:</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">9</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">defaultView</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">parentWindow</span><span class="o">:!</span><span class="mi">1</span><span class="p">}</span><span class="kd">function</span> <span class="nx">cv</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">ck</span><span class="p">[</span><span class="nx">a</span><span class="p">]){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">f</span><span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="o">+</span><span class="nx">a</span><span class="o">+</span><span class="s2">&quot;&gt;&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">b</span><span class="p">),</span><span class="nx">e</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;display&quot;</span><span class="p">);</span><span class="nx">d</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="o">===</span><span class="s2">&quot;none&quot;</span><span class="o">||</span><span class="nx">e</span><span class="o">===</span><span class="s2">&quot;&quot;</span><span class="p">){</span><span class="nx">cl</span><span class="o">||</span><span class="p">(</span><span class="nx">cl</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;iframe&quot;</span><span class="p">),</span><span class="nx">cl</span><span class="p">.</span><span class="nx">frameBorder</span><span class="o">=</span><span class="nx">cl</span><span class="p">.</span><span class="nx">width</span><span class="o">=</span><span class="nx">cl</span><span class="p">.</span><span class="nx">height</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="nx">b</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">cl</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">cm</span><span class="o">||!</span><span class="nx">cl</span><span class="p">.</span><span class="nx">createElement</span><span class="p">)</span><span class="nx">cm</span><span class="o">=</span><span class="p">(</span><span class="nx">cl</span><span class="p">.</span><span class="nx">contentWindow</span><span class="o">||</span><span class="nx">cl</span><span class="p">.</span><span class="nx">contentDocument</span><span class="p">).</span><span class="nb">document</span><span class="p">,</span><span class="nx">cm</span><span class="p">.</span><span class="nx">write</span><span class="p">((</span><span class="nx">c</span><span class="p">.</span><span class="nx">compatMode</span><span class="o">===</span><span class="s2">&quot;CSS1Compat&quot;</span><span class="o">?</span><span class="s2">&quot;&lt;!doctype html&gt;&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;&lt;html&gt;&lt;body&gt;&quot;</span><span class="p">),</span><span class="nx">cm</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span><span class="nx">d</span><span class="o">=</span><span class="nx">cm</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span><span class="nx">cm</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">d</span><span class="p">),</span><span class="nx">e</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="s2">&quot;display&quot;</span><span class="p">),</span><span class="nx">b</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">cl</span><span class="p">)}</span><span class="nx">ck</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span><span class="o">=</span><span class="nx">e</span><span class="p">}</span><span class="k">return</span> <span class="nx">ck</span><span class="p">[</span><span class="nx">a</span><span class="p">]}</span><span class="kd">function</span> <span class="nx">cu</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="p">{};</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">cq</span><span class="p">.</span><span class="nx">concat</span><span class="p">.</span><span class="nx">apply</span><span class="p">([],</span><span class="nx">cq</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">b</span><span class="p">)),</span><span class="kd">function</span><span class="p">(){</span><span class="nx">c</span><span class="p">[</span><span class="k">this</span><span class="p">]</span><span class="o">=</span><span class="nx">a</span><span class="p">});</span><span class="k">return</span> <span class="nx">c</span><span class="p">}</span><span class="kd">function</span> <span class="nx">ct</span><span class="p">(){</span><span class="nx">cr</span><span class="o">=</span><span class="nx">b</span><span class="p">}</span><span class="kd">function</span> <span class="nx">cs</span><span class="p">(){</span><span class="nx">setTimeout</span><span class="p">(</span><span class="nx">ct</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span><span class="k">return</span> <span class="nx">cr</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">now</span><span class="p">()}</span><span class="kd">function</span> <span class="nx">cj</span><span class="p">(){</span><span class="k">try</span><span class="p">{</span><span class="k">return</span> <span class="k">new</span> <span class="nx">a</span><span class="p">.</span><span class="nx">ActiveXObject</span><span class="p">(</span><span class="s2">&quot;Microsoft.XMLHTTP&quot;</span><span class="p">)}</span><span class="k">catch</span><span class="p">(</span><span class="nx">b</span><span class="p">){}}</span><span class="kd">function</span> <span class="nx">ci</span><span class="p">(){</span><span class="k">try</span><span class="p">{</span><span class="k">return</span> <span class="k">new</span> <span class="nx">a</span><span class="p">.</span><span class="nx">XMLHttpRequest</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">b</span><span class="p">){}}</span><span class="kd">function</span> <span class="nx">cc</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="nx">a</span><span class="p">.</span><span class="nx">dataFilter</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">dataFilter</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">a</span><span class="p">.</span><span class="nx">dataType</span><span class="p">));</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">dataTypes</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="p">{},</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">l</span><span class="p">,</span><span class="nx">m</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">o</span><span class="p">,</span><span class="nx">p</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nx">g</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="nx">g</span><span class="o">&lt;</span><span class="nx">i</span><span class="p">;</span><span class="nx">g</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">g</span><span class="o">===</span><span class="mi">1</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="nx">h</span> <span class="k">in</span> <span class="nx">a</span><span class="p">.</span><span class="nx">converters</span><span class="p">)</span><span class="k">typeof</span> <span class="nx">h</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="p">[</span><span class="nx">h</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()]</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">converters</span><span class="p">[</span><span class="nx">h</span><span class="p">]);</span><span class="nx">l</span><span class="o">=</span><span class="nx">k</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="nx">d</span><span class="p">[</span><span class="nx">g</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">k</span><span class="o">===</span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="nx">k</span><span class="o">=</span><span class="nx">l</span><span class="p">;</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">l</span><span class="o">!==</span><span class="s2">&quot;*&quot;</span><span class="o">&amp;&amp;</span><span class="nx">l</span><span class="o">!==</span><span class="nx">k</span><span class="p">){</span><span class="nx">m</span><span class="o">=</span><span class="nx">l</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">k</span><span class="p">,</span><span class="nx">n</span><span class="o">=</span><span class="nx">e</span><span class="p">[</span><span class="nx">m</span><span class="p">]</span><span class="o">||</span><span class="nx">e</span><span class="p">[</span><span class="s2">&quot;* &quot;</span><span class="o">+</span><span class="nx">k</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">n</span><span class="p">){</span><span class="nx">p</span><span class="o">=</span><span class="nx">b</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nx">o</span> <span class="k">in</span> <span class="nx">e</span><span class="p">){</span><span class="nx">j</span><span class="o">=</span><span class="nx">o</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">===</span><span class="nx">l</span><span class="o">||</span><span class="nx">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">===</span><span class="s2">&quot;*&quot;</span><span class="p">){</span><span class="nx">p</span><span class="o">=</span><span class="nx">e</span><span class="p">[</span><span class="nx">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">k</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">p</span><span class="p">){</span><span class="nx">o</span><span class="o">=</span><span class="nx">e</span><span class="p">[</span><span class="nx">o</span><span class="p">],</span><span class="nx">o</span><span class="o">===!</span><span class="mi">0</span><span class="o">?</span><span class="nx">n</span><span class="o">=</span><span class="nx">p</span><span class="o">:</span><span class="nx">p</span><span class="o">===!</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">n</span><span class="o">=</span><span class="nx">o</span><span class="p">);</span><span class="k">break</span><span class="p">}}}}</span><span class="o">!</span><span class="nx">n</span><span class="o">&amp;&amp;!</span><span class="nx">p</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;No conversion from &quot;</span><span class="o">+</span><span class="nx">m</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot; to &quot;</span><span class="p">)),</span><span class="nx">n</span><span class="o">!==!</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="nx">n</span><span class="o">?</span><span class="nx">n</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span><span class="o">:</span><span class="nx">p</span><span class="p">(</span><span class="nx">o</span><span class="p">(</span><span class="nx">c</span><span class="p">)))}}</span><span class="k">return</span> <span class="nx">c</span><span class="p">}</span><span class="kd">function</span> <span class="nx">cb</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">contents</span><span class="p">,</span><span class="nx">f</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">dataTypes</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">responseFields</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="nx">k</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">g</span><span class="p">)</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">d</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="p">[</span><span class="nx">g</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span><span class="o">=</span><span class="nx">d</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span><span class="k">while</span><span class="p">(</span><span class="nx">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">===</span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="nx">f</span><span class="p">.</span><span class="nx">shift</span><span class="p">(),</span><span class="nx">h</span><span class="o">===</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">h</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">mimeType</span><span class="o">||</span><span class="nx">c</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">(</span><span class="s2">&quot;content-type&quot;</span><span class="p">));</span><span class="k">if</span><span class="p">(</span><span class="nx">h</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">e</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">test</span><span class="p">(</span><span class="nx">h</span><span class="p">)){</span><span class="nx">f</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span><span class="k">break</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="k">in</span> <span class="nx">d</span><span class="p">)</span><span class="nx">j</span><span class="o">=</span><span class="nx">f</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="k">else</span><span class="p">{</span><span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">d</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">converters</span><span class="p">[</span><span class="nx">i</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]]){</span><span class="nx">j</span><span class="o">=</span><span class="nx">i</span><span class="p">;</span><span class="k">break</span><span class="p">}</span><span class="nx">k</span><span class="o">||</span><span class="p">(</span><span class="nx">k</span><span class="o">=</span><span class="nx">i</span><span class="p">)}</span><span class="nx">j</span><span class="o">=</span><span class="nx">j</span><span class="o">||</span><span class="nx">k</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">j</span><span class="p">){</span><span class="nx">j</span><span class="o">!==</span><span class="nx">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">j</span><span class="p">);</span><span class="k">return</span> <span class="nx">d</span><span class="p">[</span><span class="nx">j</span><span class="p">]}}</span><span class="kd">function</span> <span class="nx">ca</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">b</span><span class="p">))</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">e</span><span class="p">){</span><span class="nx">c</span><span class="o">||</span><span class="nx">bE</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">?</span><span class="nx">d</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">e</span><span class="p">)</span><span class="o">:</span><span class="nx">ca</span><span class="p">(</span><span class="nx">a</span><span class="o">+</span><span class="s2">&quot;[&quot;</span><span class="o">+</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">e</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="o">?</span><span class="nx">b</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;]&quot;</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">)});</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="o">!=</span><span class="kc">null</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">b</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">e</span> <span class="k">in</span> <span class="nx">b</span><span class="p">)</span><span class="nx">ca</span><span class="p">(</span><span class="nx">a</span><span class="o">+</span><span class="s2">&quot;[&quot;</span><span class="o">+</span><span class="nx">e</span><span class="o">+</span><span class="s2">&quot;]&quot;</span><span class="p">,</span><span class="nx">b</span><span class="p">[</span><span class="nx">e</span><span class="p">],</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">);</span><span class="k">else</span> <span class="nx">d</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">b_</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">ajaxSettings</span><span class="p">.</span><span class="nx">flatOptions</span><span class="o">||</span><span class="p">{};</span><span class="k">for</span><span class="p">(</span><span class="nx">d</span> <span class="k">in</span> <span class="nx">c</span><span class="p">)</span><span class="nx">c</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">!==</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="p">((</span><span class="nx">g</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">?</span><span class="nx">a</span><span class="o">:</span><span class="nx">e</span><span class="o">||</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="p">{}))[</span><span class="nx">d</span><span class="p">]</span><span class="o">=</span><span class="nx">c</span><span class="p">[</span><span class="nx">d</span><span class="p">]);</span><span class="nx">e</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="o">!</span><span class="mi">0</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">e</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">b$</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">f</span><span class="p">,</span><span class="nx">g</span><span class="p">){</span><span class="nx">f</span><span class="o">=</span><span class="nx">f</span><span class="o">||</span><span class="nx">c</span><span class="p">.</span><span class="nx">dataTypes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">g</span><span class="o">=</span><span class="nx">g</span><span class="o">||</span><span class="p">{},</span><span class="nx">g</span><span class="p">[</span><span class="nx">f</span><span class="p">]</span><span class="o">=!</span><span class="mi">0</span><span class="p">;</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">f</span><span class="p">],</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="nx">h</span><span class="o">?</span><span class="nx">h</span><span class="p">.</span><span class="nx">length</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="nx">a</span><span class="o">===</span><span class="nx">bT</span><span class="p">,</span><span class="nx">l</span><span class="p">;</span><span class="k">for</span><span class="p">(;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">j</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">k</span><span class="o">||!</span><span class="nx">l</span><span class="p">);</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="nx">l</span><span class="o">=</span><span class="nx">h</span><span class="p">[</span><span class="nx">i</span><span class="p">](</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">),</span><span class="k">typeof</span> <span class="nx">l</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="nx">k</span><span class="o">||</span><span class="nx">g</span><span class="p">[</span><span class="nx">l</span><span class="p">]</span><span class="o">?</span><span class="nx">l</span><span class="o">=</span><span class="nx">b</span><span class="o">:</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">dataTypes</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">l</span><span class="p">),</span><span class="nx">l</span><span class="o">=</span><span class="nx">b$</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">l</span><span class="p">,</span><span class="nx">g</span><span class="p">)));(</span><span class="nx">k</span><span class="o">||!</span><span class="nx">l</span><span class="p">)</span><span class="o">&amp;&amp;!</span><span class="nx">g</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">l</span><span class="o">=</span><span class="nx">b$</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="nx">g</span><span class="p">));</span><span class="k">return</span> <span class="nx">l</span><span class="p">}</span><span class="kd">function</span> <span class="nx">bZ</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">typeof</span> <span class="nx">b</span><span class="o">!=</span><span class="s2">&quot;string&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="nx">b</span><span class="p">,</span><span class="nx">b</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">c</span><span class="p">)){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">split</span><span class="p">(</span><span class="nx">bP</span><span class="p">),</span><span class="nx">e</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">;</span><span class="k">for</span><span class="p">(;</span><span class="nx">e</span><span class="o">&lt;</span><span class="nx">g</span><span class="p">;</span><span class="nx">e</span><span class="o">++</span><span class="p">)</span><span class="nx">h</span><span class="o">=</span><span class="nx">d</span><span class="p">[</span><span class="nx">e</span><span class="p">],</span><span class="nx">j</span><span class="o">=</span><span class="sr">/^\+/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">h</span><span class="p">),</span><span class="nx">j</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">h</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">||</span><span class="s2">&quot;*&quot;</span><span class="p">),</span><span class="nx">i</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span><span class="o">||</span><span class="p">[],</span><span class="nx">i</span><span class="p">[</span><span class="nx">j</span><span class="o">?</span><span class="s2">&quot;unshift&quot;</span><span class="o">:</span><span class="s2">&quot;push&quot;</span><span class="p">](</span><span class="nx">c</span><span class="p">)}}}</span><span class="kd">function</span> <span class="nx">bC</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="o">===</span><span class="s2">&quot;width&quot;</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="o">:</span><span class="nx">a</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">b</span><span class="o">===</span><span class="s2">&quot;width&quot;</span><span class="o">?</span><span class="nx">bx</span><span class="o">:</span><span class="nx">by</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="o">!==</span><span class="s2">&quot;border&quot;</span><span class="p">)</span><span class="k">for</span><span class="p">(;</span><span class="nx">g</span><span class="o">&lt;</span><span class="nx">h</span><span class="p">;</span><span class="nx">g</span><span class="o">++</span><span class="p">)</span><span class="nx">c</span><span class="o">||</span><span class="p">(</span><span class="nx">d</span><span class="o">-=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;padding&quot;</span><span class="o">+</span><span class="nx">e</span><span class="p">[</span><span class="nx">g</span><span class="p">]))</span><span class="o">||</span><span class="mi">0</span><span class="p">),</span><span class="nx">c</span><span class="o">===</span><span class="s2">&quot;margin&quot;</span><span class="o">?</span><span class="nx">d</span><span class="o">+=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="o">+</span><span class="nx">e</span><span class="p">[</span><span class="nx">g</span><span class="p">]))</span><span class="o">||</span><span class="mi">0</span><span class="o">:</span><span class="nx">d</span><span class="o">-=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;border&quot;</span><span class="o">+</span><span class="nx">e</span><span class="p">[</span><span class="nx">g</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;Width&quot;</span><span class="p">))</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="k">return</span> <span class="nx">d</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">}</span><span class="nx">d</span><span class="o">=</span><span class="nx">bz</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">b</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">||</span><span class="nx">d</span><span class="o">==</span><span class="kc">null</span><span class="p">)</span><span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="nx">d</span><span class="o">=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span><span class="k">for</span><span class="p">(;</span><span class="nx">g</span><span class="o">&lt;</span><span class="nx">h</span><span class="p">;</span><span class="nx">g</span><span class="o">++</span><span class="p">)</span><span class="nx">d</span><span class="o">+=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;padding&quot;</span><span class="o">+</span><span class="nx">e</span><span class="p">[</span><span class="nx">g</span><span class="p">]))</span><span class="o">||</span><span class="mi">0</span><span class="p">,</span><span class="nx">c</span><span class="o">!==</span><span class="s2">&quot;padding&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">d</span><span class="o">+=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;border&quot;</span><span class="o">+</span><span class="nx">e</span><span class="p">[</span><span class="nx">g</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;Width&quot;</span><span class="p">))</span><span class="o">||</span><span class="mi">0</span><span class="p">),</span><span class="nx">c</span><span class="o">===</span><span class="s2">&quot;margin&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">d</span><span class="o">+=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="o">+</span><span class="nx">e</span><span class="p">[</span><span class="nx">g</span><span class="p">]))</span><span class="o">||</span><span class="mi">0</span><span class="p">);</span><span class="k">return</span> <span class="nx">d</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">}</span><span class="kd">function</span> <span class="nx">bp</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">b</span><span class="p">.</span><span class="nx">src</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span><span class="nx">url</span><span class="o">:</span><span class="nx">b</span><span class="p">.</span><span class="nx">src</span><span class="p">,</span><span class="nx">async</span><span class="o">:!</span><span class="mi">1</span><span class="p">,</span><span class="nx">dataType</span><span class="o">:</span><span class="s2">&quot;script&quot;</span><span class="p">})</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">globalEval</span><span class="p">((</span><span class="nx">b</span><span class="p">.</span><span class="nx">text</span><span class="o">||</span><span class="nx">b</span><span class="p">.</span><span class="nx">textContent</span><span class="o">||</span><span class="nx">b</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">bf</span><span class="p">,</span><span class="s2">&quot;/*$0*/&quot;</span><span class="p">)),</span><span class="nx">b</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">b</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">bo</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span><span class="nx">bh</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">b</span><span class="p">),</span><span class="nx">b</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">outerHTML</span><span class="p">;</span><span class="k">return</span> <span class="nx">b</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">}</span><span class="kd">function</span> <span class="nx">bn</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="nx">b</span><span class="o">===</span><span class="s2">&quot;input&quot;</span><span class="o">?</span><span class="nx">bm</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">:</span><span class="nx">b</span><span class="o">!==</span><span class="s2">&quot;script&quot;</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">a</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="o">!=</span><span class="s2">&quot;undefined&quot;</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">grep</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">),</span><span class="nx">bm</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">bm</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="o">===</span><span class="s2">&quot;checkbox&quot;</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="o">===</span><span class="s2">&quot;radio&quot;</span><span class="p">)</span><span class="nx">a</span><span class="p">.</span><span class="nx">defaultChecked</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">checked</span><span class="p">}</span><span class="kd">function</span> <span class="nx">bl</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="k">typeof</span> <span class="nx">a</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="o">!=</span><span class="s2">&quot;undefined&quot;</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="o">:</span><span class="k">typeof</span> <span class="nx">a</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="o">!=</span><span class="s2">&quot;undefined&quot;</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="o">:</span><span class="p">[]}</span><span class="kd">function</span> <span class="nx">bk</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="p">){</span><span class="nx">b</span><span class="p">.</span><span class="nx">clearAttributes</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="p">.</span><span class="nx">clearAttributes</span><span class="p">(),</span><span class="nx">b</span><span class="p">.</span><span class="nx">mergeAttributes</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="p">.</span><span class="nx">mergeAttributes</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span><span class="nx">c</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="o">===</span><span class="s2">&quot;object&quot;</span><span class="p">)</span><span class="nx">b</span><span class="p">.</span><span class="nx">outerHTML</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">outerHTML</span><span class="p">;</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="o">!==</span><span class="s2">&quot;input&quot;</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="o">!==</span><span class="s2">&quot;checkbox&quot;</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="o">!==</span><span class="s2">&quot;radio&quot;</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="o">===</span><span class="s2">&quot;option&quot;</span><span class="p">)</span><span class="nx">b</span><span class="p">.</span><span class="nx">selected</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">defaultSelected</span><span class="p">;</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="o">===</span><span class="s2">&quot;input&quot;</span><span class="o">||</span><span class="nx">c</span><span class="o">===</span><span class="s2">&quot;textarea&quot;</span><span class="p">)</span><span class="nx">b</span><span class="p">.</span><span class="nx">defaultValue</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">defaultValue</span><span class="p">}</span><span class="k">else</span> <span class="nx">a</span><span class="p">.</span><span class="nx">checked</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">defaultChecked</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">checked</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">checked</span><span class="p">),</span><span class="nx">b</span><span class="p">.</span><span class="nx">value</span><span class="o">!==</span><span class="nx">a</span><span class="p">.</span><span class="nx">value</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span><span class="nx">b</span><span class="p">.</span><span class="nx">removeAttribute</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">expando</span><span class="p">)}}</span><span class="kd">function</span> <span class="nx">bj</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;!!</span><span class="nx">f</span><span class="p">.</span><span class="nx">hasData</span><span class="p">(</span><span class="nx">a</span><span class="p">)){</span><span class="kd">var</span> <span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span><span class="nx">h</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">g</span><span class="p">),</span><span class="nx">i</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">events</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">i</span><span class="p">){</span><span class="k">delete</span> <span class="nx">h</span><span class="p">.</span><span class="nx">handle</span><span class="p">,</span><span class="nx">h</span><span class="p">.</span><span class="nx">events</span><span class="o">=</span><span class="p">{};</span><span class="k">for</span><span class="p">(</span><span class="nx">c</span> <span class="k">in</span> <span class="nx">i</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">i</span><span class="p">[</span><span class="nx">c</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span><span class="nx">d</span><span class="o">&lt;</span><span class="nx">e</span><span class="p">;</span><span class="nx">d</span><span class="o">++</span><span class="p">)</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="o">+</span><span class="p">(</span><span class="nx">i</span><span class="p">[</span><span class="nx">c</span><span class="p">][</span><span class="nx">d</span><span class="p">].</span><span class="nx">namespace</span><span class="o">?</span><span class="s2">&quot;.&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">+</span><span class="nx">i</span><span class="p">[</span><span class="nx">c</span><span class="p">][</span><span class="nx">d</span><span class="p">].</span><span class="nx">namespace</span><span class="p">,</span><span class="nx">i</span><span class="p">[</span><span class="nx">c</span><span class="p">][</span><span class="nx">d</span><span class="p">],</span><span class="nx">i</span><span class="p">[</span><span class="nx">c</span><span class="p">][</span><span class="nx">d</span><span class="p">].</span><span class="nx">data</span><span class="p">)}</span><span class="nx">h</span><span class="p">.</span><span class="nx">data</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">h</span><span class="p">.</span><span class="nx">data</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span><span class="nx">h</span><span class="p">.</span><span class="nx">data</span><span class="p">))}}</span><span class="kd">function</span> <span class="nx">bi</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;table&quot;</span><span class="p">)</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;tbody&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;tbody&quot;</span><span class="p">))</span><span class="o">:</span><span class="nx">a</span><span class="p">}</span><span class="kd">function</span> <span class="nx">U</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">V</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">),</span><span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">createDocumentFragment</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">)</span><span class="k">while</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">pop</span><span class="p">());</span><span class="k">return</span> <span class="nx">c</span><span class="p">}</span><span class="kd">function</span> <span class="nx">T</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="nx">b</span><span class="o">=</span><span class="nx">b</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">b</span><span class="p">))</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">grep</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=!!</span><span class="nx">b</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">);</span><span class="k">return</span> <span class="nx">e</span><span class="o">===</span><span class="nx">c</span><span class="p">});</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">nodeType</span><span class="p">)</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">grep</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="o">===</span><span class="nx">b</span><span class="o">===</span><span class="nx">c</span><span class="p">});</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">b</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">grep</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="p">});</span><span class="k">if</span><span class="p">(</span><span class="nx">O</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">b</span><span class="p">))</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="o">!</span><span class="nx">c</span><span class="p">);</span><span class="nx">b</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">)}</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">grep</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">inArray</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span><span class="o">===</span><span class="nx">c</span><span class="p">})}</span><span class="kd">function</span> <span class="nx">S</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span><span class="o">!</span><span class="nx">a</span><span class="o">||!</span><span class="nx">a</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">11</span><span class="p">}</span><span class="kd">function</span> <span class="nx">K</span><span class="p">(){</span><span class="k">return</span><span class="o">!</span><span class="mi">0</span><span class="p">}</span><span class="kd">function</span> <span class="nx">J</span><span class="p">(){</span><span class="k">return</span><span class="o">!</span><span class="mi">1</span><span class="p">}</span><span class="kd">function</span> <span class="nx">n</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="o">+</span><span class="s2">&quot;defer&quot;</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">b</span><span class="o">+</span><span class="s2">&quot;queue&quot;</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">b</span><span class="o">+</span><span class="s2">&quot;mark&quot;</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="p">);</span><span class="nx">h</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="o">===</span><span class="s2">&quot;queue&quot;</span><span class="o">||!</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">e</span><span class="p">))</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="o">===</span><span class="s2">&quot;mark&quot;</span><span class="o">||!</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">g</span><span class="p">))</span><span class="o">&amp;&amp;</span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="o">!</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">e</span><span class="p">)</span><span class="o">&amp;&amp;!</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">g</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">removeData</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">),</span><span class="nx">h</span><span class="p">.</span><span class="nx">fire</span><span class="p">())},</span><span class="mi">0</span><span class="p">)}</span><span class="kd">function</span> <span class="nx">m</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">b</span> <span class="k">in</span> <span class="nx">a</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="o">===</span><span class="s2">&quot;data&quot;</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">isEmptyObject</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">b</span><span class="p">]))</span><span class="k">continue</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="o">!==</span><span class="s2">&quot;toJSON&quot;</span><span class="p">)</span><span class="k">return</span><span class="o">!</span><span class="mi">1</span><span class="p">}</span><span class="k">return</span><span class="o">!</span><span class="mi">0</span><span class="p">}</span><span class="kd">function</span> <span class="nx">l</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="o">===</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="s2">&quot;data-&quot;</span><span class="o">+</span><span class="nx">c</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span><span class="s2">&quot;-$1&quot;</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">d</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="p">){</span><span class="k">try</span><span class="p">{</span><span class="nx">d</span><span class="o">=</span><span class="nx">d</span><span class="o">===</span><span class="s2">&quot;true&quot;</span><span class="o">?!</span><span class="mi">0</span><span class="o">:</span><span class="nx">d</span><span class="o">===</span><span class="s2">&quot;false&quot;</span><span class="o">?!</span><span class="mi">1</span><span class="o">:</span><span class="nx">d</span><span class="o">===</span><span class="s2">&quot;null&quot;</span><span class="o">?</span><span class="kc">null</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">isNumeric</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">?</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">:</span><span class="nx">j</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">parseJSON</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">:</span><span class="nx">d</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">g</span><span class="p">){}</span><span class="nx">f</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">)}</span><span class="k">else</span> <span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="p">}</span><span class="k">return</span> <span class="nx">d</span><span class="p">}</span><span class="kd">function</span> <span class="nx">h</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">g</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span><span class="o">=</span><span class="p">{},</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">;</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\s+/</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">c</span><span class="o">&lt;</span><span class="nx">d</span><span class="p">;</span><span class="nx">c</span><span class="o">++</span><span class="p">)</span><span class="nx">b</span><span class="p">[</span><span class="nx">a</span><span class="p">[</span><span class="nx">c</span><span class="p">]]</span><span class="o">=!</span><span class="mi">0</span><span class="p">;</span><span class="k">return</span> <span class="nx">b</span><span class="p">}</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nb">document</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">navigator</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">location</span><span class="p">,</span><span class="nx">f</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="kd">function</span> <span class="nx">J</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">e</span><span class="p">.</span><span class="nx">isReady</span><span class="p">){</span><span class="k">try</span><span class="p">{</span><span class="nx">c</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">doScroll</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">)}</span><span class="k">catch</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">setTimeout</span><span class="p">(</span><span class="nx">J</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="k">return</span><span class="p">}</span><span class="nx">e</span><span class="p">.</span><span class="nx">ready</span><span class="p">()}}</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="k">new</span> <span class="nx">e</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">h</span><span class="p">)},</span><span class="nx">f</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">jQuery</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">$</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="sr">/^(?:[^#&lt;]*(&lt;[\w\W]+&gt;)[^&gt;]*$|#([\w\-]*)$)/</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="sr">/\S/</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="sr">/^\s+/</span><span class="p">,</span><span class="nx">l</span><span class="o">=</span><span class="sr">/\s+$/</span><span class="p">,</span><span class="nx">m</span><span class="o">=</span><span class="sr">/^&lt;(\w+)\s*\/?&gt;(?:&lt;\/\1&gt;)?$/</span><span class="p">,</span><span class="nx">n</span><span class="o">=</span><span class="sr">/^[\],:{}\s]*$/</span><span class="p">,</span><span class="nx">o</span><span class="o">=</span><span class="sr">/\\(?:[&quot;\\\/bfnrt]|u[0-9a-fA-F]{4})/g</span><span class="p">,</span><span class="nx">p</span><span class="o">=</span><span class="sr">/&quot;[^&quot;\\\n\r]*&quot;|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g</span><span class="p">,</span><span class="nx">q</span><span class="o">=</span><span class="sr">/(?:^|:|,)(?:\s*\[)+/g</span><span class="p">,</span><span class="nx">r</span><span class="o">=</span><span class="sr">/(webkit)[ \/]([\w.]+)/</span><span class="p">,</span><span class="nx">s</span><span class="o">=</span><span class="sr">/(opera)(?:.*version)?[ \/]([\w.]+)/</span><span class="p">,</span><span class="nx">t</span><span class="o">=</span><span class="sr">/(msie) ([\w.]+)/</span><span class="p">,</span><span class="nx">u</span><span class="o">=</span><span class="sr">/(mozilla)(?:.*? rv:([\w.]+))?/</span><span class="p">,</span><span class="nx">v</span><span class="o">=</span><span class="sr">/-([a-z]|[0-9])/ig</span><span class="p">,</span><span class="nx">w</span><span class="o">=</span><span class="sr">/^-ms-/</span><span class="p">,</span><span class="nx">x</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="nx">b</span><span class="o">+</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">toUpperCase</span><span class="p">()},</span><span class="nx">y</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">,</span><span class="nx">z</span><span class="p">,</span><span class="nx">A</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">,</span><span class="nx">D</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">,</span><span class="nx">E</span><span class="o">=</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">push</span><span class="p">,</span><span class="nx">F</span><span class="o">=</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">,</span><span class="nx">G</span><span class="o">=</span><span class="nb">String</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">trim</span><span class="p">,</span><span class="nx">H</span><span class="o">=</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">,</span><span class="nx">I</span><span class="o">=</span><span class="p">{};</span><span class="nx">e</span><span class="p">.</span><span class="nx">fn</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">prototype</span><span class="o">=</span><span class="p">{</span><span class="nx">constructor</span><span class="o">:</span><span class="nx">e</span><span class="p">,</span><span class="nx">init</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">f</span><span class="p">){</span><span class="kd">var</span> <span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="nx">k</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">a</span><span class="p">)</span><span class="k">return</span> <span class="k">this</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nx">a</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="k">return</span> <span class="k">this</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">===</span><span class="s2">&quot;body&quot;</span><span class="o">&amp;&amp;!</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="p">.</span><span class="nx">body</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="o">=</span><span class="nx">c</span><span class="p">,</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">selector</span><span class="o">=</span><span class="nx">a</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="k">return</span> <span class="k">this</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="p">){</span><span class="nx">a</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">!==</span><span class="s2">&quot;&lt;&quot;</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">!==</span><span class="s2">&quot;&gt;&quot;</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">?</span><span class="nx">g</span><span class="o">=</span><span class="nx">i</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">:</span><span class="nx">g</span><span class="o">=</span><span class="p">[</span><span class="kc">null</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="kc">null</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">g</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">g</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||!</span><span class="nx">d</span><span class="p">)){</span><span class="k">if</span><span class="p">(</span><span class="nx">g</span><span class="p">[</span><span class="mi">1</span><span class="p">]){</span><span class="nx">d</span><span class="o">=</span><span class="nx">d</span> <span class="k">instanceof</span> <span class="nx">e</span><span class="o">?</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">:</span><span class="nx">d</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="nx">d</span><span class="o">?</span><span class="nx">d</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="o">||</span><span class="nx">d</span><span class="o">:</span><span class="nx">c</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="nx">m</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span><span class="nx">j</span><span class="o">?</span><span class="nx">e</span><span class="p">.</span><span class="nx">isPlainObject</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">?</span><span class="p">(</span><span class="nx">a</span><span class="o">=</span><span class="p">[</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">j</span><span class="p">[</span><span class="mi">1</span><span class="p">])],</span><span class="nx">e</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">attr</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">))</span><span class="o">:</span><span class="nx">a</span><span class="o">=</span><span class="p">[</span><span class="nx">k</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">j</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span><span class="o">:</span><span class="p">(</span><span class="nx">j</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">buildFragment</span><span class="p">([</span><span class="nx">g</span><span class="p">[</span><span class="mi">1</span><span class="p">]],[</span><span class="nx">k</span><span class="p">]),</span><span class="nx">a</span><span class="o">=</span><span class="p">(</span><span class="nx">j</span><span class="p">.</span><span class="nx">cacheable</span><span class="o">?</span><span class="nx">e</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">j</span><span class="p">.</span><span class="nx">fragment</span><span class="p">)</span><span class="o">:</span><span class="nx">j</span><span class="p">.</span><span class="nx">fragment</span><span class="p">).</span><span class="nx">childNodes</span><span class="p">);</span><span class="k">return</span> <span class="nx">e</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">)}</span><span class="nx">h</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">g</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span><span class="k">if</span><span class="p">(</span><span class="nx">h</span><span class="o">&amp;&amp;</span><span class="nx">h</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">h</span><span class="p">.</span><span class="nx">id</span><span class="o">!==</span><span class="nx">g</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nx">h</span><span class="p">}</span><span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="o">=</span><span class="nx">c</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">selector</span><span class="o">=</span><span class="nx">a</span><span class="p">;</span><span class="k">return</span> <span class="k">this</span><span class="p">}</span><span class="k">return</span><span class="o">!</span><span class="nx">d</span><span class="o">||</span><span class="nx">d</span><span class="p">.</span><span class="nx">jquery</span><span class="o">?</span><span class="p">(</span><span class="nx">d</span><span class="o">||</span><span class="nx">f</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="nx">d</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="nx">a</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">ready</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="nx">a</span><span class="p">.</span><span class="nx">selector</span><span class="o">!==</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">selector</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">context</span><span class="p">);</span><span class="k">return</span> <span class="nx">e</span><span class="p">.</span><span class="nx">makeArray</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="k">this</span><span class="p">)},</span><span class="nx">selector</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">jquery</span><span class="o">:</span><span class="s2">&quot;1.7.1&quot;</span><span class="p">,</span><span class="nx">length</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">size</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">},</span><span class="nx">toArray</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">F</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="mi">0</span><span class="p">)},</span><span class="nx">get</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="o">==</span><span class="kc">null</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">toArray</span><span class="p">()</span><span class="o">:</span><span class="nx">a</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">?</span><span class="k">this</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">+</span><span class="nx">a</span><span class="p">]</span><span class="o">:</span><span class="k">this</span><span class="p">[</span><span class="nx">a</span><span class="p">]},</span><span class="nx">pushStack</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">();</span><span class="nx">e</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">?</span><span class="nx">E</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">)</span><span class="o">:</span><span class="nx">e</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">),</span><span class="nx">d</span><span class="p">.</span><span class="nx">prevObject</span><span class="o">=</span><span class="k">this</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">context</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">,</span><span class="nx">b</span><span class="o">===</span><span class="s2">&quot;find&quot;</span><span class="o">?</span><span class="nx">d</span><span class="p">.</span><span class="nx">selector</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">selector</span><span class="o">+</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">selector</span><span class="o">?</span><span class="s2">&quot; &quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">+</span><span class="nx">c</span><span class="o">:</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">selector</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">selector</span><span class="o">+</span><span class="s2">&quot;.&quot;</span><span class="o">+</span><span class="nx">b</span><span class="o">+</span><span class="s2">&quot;(&quot;</span><span class="o">+</span><span class="nx">c</span><span class="o">+</span><span class="s2">&quot;)&quot;</span><span class="p">);</span><span class="k">return</span> <span class="nx">d</span><span class="p">},</span><span class="nx">each</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="nx">e</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">)},</span><span class="nx">ready</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">e</span><span class="p">.</span><span class="nx">bindReady</span><span class="p">(),</span><span class="nx">A</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">eq</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">a</span><span class="o">=+</span><span class="nx">a</span><span class="p">;</span><span class="k">return</span> <span class="nx">a</span><span class="o">===-</span><span class="mi">1</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)},</span><span class="nx">first</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">)},</span><span class="nx">last</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)},</span><span class="nx">slice</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">pushStack</span><span class="p">(</span><span class="nx">F</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">arguments</span><span class="p">),</span><span class="s2">&quot;slice&quot;</span><span class="p">,</span><span class="nx">F</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">))},</span><span class="nx">map</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">pushStack</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">b</span><span class="p">)}))},</span><span class="nx">end</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">prevObject</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="kc">null</span><span class="p">)},</span><span class="nx">push</span><span class="o">:</span><span class="nx">E</span><span class="p">,</span><span class="nx">sort</span><span class="o">:</span><span class="p">[].</span><span class="nx">sort</span><span class="p">,</span><span class="nx">splice</span><span class="o">:</span><span class="p">[].</span><span class="nx">splice</span><span class="p">},</span><span class="nx">e</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">init</span><span class="p">.</span><span class="nx">prototype</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">fn</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">extend</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">extend</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">f</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">||</span><span class="p">{},</span><span class="nx">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">l</span><span class="o">=!</span><span class="mi">1</span><span class="p">;</span><span class="k">typeof</span> <span class="nx">i</span><span class="o">==</span><span class="s2">&quot;boolean&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">l</span><span class="o">=</span><span class="nx">i</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="p">{},</span><span class="nx">j</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="k">typeof</span> <span class="nx">i</span><span class="o">!=</span><span class="s2">&quot;object&quot;</span><span class="o">&amp;&amp;!</span><span class="nx">e</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="p">{}),</span><span class="nx">k</span><span class="o">===</span><span class="nx">j</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="k">this</span><span class="p">,</span><span class="o">--</span><span class="nx">j</span><span class="p">);</span><span class="k">for</span><span class="p">(;</span><span class="nx">j</span><span class="o">&lt;</span><span class="nx">k</span><span class="p">;</span><span class="nx">j</span><span class="o">++</span><span class="p">)</span><span class="k">if</span><span class="p">((</span><span class="nx">a</span><span class="o">=</span><span class="nx">arguments</span><span class="p">[</span><span class="nx">j</span><span class="p">])</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="nx">c</span> <span class="k">in</span> <span class="nx">a</span><span class="p">){</span><span class="nx">d</span><span class="o">=</span><span class="nx">i</span><span class="p">[</span><span class="nx">c</span><span class="p">],</span><span class="nx">f</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">c</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">i</span><span class="o">===</span><span class="nx">f</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span><span class="nx">l</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">isPlainObject</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="nx">g</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">f</span><span class="p">)))</span><span class="o">?</span><span class="p">(</span><span class="nx">g</span><span class="o">?</span><span class="p">(</span><span class="nx">g</span><span class="o">=!</span><span class="mi">1</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">?</span><span class="nx">d</span><span class="o">:</span><span class="p">[])</span><span class="o">:</span><span class="nx">h</span><span class="o">=</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="p">.</span><span class="nx">isPlainObject</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">?</span><span class="nx">d</span><span class="o">:</span><span class="p">{},</span><span class="nx">i</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">l</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">f</span><span class="p">))</span><span class="o">:</span><span class="nx">f</span><span class="o">!==</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">i</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">=</span><span class="nx">f</span><span class="p">)}</span><span class="k">return</span> <span class="nx">i</span><span class="p">},</span><span class="nx">e</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">noConflict</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="nx">a</span><span class="p">.</span><span class="nx">$</span><span class="o">===</span><span class="nx">e</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">$</span><span class="o">=</span><span class="nx">g</span><span class="p">),</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">jQuery</span><span class="o">===</span><span class="nx">e</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">jQuery</span><span class="o">=</span><span class="nx">f</span><span class="p">);</span><span class="k">return</span> <span class="nx">e</span><span class="p">},</span><span class="nx">isReady</span><span class="o">:!</span><span class="mi">1</span><span class="p">,</span><span class="nx">readyWait</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">holdReady</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">a</span><span class="o">?</span><span class="nx">e</span><span class="p">.</span><span class="nx">readyWait</span><span class="o">++:</span><span class="nx">e</span><span class="p">.</span><span class="nx">ready</span><span class="p">(</span><span class="o">!</span><span class="mi">0</span><span class="p">)},</span><span class="nx">ready</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">===!</span><span class="mi">0</span><span class="o">&amp;&amp;!--</span><span class="nx">e</span><span class="p">.</span><span class="nx">readyWait</span><span class="o">||</span><span class="nx">a</span><span class="o">!==!</span><span class="mi">0</span><span class="o">&amp;&amp;!</span><span class="nx">e</span><span class="p">.</span><span class="nx">isReady</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">c</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span><span class="k">return</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">ready</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="nx">e</span><span class="p">.</span><span class="nx">isReady</span><span class="o">=!</span><span class="mi">0</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">!==!</span><span class="mi">0</span><span class="o">&amp;&amp;--</span><span class="nx">e</span><span class="p">.</span><span class="nx">readyWait</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span><span class="p">;</span><span class="nx">A</span><span class="p">.</span><span class="nx">fireWith</span><span class="p">(</span><span class="nx">c</span><span class="p">,[</span><span class="nx">e</span><span class="p">]),</span><span class="nx">e</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">trigger</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="p">(</span><span class="nx">c</span><span class="p">).</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;ready&quot;</span><span class="p">).</span><span class="nx">off</span><span class="p">(</span><span class="s2">&quot;ready&quot;</span><span class="p">)}},</span><span class="nx">bindReady</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">A</span><span class="p">){</span><span class="nx">A</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">Callbacks</span><span class="p">(</span><span class="s2">&quot;once memory&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">readyState</span><span class="o">===</span><span class="s2">&quot;complete&quot;</span><span class="p">)</span><span class="k">return</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">ready</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">)</span><span class="nx">c</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;DOMContentLoaded&quot;</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="o">!</span><span class="mi">1</span><span class="p">),</span><span class="nx">a</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;load&quot;</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">ready</span><span class="p">,</span><span class="o">!</span><span class="mi">1</span><span class="p">);</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">){</span><span class="nx">c</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s2">&quot;onreadystatechange&quot;</span><span class="p">,</span><span class="nx">B</span><span class="p">),</span><span class="nx">a</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s2">&quot;onload&quot;</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">ready</span><span class="p">);</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=!</span><span class="mi">1</span><span class="p">;</span><span class="k">try</span><span class="p">{</span><span class="nx">b</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">frameElement</span><span class="o">==</span><span class="kc">null</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">d</span><span class="p">){}</span><span class="nx">c</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">doScroll</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="nx">J</span><span class="p">()}}},</span><span class="nx">isFunction</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">e</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">===</span><span class="s2">&quot;function&quot;</span><span class="p">},</span><span class="nx">isArray</span><span class="o">:</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="o">||</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">e</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">===</span><span class="s2">&quot;array&quot;</span><span class="p">},</span><span class="nx">isWindow</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="o">&amp;&amp;</span><span class="s2">&quot;setInterval&quot;</span><span class="k">in</span> <span class="nx">a</span><span class="p">},</span><span class="nx">isNumeric</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span><span class="o">!</span><span class="nb">isNaN</span><span class="p">(</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span><span class="o">&amp;&amp;</span><span class="nb">isFinite</span><span class="p">(</span><span class="nx">a</span><span class="p">)},</span><span class="nx">type</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="o">==</span><span class="kc">null</span><span class="o">?</span><span class="nb">String</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">:</span><span class="nx">I</span><span class="p">[</span><span class="nx">C</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">)]</span><span class="o">||</span><span class="s2">&quot;object&quot;</span><span class="p">},</span><span class="nx">isPlainObject</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">a</span><span class="o">||</span><span class="nx">e</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">!==</span><span class="s2">&quot;object&quot;</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">||</span><span class="nx">e</span><span class="p">.</span><span class="nx">isWindow</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span><span class="k">return</span><span class="o">!</span><span class="mi">1</span><span class="p">;</span><span class="k">try</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">constructor</span><span class="o">&amp;&amp;!</span><span class="nx">D</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;constructor&quot;</span><span class="p">)</span><span class="o">&amp;&amp;!</span><span class="nx">D</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span><span class="s2">&quot;isPrototypeOf&quot;</span><span class="p">))</span><span class="k">return</span><span class="o">!</span><span class="mi">1</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span><span class="k">return</span><span class="o">!</span><span class="mi">1</span><span class="p">}</span><span class="kd">var</span> <span class="nx">d</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nx">d</span> <span class="k">in</span> <span class="nx">a</span><span class="p">);</span><span class="k">return</span> <span class="nx">d</span><span class="o">===</span><span class="nx">b</span><span class="o">||</span><span class="nx">D</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="p">)},</span><span class="nx">isEmptyObject</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">b</span> <span class="k">in</span> <span class="nx">a</span><span class="p">)</span><span class="k">return</span><span class="o">!</span><span class="mi">1</span><span class="p">;</span><span class="k">return</span><span class="o">!</span><span class="mi">0</span><span class="p">},</span><span class="nx">error</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">a</span><span class="p">)},</span><span class="nx">parseJSON</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">b</span><span class="o">!=</span><span class="s2">&quot;string&quot;</span><span class="o">||!</span><span class="nx">b</span><span class="p">)</span><span class="k">return</span> <span class="kc">null</span><span class="p">;</span><span class="nx">b</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">JSON</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">)</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span><span class="s2">&quot;@&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">p</span><span class="p">,</span><span class="s2">&quot;]&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">q</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)))</span><span class="k">return</span><span class="p">(</span><span class="k">new</span> <span class="nb">Function</span><span class="p">(</span><span class="s2">&quot;return &quot;</span><span class="o">+</span><span class="nx">b</span><span class="p">))();</span><span class="nx">e</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Invalid JSON: &quot;</span><span class="o">+</span><span class="nx">b</span><span class="p">)},</span><span class="nx">parseXML</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="p">,</span><span class="nx">f</span><span class="p">;</span><span class="k">try</span><span class="p">{</span><span class="nx">a</span><span class="p">.</span><span class="nx">DOMParser</span><span class="o">?</span><span class="p">(</span><span class="nx">f</span><span class="o">=</span><span class="k">new</span> <span class="nx">DOMParser</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">parseFromString</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="s2">&quot;text/xml&quot;</span><span class="p">))</span><span class="o">:</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="s2">&quot;Microsoft.XMLDOM&quot;</span><span class="p">),</span><span class="nx">d</span><span class="p">.</span><span class="nx">async</span><span class="o">=</span><span class="s2">&quot;false&quot;</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">loadXML</span><span class="p">(</span><span class="nx">c</span><span class="p">))}</span><span class="k">catch</span><span class="p">(</span><span class="nx">g</span><span class="p">){</span><span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="p">}(</span><span class="o">!</span><span class="nx">d</span><span class="o">||!</span><span class="nx">d</span><span class="p">.</span><span class="nx">documentElement</span><span class="o">||</span><span class="nx">d</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;parsererror&quot;</span><span class="p">).</span><span class="nx">length</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Invalid XML: &quot;</span><span class="o">+</span><span class="nx">c</span><span class="p">);</span><span class="k">return</span> <span class="nx">d</span><span class="p">},</span><span class="nx">noop</span><span class="o">:</span><span class="kd">function</span><span class="p">(){},</span><span class="nx">globalEval</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="nx">j</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">execScript</span><span class="o">||</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="nx">a</span><span class="p">.</span><span class="nb">eval</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">)})(</span><span class="nx">b</span><span class="p">)},</span><span class="nx">camelCase</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="s2">&quot;ms-&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span><span class="nx">x</span><span class="p">)},</span><span class="nx">nodeName</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="o">===</span><span class="nx">b</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()},</span><span class="nx">each</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">f</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">h</span><span class="o">===</span><span class="nx">b</span><span class="o">||</span><span class="nx">e</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">i</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="nx">f</span> <span class="k">in</span> <span class="nx">a</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">f</span><span class="p">],</span><span class="nx">d</span><span class="p">)</span><span class="o">===!</span><span class="mi">1</span><span class="p">)</span><span class="k">break</span><span class="p">}</span><span class="k">else</span> <span class="k">for</span><span class="p">(;</span><span class="nx">g</span><span class="o">&lt;</span><span class="nx">h</span><span class="p">;)</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">g</span><span class="o">++</span><span class="p">],</span><span class="nx">d</span><span class="p">)</span><span class="o">===!</span><span class="mi">1</span><span class="p">)</span><span class="k">break</span><span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">i</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="nx">f</span> <span class="k">in</span> <span class="nx">a</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">f</span><span class="p">],</span><span class="nx">f</span><span class="p">,</span><span class="nx">a</span><span class="p">[</span><span class="nx">f</span><span class="p">])</span><span class="o">===!</span><span class="mi">1</span><span class="p">)</span><span class="k">break</span><span class="p">}</span><span class="k">else</span> <span class="k">for</span><span class="p">(;</span><span class="nx">g</span><span class="o">&lt;</span><span class="nx">h</span><span class="p">;)</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">g</span><span class="p">],</span><span class="nx">g</span><span class="p">,</span><span class="nx">a</span><span class="p">[</span><span class="nx">g</span><span class="o">++</span><span class="p">])</span><span class="o">===!</span><span class="mi">1</span><span class="p">)</span><span class="k">break</span><span class="p">;</span><span class="k">return</span> <span class="nx">a</span><span class="p">},</span><span class="nx">trim</span><span class="o">:</span><span class="nx">G</span><span class="o">?</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="o">==</span><span class="kc">null</span><span class="o">?</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="nx">G</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">)}</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="o">==</span><span class="kc">null</span><span class="o">?</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="p">(</span><span class="nx">a</span><span class="o">+</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">l</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)},</span><span class="nx">makeArray</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="nx">b</span><span class="o">||</span><span class="p">[];</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">!=</span><span class="kc">null</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="kc">null</span><span class="o">||</span><span class="nx">d</span><span class="o">===</span><span class="s2">&quot;string&quot;</span><span class="o">||</span><span class="nx">d</span><span class="o">===</span><span class="s2">&quot;function&quot;</span><span class="o">||</span><span class="nx">d</span><span class="o">===</span><span class="s2">&quot;regexp&quot;</span><span class="o">||</span><span class="nx">e</span><span class="p">.</span><span class="nx">isWindow</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">?</span><span class="nx">E</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">a</span><span class="p">)</span><span class="o">:</span><span class="nx">e</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">a</span><span class="p">)}</span><span class="k">return</span> <span class="nx">c</span><span class="p">},</span><span class="nx">inArray</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">H</span><span class="p">)</span><span class="k">return</span> <span class="nx">H</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">);</span><span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="nx">c</span><span class="o">?</span><span class="nx">c</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">?</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">d</span><span class="o">+</span><span class="nx">c</span><span class="p">)</span><span class="o">:</span><span class="nx">c</span><span class="o">:</span><span class="mi">0</span><span class="p">;</span><span class="k">for</span><span class="p">(;</span><span class="nx">c</span><span class="o">&lt;</span><span class="nx">d</span><span class="p">;</span><span class="nx">c</span><span class="o">++</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span> <span class="k">in</span> <span class="nx">b</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">===</span><span class="nx">a</span><span class="p">)</span><span class="k">return</span> <span class="nx">c</span><span class="p">}</span><span class="k">return</span><span class="o">-</span><span class="mi">1</span><span class="p">},</span><span class="nx">merge</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">c</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="s2">&quot;number&quot;</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">f</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">e</span><span class="o">&lt;</span><span class="nx">f</span><span class="p">;</span><span class="nx">e</span><span class="o">++</span><span class="p">)</span><span class="nx">a</span><span class="p">[</span><span class="nx">d</span><span class="o">++</span><span class="p">]</span><span class="o">=</span><span class="nx">c</span><span class="p">[</span><span class="nx">e</span><span class="p">];</span><span class="k">else</span> <span class="k">while</span><span class="p">(</span><span class="nx">c</span><span class="p">[</span><span class="nx">e</span><span class="p">]</span><span class="o">!==</span><span class="nx">b</span><span class="p">)</span><span class="nx">a</span><span class="p">[</span><span class="nx">d</span><span class="o">++</span><span class="p">]</span><span class="o">=</span><span class="nx">c</span><span class="p">[</span><span class="nx">e</span><span class="o">++</span><span class="p">];</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="o">=</span><span class="nx">d</span><span class="p">;</span><span class="k">return</span> <span class="nx">a</span><span class="p">},</span><span class="nx">grep</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="p">[],</span><span class="nx">e</span><span class="p">;</span><span class="nx">c</span><span class="o">=!!</span><span class="nx">c</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">f</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">f</span><span class="o">&lt;</span><span class="nx">g</span><span class="p">;</span><span class="nx">f</span><span class="o">++</span><span class="p">)</span><span class="nx">e</span><span class="o">=!!</span><span class="nx">b</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">f</span><span class="p">],</span><span class="nx">f</span><span class="p">),</span><span class="nx">c</span><span class="o">!==</span><span class="nx">e</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">f</span><span class="p">]);</span><span class="k">return</span> <span class="nx">d</span><span class="p">},</span><span class="nx">map</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">f</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="p">[],</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="nx">a</span> <span class="k">instanceof</span> <span class="nx">e</span><span class="o">||</span><span class="nx">j</span><span class="o">!==</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">j</span><span class="o">==</span><span class="s2">&quot;number&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">j</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="nx">j</span><span class="o">===</span><span class="mi">0</span><span class="o">||</span><span class="nx">e</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">a</span><span class="p">));</span><span class="k">if</span><span class="p">(</span><span class="nx">k</span><span class="p">)</span><span class="k">for</span><span class="p">(;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">j</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="nx">f</span><span class="o">=</span><span class="nx">c</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span><span class="nx">i</span><span class="p">,</span><span class="nx">d</span><span class="p">),</span><span class="nx">f</span><span class="o">!=</span><span class="kc">null</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">h</span><span class="p">[</span><span class="nx">h</span><span class="p">.</span><span class="nx">length</span><span class="p">]</span><span class="o">=</span><span class="nx">f</span><span class="p">);</span><span class="k">else</span> <span class="k">for</span><span class="p">(</span><span class="nx">g</span> <span class="k">in</span> <span class="nx">a</span><span class="p">)</span><span class="nx">f</span><span class="o">=</span><span class="nx">c</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">g</span><span class="p">],</span><span class="nx">g</span><span class="p">,</span><span class="nx">d</span><span class="p">),</span><span class="nx">f</span><span class="o">!=</span><span class="kc">null</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">h</span><span class="p">[</span><span class="nx">h</span><span class="p">.</span><span class="nx">length</span><span class="p">]</span><span class="o">=</span><span class="nx">f</span><span class="p">);</span><span class="k">return</span> <span class="nx">h</span><span class="p">.</span><span class="nx">concat</span><span class="p">.</span><span class="nx">apply</span><span class="p">([],</span><span class="nx">h</span><span class="p">)},</span><span class="nx">guid</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">proxy</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">c</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">c</span><span class="p">];</span><span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">,</span><span class="nx">a</span><span class="o">=</span><span class="nx">d</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">e</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span><span class="k">return</span> <span class="nx">b</span><span class="p">;</span><span class="kd">var</span> <span class="nx">f</span><span class="o">=</span><span class="nx">F</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nx">g</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">F</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">)))};</span><span class="nx">g</span><span class="p">.</span><span class="nx">guid</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">guid</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">guid</span><span class="o">||</span><span class="nx">g</span><span class="p">.</span><span class="nx">guid</span><span class="o">||</span><span class="nx">e</span><span class="p">.</span><span class="nx">guid</span><span class="o">++</span><span class="p">;</span><span class="k">return</span> <span class="nx">g</span><span class="p">},</span><span class="nx">access</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">f</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">){</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">c</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="k">in</span> <span class="nx">c</span><span class="p">)</span><span class="nx">e</span><span class="p">.</span><span class="nx">access</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="nx">c</span><span class="p">[</span><span class="nx">j</span><span class="p">],</span><span class="nx">f</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">d</span><span class="p">);</span><span class="k">return</span> <span class="nx">a</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="o">!==</span><span class="nx">b</span><span class="p">){</span><span class="nx">f</span><span class="o">=!</span><span class="nx">h</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">d</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">k</span><span class="o">&lt;</span><span class="nx">i</span><span class="p">;</span><span class="nx">k</span><span class="o">++</span><span class="p">)</span><span class="nx">g</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">k</span><span class="p">],</span><span class="nx">c</span><span class="p">,</span><span class="nx">f</span><span class="o">?</span><span class="nx">d</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">k</span><span class="p">],</span><span class="nx">k</span><span class="p">,</span><span class="nx">g</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">k</span><span class="p">],</span><span class="nx">c</span><span class="p">))</span><span class="o">:</span><span class="nx">d</span><span class="p">,</span><span class="nx">h</span><span class="p">);</span><span class="k">return</span> <span class="nx">a</span><span class="p">}</span><span class="k">return</span> <span class="nx">i</span><span class="o">?</span><span class="nx">g</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">c</span><span class="p">)</span><span class="o">:</span><span class="nx">b</span><span class="p">},</span><span class="nx">now</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">).</span><span class="nx">getTime</span><span class="p">()},</span><span class="nx">uaMatch</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">r</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">||</span><span class="nx">s</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">||</span><span class="nx">t</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;compatible&quot;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="nx">u</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">||</span><span class="p">[];</span><span class="k">return</span><span class="p">{</span><span class="nx">browser</span><span class="o">:</span><span class="nx">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">version</span><span class="o">:</span><span class="nx">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">||</span><span class="s2">&quot;0&quot;</span><span class="p">}},</span><span class="nx">sub</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">function</span> <span class="nx">a</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">return</span> <span class="k">new</span> <span class="nx">a</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">)}</span><span class="nx">e</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="o">!</span><span class="mi">0</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="k">this</span><span class="p">),</span><span class="nx">a</span><span class="p">.</span><span class="nx">superclass</span><span class="o">=</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">.</span><span class="nx">fn</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">prototype</span><span class="o">=</span><span class="k">this</span><span class="p">(),</span><span class="nx">a</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">constructor</span><span class="o">=</span><span class="nx">a</span><span class="p">,</span><span class="nx">a</span><span class="p">.</span><span class="nx">sub</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">sub</span><span class="p">,</span><span class="nx">a</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">init</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">f</span><span class="p">){</span><span class="nx">f</span><span class="o">&amp;&amp;</span><span class="nx">f</span> <span class="k">instanceof</span> <span class="nx">e</span><span class="o">&amp;&amp;!</span><span class="p">(</span><span class="nx">f</span> <span class="k">instanceof</span> <span class="nx">a</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">f</span><span class="o">=</span><span class="nx">a</span><span class="p">(</span><span class="nx">f</span><span class="p">));</span><span class="k">return</span> <span class="nx">e</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">init</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">f</span><span class="p">,</span><span class="nx">b</span><span class="p">)},</span><span class="nx">a</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">init</span><span class="p">.</span><span class="nx">prototype</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">fn</span><span class="p">;</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">a</span><span class="p">(</span><span class="nx">c</span><span class="p">);</span><span class="k">return</span> <span class="nx">a</span><span class="p">},</span><span class="nx">browser</span><span class="o">:</span><span class="p">{}}),</span><span class="nx">e</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="s2">&quot;Boolean Number String Function Array Date RegExp Object&quot;</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">I</span><span class="p">[</span><span class="s2">&quot;[object &quot;</span><span class="o">+</span><span class="nx">b</span><span class="o">+</span><span class="s2">&quot;]&quot;</span><span class="p">]</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()}),</span><span class="nx">z</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">uaMatch</span><span class="p">(</span><span class="nx">y</span><span class="p">),</span><span class="nx">z</span><span class="p">.</span><span class="nx">browser</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">browser</span><span class="p">[</span><span class="nx">z</span><span class="p">.</span><span class="nx">browser</span><span class="p">]</span><span class="o">=!</span><span class="mi">0</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">browser</span><span class="p">.</span><span class="nx">version</span><span class="o">=</span><span class="nx">z</span><span class="p">.</span><span class="nx">version</span><span class="p">),</span><span class="nx">e</span><span class="p">.</span><span class="nx">browser</span><span class="p">.</span><span class="nx">webkit</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">browser</span><span class="p">.</span><span class="nx">safari</span><span class="o">=!</span><span class="mi">0</span><span class="p">),</span><span class="nx">j</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">k</span><span class="o">=</span><span class="sr">/^[\s\xA0]+/</span><span class="p">,</span><span class="nx">l</span><span class="o">=</span><span class="sr">/[\s\xA0]+$/</span><span class="p">),</span><span class="nx">h</span><span class="o">=</span><span class="nx">e</span><span class="p">(</span><span class="nx">c</span><span class="p">),</span><span class="nx">c</span><span class="p">.</span><span class="nx">addEventListener</span><span class="o">?</span><span class="nx">B</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="nx">c</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s2">&quot;DOMContentLoaded&quot;</span><span class="p">,</span><span class="nx">B</span><span class="p">,</span><span class="o">!</span><span class="mi">1</span><span class="p">),</span><span class="nx">e</span><span class="p">.</span><span class="nx">ready</span><span class="p">()}</span><span class="o">:</span><span class="nx">c</span><span class="p">.</span><span class="nx">attachEvent</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">B</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="nx">c</span><span class="p">.</span><span class="nx">readyState</span><span class="o">===</span><span class="s2">&quot;complete&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">detachEvent</span><span class="p">(</span><span class="s2">&quot;onreadystatechange&quot;</span><span class="p">,</span><span class="nx">B</span><span class="p">),</span><span class="nx">e</span><span class="p">.</span><span class="nx">ready</span><span class="p">())});</span><span class="k">return</span> <span class="nx">e</span><span class="p">}(),</span><span class="nx">g</span><span class="o">=</span><span class="p">{};</span><span class="nx">f</span><span class="p">.</span><span class="nx">Callbacks</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="o">?</span><span class="nx">g</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span><span class="o">||</span><span class="nx">h</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">:</span><span class="p">{};</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="p">[],</span><span class="nx">d</span><span class="o">=</span><span class="p">[],</span><span class="nx">e</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="nx">k</span><span class="p">,</span><span class="nx">l</span><span class="p">,</span><span class="nx">m</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">d</span><span class="o">&lt;</span><span class="nx">e</span><span class="p">;</span><span class="nx">d</span><span class="o">++</span><span class="p">)</span><span class="nx">g</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="nx">d</span><span class="p">],</span><span class="nx">h</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">g</span><span class="p">),</span><span class="nx">h</span><span class="o">===</span><span class="s2">&quot;array&quot;</span><span class="o">?</span><span class="nx">m</span><span class="p">(</span><span class="nx">g</span><span class="p">)</span><span class="o">:</span><span class="nx">h</span><span class="o">===</span><span class="s2">&quot;function&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="nx">a</span><span class="p">.</span><span class="nx">unique</span><span class="o">||!</span><span class="nx">o</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">g</span><span class="p">))</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">g</span><span class="p">)},</span><span class="nx">n</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">f</span><span class="p">){</span><span class="nx">f</span><span class="o">=</span><span class="nx">f</span><span class="o">||</span><span class="p">[],</span><span class="nx">e</span><span class="o">=!</span><span class="nx">a</span><span class="p">.</span><span class="nx">memory</span><span class="o">||</span><span class="p">[</span><span class="nx">b</span><span class="p">,</span><span class="nx">f</span><span class="p">],</span><span class="nx">i</span><span class="o">=!</span><span class="mi">0</span><span class="p">,</span><span class="nx">l</span><span class="o">=</span><span class="nx">j</span><span class="o">||</span><span class="mi">0</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">for</span><span class="p">(;</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="nx">l</span><span class="o">&lt;</span><span class="nx">k</span><span class="p">;</span><span class="nx">l</span><span class="o">++</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">[</span><span class="nx">l</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">f</span><span class="p">)</span><span class="o">===!</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">stopOnFalse</span><span class="p">){</span><span class="nx">e</span><span class="o">=!</span><span class="mi">0</span><span class="p">;</span><span class="k">break</span><span class="p">}</span><span class="nx">i</span><span class="o">=!</span><span class="mi">1</span><span class="p">,</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">once</span><span class="o">?</span><span class="nx">e</span><span class="o">===!</span><span class="mi">0</span><span class="o">?</span><span class="nx">o</span><span class="p">.</span><span class="nx">disable</span><span class="p">()</span><span class="o">:</span><span class="nx">c</span><span class="o">=</span><span class="p">[]</span><span class="o">:</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">length</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">shift</span><span class="p">(),</span><span class="nx">o</span><span class="p">.</span><span class="nx">fireWith</span><span class="p">(</span><span class="nx">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">e</span><span class="p">[</span><span class="mi">1</span><span class="p">])))},</span><span class="nx">o</span><span class="o">=</span><span class="p">{</span><span class="nx">add</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">m</span><span class="p">(</span><span class="nx">arguments</span><span class="p">),</span><span class="nx">i</span><span class="o">?</span><span class="nx">k</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">length</span><span class="o">:</span><span class="nx">e</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="o">!==!</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">j</span><span class="o">=</span><span class="nx">a</span><span class="p">,</span><span class="nx">n</span><span class="p">(</span><span class="nx">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]))}</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">remove</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">arguments</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">for</span><span class="p">(;</span><span class="nx">d</span><span class="o">&lt;</span><span class="nx">e</span><span class="p">;</span><span class="nx">d</span><span class="o">++</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">f</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">f</span><span class="o">&lt;</span><span class="nx">c</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">f</span><span class="o">++</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">===</span><span class="nx">c</span><span class="p">[</span><span class="nx">f</span><span class="p">]){</span><span class="nx">i</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="o">&lt;=</span><span class="nx">k</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">k</span><span class="o">--</span><span class="p">,</span><span class="nx">f</span><span class="o">&lt;=</span><span class="nx">l</span><span class="o">&amp;&amp;</span><span class="nx">l</span><span class="o">--</span><span class="p">),</span><span class="nx">c</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">f</span><span class="o">--</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">unique</span><span class="p">)</span><span class="k">break</span><span class="p">}}</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">has</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">for</span><span class="p">(;</span><span class="nx">b</span><span class="o">&lt;</span><span class="nx">d</span><span class="p">;</span><span class="nx">b</span><span class="o">++</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">===</span><span class="nx">c</span><span class="p">[</span><span class="nx">b</span><span class="p">])</span><span class="k">return</span><span class="o">!</span><span class="mi">0</span><span class="p">}</span><span class="k">return</span><span class="o">!</span><span class="mi">1</span><span class="p">},</span><span class="nx">empty</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">c</span><span class="o">=</span><span class="p">[];</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">disable</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">c</span><span class="o">=</span><span class="nx">d</span><span class="o">=</span><span class="nx">e</span><span class="o">=</span><span class="nx">b</span><span class="p">;</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">disabled</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span><span class="o">!</span><span class="nx">c</span><span class="p">},</span><span class="nx">lock</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="p">,(</span><span class="o">!</span><span class="nx">e</span><span class="o">||</span><span class="nx">e</span><span class="o">===!</span><span class="mi">0</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">o</span><span class="p">.</span><span class="nx">disable</span><span class="p">();</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">locked</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span><span class="o">!</span><span class="nx">d</span><span class="p">},</span><span class="nx">fireWith</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">i</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">once</span><span class="o">||</span><span class="nx">d</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">])</span><span class="o">:</span><span class="p">(</span><span class="o">!</span><span class="nx">a</span><span class="p">.</span><span class="nx">once</span><span class="o">||!</span><span class="nx">e</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">n</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">));</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">fire</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">o</span><span class="p">.</span><span class="nx">fireWith</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">arguments</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">fired</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span><span class="o">!!</span><span class="nx">e</span><span class="p">}};</span><span class="k">return</span> <span class="nx">o</span><span class="p">};</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="p">[].</span><span class="nx">slice</span><span class="p">;</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">Deferred</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">Callbacks</span><span class="p">(</span><span class="s2">&quot;once memory&quot;</span><span class="p">),</span><span class="nx">c</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">Callbacks</span><span class="p">(</span><span class="s2">&quot;once memory&quot;</span><span class="p">),</span><span class="nx">d</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">Callbacks</span><span class="p">(</span><span class="s2">&quot;memory&quot;</span><span class="p">),</span><span class="nx">e</span><span class="o">=</span><span class="s2">&quot;pending&quot;</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="p">{</span><span class="nx">resolve</span><span class="o">:</span><span class="nx">b</span><span class="p">,</span><span class="nx">reject</span><span class="o">:</span><span class="nx">c</span><span class="p">,</span><span class="nx">notify</span><span class="o">:</span><span class="nx">d</span><span class="p">},</span><span class="nx">h</span><span class="o">=</span><span class="p">{</span><span class="nx">done</span><span class="o">:</span><span class="nx">b</span><span class="p">.</span><span class="nx">add</span><span class="p">,</span><span class="nx">fail</span><span class="o">:</span><span class="nx">c</span><span class="p">.</span><span class="nx">add</span><span class="p">,</span><span class="nx">progress</span><span class="o">:</span><span class="nx">d</span><span class="p">.</span><span class="nx">add</span><span class="p">,</span><span class="nx">state</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">e</span><span class="p">},</span><span class="nx">isResolved</span><span class="o">:</span><span class="nx">b</span><span class="p">.</span><span class="nx">fired</span><span class="p">,</span><span class="nx">isRejected</span><span class="o">:</span><span class="nx">c</span><span class="p">.</span><span class="nx">fired</span><span class="p">,</span><span class="nx">then</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="nx">i</span><span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="nx">a</span><span class="p">).</span><span class="nx">fail</span><span class="p">(</span><span class="nx">b</span><span class="p">).</span><span class="nx">progress</span><span class="p">(</span><span class="nx">c</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">always</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">i</span><span class="p">.</span><span class="nx">done</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="nx">arguments</span><span class="p">).</span><span class="nx">fail</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="nx">arguments</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">pipe</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">Deferred</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">({</span><span class="nx">done</span><span class="o">:</span><span class="p">[</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;resolve&quot;</span><span class="p">],</span><span class="nx">fail</span><span class="o">:</span><span class="p">[</span><span class="nx">b</span><span class="p">,</span><span class="s2">&quot;reject&quot;</span><span class="p">],</span><span class="nx">progress</span><span class="o">:</span><span class="p">[</span><span class="nx">c</span><span class="p">,</span><span class="s2">&quot;notify&quot;</span><span class="p">]},</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">e</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nx">g</span><span class="p">;</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span><span class="o">?</span><span class="nx">i</span><span class="p">[</span><span class="nx">a</span><span class="p">](</span><span class="kd">function</span><span class="p">(){</span><span class="nx">g</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">arguments</span><span class="p">),</span><span class="nx">g</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">g</span><span class="p">.</span><span class="nx">promise</span><span class="p">)</span><span class="o">?</span><span class="nx">g</span><span class="p">.</span><span class="nx">promise</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">resolve</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">reject</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">notify</span><span class="p">)</span><span class="o">:</span><span class="nx">d</span><span class="p">[</span><span class="nx">e</span><span class="o">+</span><span class="s2">&quot;With&quot;</span><span class="p">](</span><span class="k">this</span><span class="o">===</span><span class="nx">i</span><span class="o">?</span><span class="nx">d</span><span class="o">:</span><span class="k">this</span><span class="p">,[</span><span class="nx">g</span><span class="p">])})</span><span class="o">:</span><span class="nx">i</span><span class="p">[</span><span class="nx">a</span><span class="p">](</span><span class="nx">d</span><span class="p">[</span><span class="nx">e</span><span class="p">])})}).</span><span class="nx">promise</span><span class="p">()},</span><span class="nx">promise</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">==</span><span class="kc">null</span><span class="p">)</span><span class="nx">a</span><span class="o">=</span><span class="nx">h</span><span class="p">;</span><span class="k">else</span> <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">b</span> <span class="k">in</span> <span class="nx">h</span><span class="p">)</span><span class="nx">a</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">=</span><span class="nx">h</span><span class="p">[</span><span class="nx">b</span><span class="p">];</span><span class="k">return</span> <span class="nx">a</span><span class="p">}},</span><span class="nx">i</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">promise</span><span class="p">({}),</span><span class="nx">j</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nx">j</span> <span class="k">in</span> <span class="nx">g</span><span class="p">)</span><span class="nx">i</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span><span class="o">=</span><span class="nx">g</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">fire</span><span class="p">,</span><span class="nx">i</span><span class="p">[</span><span class="nx">j</span><span class="o">+</span><span class="s2">&quot;With&quot;</span><span class="p">]</span><span class="o">=</span><span class="nx">g</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">fireWith</span><span class="p">;</span><span class="nx">i</span><span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">e</span><span class="o">=</span><span class="s2">&quot;resolved&quot;</span><span class="p">},</span><span class="nx">c</span><span class="p">.</span><span class="nx">disable</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">lock</span><span class="p">).</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">e</span><span class="o">=</span><span class="s2">&quot;rejected&quot;</span><span class="p">},</span><span class="nx">b</span><span class="p">.</span><span class="nx">disable</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">lock</span><span class="p">),</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="nx">i</span><span class="p">);</span><span class="k">return</span> <span class="nx">i</span><span class="p">},</span><span class="nx">when</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">function</span> <span class="nx">m</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="nx">e</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span><span class="o">=</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">?</span><span class="nx">i</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span><span class="nx">b</span><span class="p">,</span><span class="nx">j</span><span class="p">.</span><span class="nx">notifyWith</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span><span class="nx">e</span><span class="p">)}}</span><span class="kd">function</span> <span class="nx">l</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span><span class="nx">b</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span><span class="o">=</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">?</span><span class="nx">i</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span><span class="nx">c</span><span class="p">,</span><span class="o">--</span><span class="nx">g</span><span class="o">||</span><span class="nx">j</span><span class="p">.</span><span class="nx">resolveWith</span><span class="p">(</span><span class="nx">j</span><span class="p">,</span><span class="nx">b</span><span class="p">)}}</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">i</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="nx">c</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nb">Array</span><span class="p">(</span><span class="nx">d</span><span class="p">),</span><span class="nx">g</span><span class="o">=</span><span class="nx">d</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="nx">d</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="nx">d</span><span class="o">&lt;=</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">promise</span><span class="p">)</span><span class="o">?</span><span class="nx">a</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">Deferred</span><span class="p">(),</span><span class="nx">k</span><span class="o">=</span><span class="nx">j</span><span class="p">.</span><span class="nx">promise</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">){</span><span class="k">for</span><span class="p">(;</span><span class="nx">c</span><span class="o">&lt;</span><span class="nx">d</span><span class="p">;</span><span class="nx">c</span><span class="o">++</span><span class="p">)</span><span class="nx">b</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="p">[</span><span class="nx">c</span><span class="p">].</span><span class="nx">promise</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="nx">c</span><span class="p">].</span><span class="nx">promise</span><span class="p">)</span><span class="o">?</span><span class="nx">b</span><span class="p">[</span><span class="nx">c</span><span class="p">].</span><span class="nx">promise</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="nx">l</span><span class="p">(</span><span class="nx">c</span><span class="p">),</span><span class="nx">j</span><span class="p">.</span><span class="nx">reject</span><span class="p">,</span><span class="nx">m</span><span class="p">(</span><span class="nx">c</span><span class="p">))</span><span class="o">:--</span><span class="nx">g</span><span class="p">;</span><span class="nx">g</span><span class="o">||</span><span class="nx">j</span><span class="p">.</span><span class="nx">resolveWith</span><span class="p">(</span><span class="nx">j</span><span class="p">,</span><span class="nx">b</span><span class="p">)}</span><span class="k">else</span> <span class="nx">j</span><span class="o">!==</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="nx">j</span><span class="p">.</span><span class="nx">resolveWith</span><span class="p">(</span><span class="nx">j</span><span class="p">,</span><span class="nx">d</span><span class="o">?</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span><span class="o">:</span><span class="p">[]);</span><span class="k">return</span> <span class="nx">k</span><span class="p">}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="nx">k</span><span class="p">,</span><span class="nx">l</span><span class="p">,</span><span class="nx">m</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">o</span><span class="p">,</span><span class="nx">p</span><span class="p">,</span><span class="nx">q</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">),</span><span class="nx">r</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">;</span><span class="nx">q</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;className&quot;</span><span class="p">,</span><span class="s2">&quot;t&quot;</span><span class="p">),</span><span class="nx">q</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="s2">&quot;   &lt;link/&gt;&lt;table&gt;&lt;/table&gt;&lt;a href=&#39;/a&#39; style=&#39;top:1px;float:left;opacity:.55;&#39;&gt;a&lt;/a&gt;&lt;input type=&#39;checkbox&#39;/&gt;&quot;</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">q</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">),</span><span class="nx">e</span><span class="o">=</span><span class="nx">q</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">d</span><span class="o">||!</span><span class="nx">d</span><span class="p">.</span><span class="nx">length</span><span class="o">||!</span><span class="nx">e</span><span class="p">)</span><span class="k">return</span><span class="p">{};</span><span class="nx">g</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;select&quot;</span><span class="p">),</span><span class="nx">h</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;option&quot;</span><span class="p">)),</span><span class="nx">i</span><span class="o">=</span><span class="nx">q</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="nx">b</span><span class="o">=</span><span class="p">{</span><span class="nx">leadingWhitespace</span><span class="o">:</span><span class="nx">q</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">3</span><span class="p">,</span><span class="nx">tbody</span><span class="o">:!</span><span class="nx">q</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;tbody&quot;</span><span class="p">).</span><span class="nx">length</span><span class="p">,</span><span class="nx">htmlSerialize</span><span class="o">:!!</span><span class="nx">q</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;link&quot;</span><span class="p">).</span><span class="nx">length</span><span class="p">,</span><span class="nx">style</span><span class="o">:</span><span class="sr">/top/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;style&quot;</span><span class="p">)),</span><span class="nx">hrefNormalized</span><span class="o">:</span><span class="nx">e</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;href&quot;</span><span class="p">)</span><span class="o">===</span><span class="s2">&quot;/a&quot;</span><span class="p">,</span><span class="nx">opacity</span><span class="o">:</span><span class="sr">/^0.55/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">opacity</span><span class="p">),</span><span class="nx">cssFloat</span><span class="o">:!!</span><span class="nx">e</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">cssFloat</span><span class="p">,</span><span class="nx">checkOn</span><span class="o">:</span><span class="nx">i</span><span class="p">.</span><span class="nx">value</span><span class="o">===</span><span class="s2">&quot;on&quot;</span><span class="p">,</span><span class="nx">optSelected</span><span class="o">:</span><span class="nx">h</span><span class="p">.</span><span class="nx">selected</span><span class="p">,</span><span class="nx">getSetAttribute</span><span class="o">:</span><span class="nx">q</span><span class="p">.</span><span class="nx">className</span><span class="o">!==</span><span class="s2">&quot;t&quot;</span><span class="p">,</span><span class="nx">enctype</span><span class="o">:!!</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;form&quot;</span><span class="p">).</span><span class="nx">enctype</span><span class="p">,</span><span class="nx">html5Clone</span><span class="o">:</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;nav&quot;</span><span class="p">).</span><span class="nx">cloneNode</span><span class="p">(</span><span class="o">!</span><span class="mi">0</span><span class="p">).</span><span class="nx">outerHTML</span><span class="o">!==</span><span class="s2">&quot;&lt;:nav&gt;&lt;/:nav&gt;&quot;</span><span class="p">,</span><span class="nx">submitBubbles</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">changeBubbles</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">focusinBubbles</span><span class="o">:!</span><span class="mi">1</span><span class="p">,</span><span class="nx">deleteExpando</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">noCloneEvent</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">inlineBlockNeedsLayout</span><span class="o">:!</span><span class="mi">1</span><span class="p">,</span><span class="nx">shrinkWrapBlocks</span><span class="o">:!</span><span class="mi">1</span><span class="p">,</span><span class="nx">reliableMarginRight</span><span class="o">:!</span><span class="mi">0</span><span class="p">},</span><span class="nx">i</span><span class="p">.</span><span class="nx">checked</span><span class="o">=!</span><span class="mi">0</span><span class="p">,</span><span class="nx">b</span><span class="p">.</span><span class="nx">noCloneChecked</span><span class="o">=</span><span class="nx">i</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="o">!</span><span class="mi">0</span><span class="p">).</span><span class="nx">checked</span><span class="p">,</span><span class="nx">g</span><span class="p">.</span><span class="nx">disabled</span><span class="o">=!</span><span class="mi">0</span><span class="p">,</span><span class="nx">b</span><span class="p">.</span><span class="nx">optDisabled</span><span class="o">=!</span><span class="nx">h</span><span class="p">.</span><span class="nx">disabled</span><span class="p">;</span><span class="k">try</span><span class="p">{</span><span class="k">delete</span> <span class="nx">q</span><span class="p">.</span><span class="nx">test</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">s</span><span class="p">){</span><span class="nx">b</span><span class="p">.</span><span class="nx">deleteExpando</span><span class="o">=!</span><span class="mi">1</span><span class="p">}</span><span class="o">!</span><span class="nx">q</span><span class="p">.</span><span class="nx">addEventListener</span><span class="o">&amp;&amp;</span><span class="nx">q</span><span class="p">.</span><span class="nx">attachEvent</span><span class="o">&amp;&amp;</span><span class="nx">q</span><span class="p">.</span><span class="nx">fireEvent</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">q</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s2">&quot;onclick&quot;</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span><span class="nx">b</span><span class="p">.</span><span class="nx">noCloneEvent</span><span class="o">=!</span><span class="mi">1</span><span class="p">}),</span><span class="nx">q</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="o">!</span><span class="mi">0</span><span class="p">).</span><span class="nx">fireEvent</span><span class="p">(</span><span class="s2">&quot;onclick&quot;</span><span class="p">)),</span><span class="nx">i</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">),</span><span class="nx">i</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;t&quot;</span><span class="p">,</span><span class="nx">i</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span><span class="s2">&quot;radio&quot;</span><span class="p">),</span><span class="nx">b</span><span class="p">.</span><span class="nx">radioValue</span><span class="o">=</span><span class="nx">i</span><span class="p">.</span><span class="nx">value</span><span class="o">===</span><span class="s2">&quot;t&quot;</span><span class="p">,</span><span class="nx">i</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;checked&quot;</span><span class="p">,</span><span class="s2">&quot;checked&quot;</span><span class="p">),</span><span class="nx">q</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span><span class="nx">k</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">createDocumentFragment</span><span class="p">(),</span><span class="nx">k</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">q</span><span class="p">.</span><span class="nx">lastChild</span><span class="p">),</span><span class="nx">b</span><span class="p">.</span><span class="nx">checkClone</span><span class="o">=</span><span class="nx">k</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="o">!</span><span class="mi">0</span><span class="p">).</span><span class="nx">cloneNode</span><span class="p">(</span><span class="o">!</span><span class="mi">0</span><span class="p">).</span><span class="nx">lastChild</span><span class="p">.</span><span class="nx">checked</span><span class="p">,</span><span class="nx">b</span><span class="p">.</span><span class="nx">appendChecked</span><span class="o">=</span><span class="nx">i</span><span class="p">.</span><span class="nx">checked</span><span class="p">,</span><span class="nx">k</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span><span class="nx">k</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">q</span><span class="p">),</span><span class="nx">q</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">a</span><span class="p">.</span><span class="nx">getComputedStyle</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">j</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">),</span><span class="nx">j</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="nx">j</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">marginRight</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="nx">q</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="o">=</span><span class="s2">&quot;2px&quot;</span><span class="p">,</span><span class="nx">q</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">j</span><span class="p">),</span><span class="nx">b</span><span class="p">.</span><span class="nx">reliableMarginRight</span><span class="o">=</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">((</span><span class="nx">a</span><span class="p">.</span><span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">j</span><span class="p">,</span><span class="kc">null</span><span class="p">)</span><span class="o">||</span><span class="p">{</span><span class="nx">marginRight</span><span class="o">:</span><span class="mi">0</span><span class="p">}).</span><span class="nx">marginRight</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="o">||</span><span class="mi">0</span><span class="p">)</span><span class="o">===</span><span class="mi">0</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">q</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="nx">o</span> <span class="k">in</span><span class="p">{</span><span class="nx">submit</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">change</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">focusin</span><span class="o">:</span><span class="mi">1</span><span class="p">})</span><span class="nx">n</span><span class="o">=</span><span class="s2">&quot;on&quot;</span><span class="o">+</span><span class="nx">o</span><span class="p">,</span><span class="nx">p</span><span class="o">=</span><span class="nx">n</span> <span class="k">in</span> <span class="nx">q</span><span class="p">,</span><span class="nx">p</span><span class="o">||</span><span class="p">(</span><span class="nx">q</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span><span class="s2">&quot;return;&quot;</span><span class="p">),</span><span class="nx">p</span><span class="o">=</span><span class="k">typeof</span> <span class="nx">q</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;function&quot;</span><span class="p">),</span><span class="nx">b</span><span class="p">[</span><span class="nx">o</span><span class="o">+</span><span class="s2">&quot;Bubbles&quot;</span><span class="p">]</span><span class="o">=</span><span class="nx">p</span><span class="p">;</span><span class="nx">k</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">q</span><span class="p">),</span><span class="nx">k</span><span class="o">=</span><span class="nx">g</span><span class="o">=</span><span class="nx">h</span><span class="o">=</span><span class="nx">j</span><span class="o">=</span><span class="nx">q</span><span class="o">=</span><span class="nx">i</span><span class="o">=</span><span class="kc">null</span><span class="p">,</span><span class="nx">f</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="nx">k</span><span class="p">,</span><span class="nx">m</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">o</span><span class="p">,</span><span class="nx">r</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span><span class="o">!</span><span class="nx">r</span><span class="o">||</span><span class="p">(</span><span class="nx">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="s2">&quot;position:absolute;top:0;left:0;width:1px;height:1px;margin:0;&quot;</span><span class="p">,</span><span class="nx">m</span><span class="o">=</span><span class="s2">&quot;visibility:hidden;border:0;&quot;</span><span class="p">,</span><span class="nx">n</span><span class="o">=</span><span class="s2">&quot;style=&#39;&quot;</span><span class="o">+</span><span class="nx">k</span><span class="o">+</span><span class="s2">&quot;border:5px solid #000;padding:0;&#39;&quot;</span><span class="p">,</span><span class="nx">o</span><span class="o">=</span><span class="s2">&quot;&lt;div &quot;</span><span class="o">+</span><span class="nx">n</span><span class="o">+</span><span class="s2">&quot;&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;&quot;</span><span class="o">+</span><span class="s2">&quot;&lt;table &quot;</span><span class="o">+</span><span class="nx">n</span><span class="o">+</span><span class="s2">&quot; cellpadding=&#39;0&#39; cellspacing=&#39;0&#39;&gt;&quot;</span><span class="o">+</span><span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;</span><span class="p">,</span><span class="nx">a</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">),</span><span class="nx">a</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">cssText</span><span class="o">=</span><span class="nx">m</span><span class="o">+</span><span class="s2">&quot;width:0;height:0;position:static;top:0;margin-top:&quot;</span><span class="o">+</span><span class="nx">j</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">,</span><span class="nx">r</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">r</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">),</span><span class="nx">q</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">),</span><span class="nx">a</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">q</span><span class="p">),</span><span class="nx">q</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="s2">&quot;&lt;table&gt;&lt;tr&gt;&lt;td style=&#39;padding:0;border:0;display:none&#39;&gt;&lt;/td&gt;&lt;td&gt;t&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;</span><span class="p">,</span><span class="nx">l</span><span class="o">=</span><span class="nx">q</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;td&quot;</span><span class="p">),</span><span class="nx">p</span><span class="o">=</span><span class="nx">l</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">offsetHeight</span><span class="o">===</span><span class="mi">0</span><span class="p">,</span><span class="nx">l</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">l</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span><span class="nx">b</span><span class="p">.</span><span class="nx">reliableHiddenOffsets</span><span class="o">=</span><span class="nx">p</span><span class="o">&amp;&amp;</span><span class="nx">l</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">offsetHeight</span><span class="o">===</span><span class="mi">0</span><span class="p">,</span><span class="nx">q</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">q</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="o">=</span><span class="nx">q</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">paddingLeft</span><span class="o">=</span><span class="s2">&quot;1px&quot;</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">boxModel</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">boxModel</span><span class="o">=</span><span class="nx">q</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="o">===</span><span class="mi">2</span><span class="p">,</span><span class="k">typeof</span> <span class="nx">q</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">zoom</span><span class="o">!=</span><span class="s2">&quot;undefined&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">q</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="s2">&quot;inline&quot;</span><span class="p">,</span><span class="nx">q</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">zoom</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nx">b</span><span class="p">.</span><span class="nx">inlineBlockNeedsLayout</span><span class="o">=</span><span class="nx">q</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="o">===</span><span class="mi">2</span><span class="p">,</span><span class="nx">q</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">q</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="s2">&quot;&lt;div style=&#39;width:4px;&#39;&gt;&lt;/div&gt;&quot;</span><span class="p">,</span><span class="nx">b</span><span class="p">.</span><span class="nx">shrinkWrapBlocks</span><span class="o">=</span><span class="nx">q</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="o">!==</span><span class="mi">2</span><span class="p">),</span><span class="nx">q</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">cssText</span><span class="o">=</span><span class="nx">k</span><span class="o">+</span><span class="nx">m</span><span class="p">,</span><span class="nx">q</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">o</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">q</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="p">{</span><span class="nx">doesNotAddBorder</span><span class="o">:</span><span class="nx">e</span><span class="p">.</span><span class="nx">offsetTop</span><span class="o">!==</span><span class="mi">5</span><span class="p">,</span><span class="nx">doesAddBorderForTableAndCells</span><span class="o">:</span><span class="nx">h</span><span class="p">.</span><span class="nx">offsetTop</span><span class="o">===</span><span class="mi">5</span><span class="p">},</span><span class="nx">e</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span><span class="o">=</span><span class="s2">&quot;fixed&quot;</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span><span class="o">=</span><span class="s2">&quot;20px&quot;</span><span class="p">,</span><span class="nx">i</span><span class="p">.</span><span class="nx">fixedPosition</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">offsetTop</span><span class="o">===</span><span class="mi">20</span><span class="o">||</span><span class="nx">e</span><span class="p">.</span><span class="nx">offsetTop</span><span class="o">===</span><span class="mi">15</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">overflow</span><span class="o">=</span><span class="s2">&quot;hidden&quot;</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span><span class="o">=</span><span class="s2">&quot;relative&quot;</span><span class="p">,</span><span class="nx">i</span><span class="p">.</span><span class="nx">subtractsBorderForOverflowNotVisible</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">offsetTop</span><span class="o">===-</span><span class="mi">5</span><span class="p">,</span><span class="nx">i</span><span class="p">.</span><span class="nx">doesNotIncludeMarginInBodyOffset</span><span class="o">=</span><span class="nx">r</span><span class="p">.</span><span class="nx">offsetTop</span><span class="o">!==</span><span class="nx">j</span><span class="p">,</span><span class="nx">r</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span><span class="nx">q</span><span class="o">=</span><span class="nx">a</span><span class="o">=</span><span class="kc">null</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">i</span><span class="p">))});</span><span class="k">return</span> <span class="nx">b</span><span class="p">}();</span><span class="kd">var</span> <span class="nx">j</span><span class="o">=</span><span class="sr">/^(?:\{.*\}|\[.*\])$/</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="sr">/([A-Z])/g</span><span class="p">;</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">cache</span><span class="o">:</span><span class="p">{},</span><span class="nx">uuid</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">expando</span><span class="o">:</span><span class="s2">&quot;jQuery&quot;</span><span class="o">+</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">jquery</span><span class="o">+</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\D/g</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span><span class="nx">noData</span><span class="o">:</span><span class="p">{</span><span class="nx">embed</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">object</span><span class="o">:</span><span class="s2">&quot;clsid:D27CDB6E-AE6D-11cf-96B8-444553540000&quot;</span><span class="p">,</span><span class="nx">applet</span><span class="o">:!</span><span class="mi">0</span><span class="p">},</span><span class="nx">hasData</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">cache</span><span class="p">[</span><span class="nx">a</span><span class="p">[</span><span class="nx">f</span><span class="p">.</span><span class="nx">expando</span><span class="p">]]</span><span class="o">:</span><span class="nx">a</span><span class="p">[</span><span class="nx">f</span><span class="p">.</span><span class="nx">expando</span><span class="p">];</span><span class="k">return</span><span class="o">!!</span><span class="nx">a</span><span class="o">&amp;&amp;!</span><span class="nx">m</span><span class="p">(</span><span class="nx">a</span><span class="p">)},</span><span class="nx">data</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!!</span><span class="nx">f</span><span class="p">.</span><span class="nx">acceptData</span><span class="p">(</span><span class="nx">a</span><span class="p">)){</span><span class="kd">var</span> <span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">expando</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="k">typeof</span> <span class="nx">c</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="nx">l</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="p">,</span><span class="nx">m</span><span class="o">=</span><span class="nx">l</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">cache</span><span class="o">:</span><span class="nx">a</span><span class="p">,</span><span class="nx">n</span><span class="o">=</span><span class="nx">l</span><span class="o">?</span><span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span><span class="o">:</span><span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">j</span><span class="p">,</span><span class="nx">o</span><span class="o">=</span><span class="nx">c</span><span class="o">===</span><span class="s2">&quot;events&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">((</span><span class="o">!</span><span class="nx">n</span><span class="o">||!</span><span class="nx">m</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="o">||!</span><span class="nx">o</span><span class="o">&amp;&amp;!</span><span class="nx">e</span><span class="o">&amp;&amp;!</span><span class="nx">m</span><span class="p">[</span><span class="nx">n</span><span class="p">].</span><span class="nx">data</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">k</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="o">===</span><span class="nx">b</span><span class="p">)</span><span class="k">return</span><span class="p">;</span><span class="nx">n</span><span class="o">||</span><span class="p">(</span><span class="nx">l</span><span class="o">?</span><span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span><span class="o">=</span><span class="nx">n</span><span class="o">=++</span><span class="nx">f</span><span class="p">.</span><span class="nx">uuid</span><span class="o">:</span><span class="nx">n</span><span class="o">=</span><span class="nx">j</span><span class="p">),</span><span class="nx">m</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="o">||</span><span class="p">(</span><span class="nx">m</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="o">=</span><span class="p">{},</span><span class="nx">l</span><span class="o">||</span><span class="p">(</span><span class="nx">m</span><span class="p">[</span><span class="nx">n</span><span class="p">].</span><span class="nx">toJSON</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">noop</span><span class="p">));</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">c</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="o">||</span><span class="k">typeof</span> <span class="nx">c</span><span class="o">==</span><span class="s2">&quot;function&quot;</span><span class="p">)</span><span class="nx">e</span><span class="o">?</span><span class="nx">m</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">m</span><span class="p">[</span><span class="nx">n</span><span class="p">],</span><span class="nx">c</span><span class="p">)</span><span class="o">:</span><span class="nx">m</span><span class="p">[</span><span class="nx">n</span><span class="p">].</span><span class="nx">data</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">m</span><span class="p">[</span><span class="nx">n</span><span class="p">].</span><span class="nx">data</span><span class="p">,</span><span class="nx">c</span><span class="p">);</span><span class="nx">g</span><span class="o">=</span><span class="nx">h</span><span class="o">=</span><span class="nx">m</span><span class="p">[</span><span class="nx">n</span><span class="p">],</span><span class="nx">e</span><span class="o">||</span><span class="p">(</span><span class="nx">h</span><span class="p">.</span><span class="nx">data</span><span class="o">||</span><span class="p">(</span><span class="nx">h</span><span class="p">.</span><span class="nx">data</span><span class="o">=</span><span class="p">{}),</span><span class="nx">h</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">data</span><span class="p">),</span><span class="nx">d</span><span class="o">!==</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">h</span><span class="p">[</span><span class="nx">f</span><span class="p">.</span><span class="nx">camelCase</span><span class="p">(</span><span class="nx">c</span><span class="p">)]</span><span class="o">=</span><span class="nx">d</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">o</span><span class="o">&amp;&amp;!</span><span class="nx">h</span><span class="p">[</span><span class="nx">c</span><span class="p">])</span><span class="k">return</span> <span class="nx">g</span><span class="p">.</span><span class="nx">events</span><span class="p">;</span><span class="nx">k</span><span class="o">?</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="nx">h</span><span class="p">[</span><span class="nx">c</span><span class="p">],</span><span class="nx">i</span><span class="o">==</span><span class="kc">null</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="nx">h</span><span class="p">[</span><span class="nx">f</span><span class="p">.</span><span class="nx">camelCase</span><span class="p">(</span><span class="nx">c</span><span class="p">)]))</span><span class="o">:</span><span class="nx">i</span><span class="o">=</span><span class="nx">h</span><span class="p">;</span><span class="k">return</span> <span class="nx">i</span><span class="p">}},</span><span class="nx">removeData</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!!</span><span class="nx">f</span><span class="p">.</span><span class="nx">acceptData</span><span class="p">(</span><span class="nx">a</span><span class="p">)){</span><span class="kd">var</span> <span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">expando</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="nx">i</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">cache</span><span class="o">:</span><span class="nx">a</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="nx">i</span><span class="o">?</span><span class="nx">a</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span><span class="o">:</span><span class="nx">h</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">j</span><span class="p">[</span><span class="nx">k</span><span class="p">])</span><span class="k">return</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="nx">d</span><span class="o">=</span><span class="nx">c</span><span class="o">?</span><span class="nx">j</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span><span class="o">:</span><span class="nx">j</span><span class="p">[</span><span class="nx">k</span><span class="p">].</span><span class="nx">data</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="nx">b</span> <span class="k">in</span> <span class="nx">d</span><span class="o">?</span><span class="nx">b</span><span class="o">=</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">:</span><span class="p">(</span><span class="nx">b</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">camelCase</span><span class="p">(</span><span class="nx">b</span><span class="p">),</span><span class="nx">b</span> <span class="k">in</span> <span class="nx">d</span><span class="o">?</span><span class="nx">b</span><span class="o">=</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">:</span><span class="nx">b</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)));</span><span class="k">for</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">e</span><span class="o">&lt;</span><span class="nx">g</span><span class="p">;</span><span class="nx">e</span><span class="o">++</span><span class="p">)</span><span class="k">delete</span> <span class="nx">d</span><span class="p">[</span><span class="nx">b</span><span class="p">[</span><span class="nx">e</span><span class="p">]];</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">c</span><span class="o">?</span><span class="nx">m</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">isEmptyObject</span><span class="p">)(</span><span class="nx">d</span><span class="p">))</span><span class="k">return</span><span class="p">}}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">c</span><span class="p">){</span><span class="k">delete</span> <span class="nx">j</span><span class="p">[</span><span class="nx">k</span><span class="p">].</span><span class="nx">data</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">m</span><span class="p">(</span><span class="nx">j</span><span class="p">[</span><span class="nx">k</span><span class="p">]))</span><span class="k">return</span><span class="p">}</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">deleteExpando</span><span class="o">||!</span><span class="nx">j</span><span class="p">.</span><span class="nx">setInterval</span><span class="o">?</span><span class="k">delete</span> <span class="nx">j</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span><span class="o">:</span><span class="nx">j</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span><span class="o">=</span><span class="kc">null</span><span class="p">,</span><span class="nx">i</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">deleteExpando</span><span class="o">?</span><span class="k">delete</span> <span class="nx">a</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span><span class="o">:</span><span class="nx">a</span><span class="p">.</span><span class="nx">removeAttribute</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">removeAttribute</span><span class="p">(</span><span class="nx">h</span><span class="p">)</span><span class="o">:</span><span class="nx">a</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span><span class="o">=</span><span class="kc">null</span><span class="p">)}},</span><span class="nx">_data</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">)},</span><span class="nx">acceptData</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">noData</span><span class="p">[</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()];</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="k">return</span> <span class="nx">b</span><span class="o">!==!</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;classid&quot;</span><span class="p">)</span><span class="o">===</span><span class="nx">b</span><span class="p">}</span><span class="k">return</span><span class="o">!</span><span class="mi">0</span><span class="p">}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">data</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">==</span><span class="s2">&quot;undefined&quot;</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">){</span><span class="nx">h</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;!</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;parsedAttrs&quot;</span><span class="p">)){</span><span class="nx">e</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">attributes</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">j</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="nx">g</span><span class="o">=</span><span class="nx">e</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">name</span><span class="p">,</span><span class="nx">g</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;data-&quot;</span><span class="p">)</span><span class="o">===</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">g</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">camelCase</span><span class="p">(</span><span class="nx">g</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span><span class="nx">l</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">[</span><span class="nx">g</span><span class="p">]));</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;parsedAttrs&quot;</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">)}}</span><span class="k">return</span> <span class="nx">h</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="p">)</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">f</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">)});</span><span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">),</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot;.&quot;</span><span class="o">+</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="o">===</span><span class="nx">b</span><span class="p">){</span><span class="nx">h</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">triggerHandler</span><span class="p">(</span><span class="s2">&quot;getData&quot;</span><span class="o">+</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;!&quot;</span><span class="p">,[</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]]),</span><span class="nx">h</span><span class="o">===</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">h</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">a</span><span class="p">),</span><span class="nx">h</span><span class="o">=</span><span class="nx">l</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">a</span><span class="p">,</span><span class="nx">h</span><span class="p">));</span><span class="k">return</span> <span class="nx">h</span><span class="o">===</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">:</span><span class="nx">h</span><span class="p">}</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">),</span><span class="nx">e</span><span class="o">=</span><span class="p">[</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">c</span><span class="p">];</span><span class="nx">b</span><span class="p">.</span><span class="nx">triggerHandler</span><span class="p">(</span><span class="s2">&quot;setData&quot;</span><span class="o">+</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;!&quot;</span><span class="p">,</span><span class="nx">e</span><span class="p">),</span><span class="nx">f</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">),</span><span class="nx">b</span><span class="p">.</span><span class="nx">triggerHandler</span><span class="p">(</span><span class="s2">&quot;changeData&quot;</span><span class="o">+</span><span class="nx">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;!&quot;</span><span class="p">,</span><span class="nx">e</span><span class="p">)})},</span><span class="nx">removeData</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">f</span><span class="p">.</span><span class="nx">removeData</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">)})}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">_mark</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">b</span><span class="o">=</span><span class="p">(</span><span class="nx">b</span><span class="o">||</span><span class="s2">&quot;fx&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;mark&quot;</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,(</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">)</span><span class="o">||</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))},</span><span class="nx">_unmark</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="nx">a</span><span class="o">!==!</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="nx">b</span><span class="p">,</span><span class="nx">b</span><span class="o">=</span><span class="nx">a</span><span class="p">,</span><span class="nx">a</span><span class="o">=!</span><span class="mi">1</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="nx">c</span><span class="o">=</span><span class="nx">c</span><span class="o">||</span><span class="s2">&quot;fx&quot;</span><span class="p">;</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">c</span><span class="o">+</span><span class="s2">&quot;mark&quot;</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">a</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">)</span><span class="o">||</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="nx">e</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">)</span><span class="o">:</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">removeData</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">),</span><span class="nx">n</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="s2">&quot;mark&quot;</span><span class="p">))}},</span><span class="nx">queue</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">b</span><span class="o">=</span><span class="p">(</span><span class="nx">b</span><span class="o">||</span><span class="s2">&quot;fx&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;queue&quot;</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">),</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="nx">d</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span><span class="o">?</span><span class="nx">d</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">makeArray</span><span class="p">(</span><span class="nx">c</span><span class="p">))</span><span class="o">:</span><span class="nx">d</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">c</span><span class="p">));</span><span class="k">return</span> <span class="nx">d</span><span class="o">||</span><span class="p">[]}},</span><span class="nx">dequeue</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">b</span><span class="o">=</span><span class="nx">b</span><span class="o">||</span><span class="s2">&quot;fx&quot;</span><span class="p">;</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">queue</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">),</span><span class="nx">d</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">shift</span><span class="p">(),</span><span class="nx">e</span><span class="o">=</span><span class="p">{};</span><span class="nx">d</span><span class="o">===</span><span class="s2">&quot;inprogress&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">shift</span><span class="p">()),</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">b</span><span class="o">===</span><span class="s2">&quot;fx&quot;</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="s2">&quot;inprogress&quot;</span><span class="p">),</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="o">+</span><span class="s2">&quot;.run&quot;</span><span class="p">,</span><span class="nx">e</span><span class="p">),</span><span class="nx">d</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span><span class="nx">f</span><span class="p">.</span><span class="nx">dequeue</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">)},</span><span class="nx">e</span><span class="p">)),</span><span class="nx">c</span><span class="p">.</span><span class="nx">length</span><span class="o">||</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">removeData</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="o">+</span><span class="s2">&quot;queue &quot;</span><span class="o">+</span><span class="nx">b</span><span class="o">+</span><span class="s2">&quot;.run&quot;</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">),</span><span class="nx">n</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="s2">&quot;queue&quot;</span><span class="p">))}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">queue</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">!=</span><span class="s2">&quot;string&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">,</span><span class="nx">a</span><span class="o">=</span><span class="s2">&quot;fx&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="o">===</span><span class="nx">b</span><span class="p">)</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">queue</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">a</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">queue</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">);</span><span class="nx">a</span><span class="o">===</span><span class="s2">&quot;fx&quot;</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!==</span><span class="s2">&quot;inprogress&quot;</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">dequeue</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">)})},</span><span class="nx">dequeue</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">f</span><span class="p">.</span><span class="nx">dequeue</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">)})},</span><span class="nx">delay</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">a</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">fx</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">fx</span><span class="p">.</span><span class="nx">speeds</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span><span class="o">||</span><span class="nx">a</span><span class="o">:</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="o">=</span><span class="nx">b</span><span class="o">||</span><span class="s2">&quot;fx&quot;</span><span class="p">;</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">queue</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">setTimeout</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">a</span><span class="p">);</span><span class="nx">c</span><span class="p">.</span><span class="nx">stop</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">d</span><span class="p">)}})},</span><span class="nx">clearQueue</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">queue</span><span class="p">(</span><span class="nx">a</span><span class="o">||</span><span class="s2">&quot;fx&quot;</span><span class="p">,[])},</span><span class="nx">promise</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">function</span> <span class="nx">m</span><span class="p">(){</span><span class="o">--</span><span class="nx">h</span><span class="o">||</span><span class="nx">d</span><span class="p">.</span><span class="nx">resolveWith</span><span class="p">(</span><span class="nx">e</span><span class="p">,[</span><span class="nx">e</span><span class="p">])}</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">!=</span><span class="s2">&quot;string&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">,</span><span class="nx">a</span><span class="o">=</span><span class="nx">b</span><span class="p">),</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="o">||</span><span class="s2">&quot;fx&quot;</span><span class="p">;</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">Deferred</span><span class="p">(),</span><span class="nx">e</span><span class="o">=</span><span class="k">this</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">a</span><span class="o">+</span><span class="s2">&quot;defer&quot;</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="nx">a</span><span class="o">+</span><span class="s2">&quot;queue&quot;</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="nx">a</span><span class="o">+</span><span class="s2">&quot;mark&quot;</span><span class="p">,</span><span class="nx">l</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="nx">g</span><span class="o">--</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">l</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">e</span><span class="p">[</span><span class="nx">g</span><span class="p">],</span><span class="nx">i</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">e</span><span class="p">[</span><span class="nx">g</span><span class="p">],</span><span class="nx">j</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">)</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">e</span><span class="p">[</span><span class="nx">g</span><span class="p">],</span><span class="nx">k</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">))</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">e</span><span class="p">[</span><span class="nx">g</span><span class="p">],</span><span class="nx">i</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">Callbacks</span><span class="p">(</span><span class="s2">&quot;once memory&quot;</span><span class="p">),</span><span class="o">!</span><span class="mi">0</span><span class="p">))</span><span class="nx">h</span><span class="o">++</span><span class="p">,</span><span class="nx">l</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">m</span><span class="p">);</span><span class="nx">m</span><span class="p">();</span><span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">promise</span><span class="p">()}});</span><span class="kd">var</span> <span class="nx">o</span><span class="o">=</span><span class="sr">/[\n\t\r]/g</span><span class="p">,</span><span class="nx">p</span><span class="o">=</span><span class="sr">/\s+/</span><span class="p">,</span><span class="nx">q</span><span class="o">=</span><span class="sr">/\r/g</span><span class="p">,</span><span class="nx">r</span><span class="o">=</span><span class="sr">/^(?:button|input)$/i</span><span class="p">,</span><span class="nx">s</span><span class="o">=</span><span class="sr">/^(?:button|input|object|select|textarea)$/i</span><span class="p">,</span><span class="nx">t</span><span class="o">=</span><span class="sr">/^a(?:rea)?$/i</span><span class="p">,</span><span class="nx">u</span><span class="o">=</span><span class="sr">/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i</span><span class="p">,</span><span class="nx">v</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">getSetAttribute</span><span class="p">,</span><span class="nx">w</span><span class="p">,</span><span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">;</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">attr</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">access</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">attr</span><span class="p">)},</span><span class="nx">removeAttr</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">f</span><span class="p">.</span><span class="nx">removeAttr</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">)})},</span><span class="nx">prop</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">access</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">prop</span><span class="p">)},</span><span class="nx">removeProp</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">a</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">propFix</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span><span class="o">||</span><span class="nx">a</span><span class="p">;</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="k">try</span><span class="p">{</span><span class="k">this</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span><span class="o">=</span><span class="nx">b</span><span class="p">,</span><span class="k">delete</span> <span class="k">this</span><span class="p">[</span><span class="nx">a</span><span class="p">]}</span><span class="k">catch</span><span class="p">(</span><span class="nx">c</span><span class="p">){}})},</span><span class="nx">addClass</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">className</span><span class="p">))});</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="p">){</span><span class="nx">b</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="nx">p</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">c</span><span class="o">&lt;</span><span class="nx">d</span><span class="p">;</span><span class="nx">c</span><span class="o">++</span><span class="p">){</span><span class="nx">e</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="nx">c</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">e</span><span class="p">.</span><span class="nx">className</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="o">===</span><span class="mi">1</span><span class="p">)</span><span class="nx">e</span><span class="p">.</span><span class="nx">className</span><span class="o">=</span><span class="nx">a</span><span class="p">;</span><span class="k">else</span><span class="p">{</span><span class="nx">g</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">e</span><span class="p">.</span><span class="nx">className</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nx">h</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">h</span><span class="o">&lt;</span><span class="nx">i</span><span class="p">;</span><span class="nx">h</span><span class="o">++</span><span class="p">)</span><span class="o">~</span><span class="nx">g</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">b</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="nx">g</span><span class="o">+=</span><span class="nx">b</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="p">);</span><span class="nx">e</span><span class="p">.</span><span class="nx">className</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">g</span><span class="p">)}}}</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">removeClass</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">className</span><span class="p">))});</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="o">||</span><span class="nx">a</span><span class="o">===</span><span class="nx">b</span><span class="p">){</span><span class="nx">c</span><span class="o">=</span><span class="p">(</span><span class="nx">a</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="nx">p</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">d</span><span class="o">&lt;</span><span class="nx">e</span><span class="p">;</span><span class="nx">d</span><span class="o">++</span><span class="p">){</span><span class="nx">g</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="nx">d</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">g</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">g</span><span class="p">.</span><span class="nx">className</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">h</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">g</span><span class="p">.</span><span class="nx">className</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">j</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="nx">h</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">c</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">);</span><span class="nx">g</span><span class="p">.</span><span class="nx">className</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">h</span><span class="p">)}</span><span class="k">else</span> <span class="nx">g</span><span class="p">.</span><span class="nx">className</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">}}</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">toggleClass</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="k">typeof</span> <span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="k">typeof</span> <span class="nx">b</span><span class="o">==</span><span class="s2">&quot;boolean&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">toggleClass</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">className</span><span class="p">,</span><span class="nx">b</span><span class="p">),</span><span class="nx">b</span><span class="p">)});</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="o">===</span><span class="s2">&quot;string&quot;</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">),</span><span class="nx">i</span><span class="o">=</span><span class="nx">b</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="nx">p</span><span class="p">);</span><span class="k">while</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">j</span><span class="p">[</span><span class="nx">g</span><span class="o">++</span><span class="p">])</span><span class="nx">i</span><span class="o">=</span><span class="nx">d</span><span class="o">?</span><span class="nx">i</span><span class="o">:!</span><span class="nx">h</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="nx">e</span><span class="p">),</span><span class="nx">h</span><span class="p">[</span><span class="nx">i</span><span class="o">?</span><span class="s2">&quot;addClass&quot;</span><span class="o">:</span><span class="s2">&quot;removeClass&quot;</span><span class="p">](</span><span class="nx">e</span><span class="p">)}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="o">===</span><span class="s2">&quot;undefined&quot;</span><span class="o">||</span><span class="nx">c</span><span class="o">===</span><span class="s2">&quot;boolean&quot;</span><span class="p">)</span><span class="k">this</span><span class="p">.</span><span class="nx">className</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;__className__&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">className</span><span class="p">),</span><span class="k">this</span><span class="p">.</span><span class="nx">className</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">className</span><span class="o">||</span><span class="nx">a</span><span class="o">===!</span><span class="mi">1</span><span class="o">?</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;__className__&quot;</span><span class="p">)</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">})},</span><span class="nx">hasClass</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">a</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">for</span><span class="p">(;</span><span class="nx">c</span><span class="o">&lt;</span><span class="nx">d</span><span class="p">;</span><span class="nx">c</span><span class="o">++</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">c</span><span class="p">].</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="k">this</span><span class="p">[</span><span class="nx">c</span><span class="p">].</span><span class="nx">className</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">).</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span><span class="o">!</span><span class="mi">0</span><span class="p">;</span><span class="k">return</span><span class="o">!</span><span class="mi">1</span><span class="p">},</span><span class="nx">val</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">];{</span><span class="k">if</span><span class="p">(</span><span class="o">!!</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">){</span><span class="nx">e</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">g</span><span class="o">=</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">),</span><span class="nx">h</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="p">){</span><span class="nx">e</span><span class="o">?</span><span class="nx">h</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">g</span><span class="p">.</span><span class="nx">val</span><span class="p">())</span><span class="o">:</span><span class="nx">h</span><span class="o">=</span><span class="nx">a</span><span class="p">,</span><span class="nx">h</span><span class="o">==</span><span class="kc">null</span><span class="o">?</span><span class="nx">h</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="k">typeof</span> <span class="nx">h</span><span class="o">==</span><span class="s2">&quot;number&quot;</span><span class="o">?</span><span class="nx">h</span><span class="o">+=</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">h</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">h</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">h</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="o">==</span><span class="kc">null</span><span class="o">?</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="nx">a</span><span class="o">+</span><span class="s2">&quot;&quot;</span><span class="p">})),</span><span class="nx">c</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">valHooks</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()]</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">valHooks</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">type</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">c</span><span class="o">||!</span><span class="p">(</span><span class="s2">&quot;set&quot;</span><span class="k">in</span> <span class="nx">c</span><span class="p">)</span><span class="o">||</span><span class="nx">c</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">)</span><span class="o">===</span><span class="nx">b</span><span class="p">)</span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="nx">h</span><span class="p">}})}</span><span class="k">if</span><span class="p">(</span><span class="nx">g</span><span class="p">){</span><span class="nx">c</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">valHooks</span><span class="p">[</span><span class="nx">g</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()]</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">valHooks</span><span class="p">[</span><span class="nx">g</span><span class="p">.</span><span class="nx">type</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="s2">&quot;get&quot;</span><span class="k">in</span> <span class="nx">c</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">g</span><span class="p">,</span><span class="s2">&quot;value&quot;</span><span class="p">))</span><span class="o">!==</span><span class="nx">b</span><span class="p">)</span><span class="k">return</span> <span class="nx">d</span><span class="p">;</span><span class="nx">d</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span><span class="k">return</span> <span class="k">typeof</span> <span class="nx">d</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="o">?</span><span class="nx">d</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">q</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">:</span><span class="nx">d</span><span class="o">==</span><span class="kc">null</span><span class="o">?</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="nx">d</span><span class="p">}}}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">valHooks</span><span class="o">:</span><span class="p">{</span><span class="nx">option</span><span class="o">:</span><span class="p">{</span><span class="nx">get</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span><span class="k">return</span><span class="o">!</span><span class="nx">b</span><span class="o">||</span><span class="nx">b</span><span class="p">.</span><span class="nx">specified</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">value</span><span class="o">:</span><span class="nx">a</span><span class="p">.</span><span class="nx">text</span><span class="p">}},</span><span class="nx">select</span><span class="o">:</span><span class="p">{</span><span class="nx">get</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">selectedIndex</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="p">[],</span><span class="nx">i</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">options</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="o">===</span><span class="s2">&quot;select-one&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">g</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="kc">null</span><span class="p">;</span><span class="nx">c</span><span class="o">=</span><span class="nx">j</span><span class="o">?</span><span class="nx">g</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">j</span><span class="o">?</span><span class="nx">g</span><span class="o">+</span><span class="mi">1</span><span class="o">:</span><span class="nx">i</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">for</span><span class="p">(;</span><span class="nx">c</span><span class="o">&lt;</span><span class="nx">d</span><span class="p">;</span><span class="nx">c</span><span class="o">++</span><span class="p">){</span><span class="nx">e</span><span class="o">=</span><span class="nx">i</span><span class="p">[</span><span class="nx">c</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">selected</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">optDisabled</span><span class="o">?!</span><span class="nx">e</span><span class="p">.</span><span class="nx">disabled</span><span class="o">:</span><span class="nx">e</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;disabled&quot;</span><span class="p">)</span><span class="o">===</span><span class="kc">null</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="nx">e</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">disabled</span><span class="o">||!</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">,</span><span class="s2">&quot;optgroup&quot;</span><span class="p">))){</span><span class="nx">b</span><span class="o">=</span><span class="nx">f</span><span class="p">(</span><span class="nx">e</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">j</span><span class="p">)</span><span class="k">return</span> <span class="nx">b</span><span class="p">;</span><span class="nx">h</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">b</span><span class="p">)}}</span><span class="k">if</span><span class="p">(</span><span class="nx">j</span><span class="o">&amp;&amp;!</span><span class="nx">h</span><span class="p">.</span><span class="nx">length</span><span class="o">&amp;&amp;</span><span class="nx">i</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="k">return</span> <span class="nx">f</span><span class="p">(</span><span class="nx">i</span><span class="p">[</span><span class="nx">g</span><span class="p">]).</span><span class="nx">val</span><span class="p">();</span><span class="k">return</span> <span class="nx">h</span><span class="p">},</span><span class="nx">set</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">makeArray</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span><span class="nx">f</span><span class="p">(</span><span class="nx">a</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;option&quot;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">selected</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">inArray</span><span class="p">(</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span><span class="nx">c</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">}),</span><span class="nx">c</span><span class="p">.</span><span class="nx">length</span><span class="o">||</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">selectedIndex</span><span class="o">=-</span><span class="mi">1</span><span class="p">);</span><span class="k">return</span> <span class="nx">c</span><span class="p">}}},</span><span class="nx">attrFn</span><span class="o">:</span><span class="p">{</span><span class="nx">val</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">css</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">html</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">text</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">data</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">width</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">height</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">offset</span><span class="o">:!</span><span class="mi">0</span><span class="p">},</span><span class="nx">attr</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">){</span><span class="kd">var</span> <span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!!</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="nx">j</span><span class="o">!==</span><span class="mi">3</span><span class="o">&amp;&amp;</span><span class="nx">j</span><span class="o">!==</span><span class="mi">8</span><span class="o">&amp;&amp;</span><span class="nx">j</span><span class="o">!==</span><span class="mi">2</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="o">&amp;&amp;</span><span class="nx">c</span> <span class="k">in</span> <span class="nx">f</span><span class="p">.</span><span class="nx">attrFn</span><span class="p">)</span><span class="k">return</span> <span class="nx">f</span><span class="p">(</span><span class="nx">a</span><span class="p">)[</span><span class="nx">c</span><span class="p">](</span><span class="nx">d</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span><span class="p">.</span><span class="nx">getAttribute</span><span class="o">==</span><span class="s2">&quot;undefined&quot;</span><span class="p">)</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">prop</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">);</span><span class="nx">i</span><span class="o">=</span><span class="nx">j</span><span class="o">!==</span><span class="mi">1</span><span class="o">||!</span><span class="nx">f</span><span class="p">.</span><span class="nx">isXMLDoc</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span><span class="nx">i</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">(),</span><span class="nx">h</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">attrHooks</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">||</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span><span class="o">?</span><span class="nx">x</span><span class="o">:</span><span class="nx">w</span><span class="p">));</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="o">!==</span><span class="nx">b</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="o">===</span><span class="kc">null</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">removeAttr</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">);</span><span class="k">return</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">h</span><span class="o">&amp;&amp;</span><span class="s2">&quot;set&quot;</span><span class="k">in</span> <span class="nx">h</span><span class="o">&amp;&amp;</span><span class="nx">i</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">g</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">c</span><span class="p">))</span><span class="o">!==</span><span class="nx">b</span><span class="p">)</span><span class="k">return</span> <span class="nx">g</span><span class="p">;</span><span class="nx">a</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="o">+</span><span class="nx">d</span><span class="p">);</span><span class="k">return</span> <span class="nx">d</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">h</span><span class="o">&amp;&amp;</span><span class="s2">&quot;get&quot;</span><span class="k">in</span> <span class="nx">h</span><span class="o">&amp;&amp;</span><span class="nx">i</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">g</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">))</span><span class="o">!==</span><span class="kc">null</span><span class="p">)</span><span class="k">return</span> <span class="nx">g</span><span class="p">;</span><span class="nx">g</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="nx">c</span><span class="p">);</span><span class="k">return</span> <span class="nx">g</span><span class="o">===</span><span class="kc">null</span><span class="o">?</span><span class="nx">b</span><span class="o">:</span><span class="nx">g</span><span class="p">}},</span><span class="nx">removeAttr</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="p">){</span><span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">split</span><span class="p">(</span><span class="nx">p</span><span class="p">),</span><span class="nx">g</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">for</span><span class="p">(;</span><span class="nx">h</span><span class="o">&lt;</span><span class="nx">g</span><span class="p">;</span><span class="nx">h</span><span class="o">++</span><span class="p">)</span><span class="nx">e</span><span class="o">=</span><span class="nx">d</span><span class="p">[</span><span class="nx">h</span><span class="p">],</span><span class="nx">e</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">propFix</span><span class="p">[</span><span class="nx">e</span><span class="p">]</span><span class="o">||</span><span class="nx">e</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span><span class="nx">a</span><span class="p">.</span><span class="nx">removeAttribute</span><span class="p">(</span><span class="nx">v</span><span class="o">?</span><span class="nx">e</span><span class="o">:</span><span class="nx">c</span><span class="p">),</span><span class="nx">u</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">c</span> <span class="k">in</span> <span class="nx">a</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">=!</span><span class="mi">1</span><span class="p">))}},</span><span class="nx">attrHooks</span><span class="o">:</span><span class="p">{</span><span class="nx">type</span><span class="o">:</span><span class="p">{</span><span class="nx">set</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">)</span><span class="nx">f</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;type property can&#39;t be changed&quot;</span><span class="p">);</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">radioValue</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="o">===</span><span class="s2">&quot;radio&quot;</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;input&quot;</span><span class="p">)){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span><span class="nx">a</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span><span class="nx">b</span><span class="p">),</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="nx">c</span><span class="p">);</span><span class="k">return</span> <span class="nx">b</span><span class="p">}}},</span><span class="nx">value</span><span class="o">:</span><span class="p">{</span><span class="nx">get</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">w</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;button&quot;</span><span class="p">))</span><span class="k">return</span> <span class="nx">w</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">);</span><span class="k">return</span> <span class="nx">b</span> <span class="k">in</span> <span class="nx">a</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">value</span><span class="o">:</span><span class="kc">null</span><span class="p">},</span><span class="nx">set</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">w</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;button&quot;</span><span class="p">))</span><span class="k">return</span> <span class="nx">w</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">);</span><span class="nx">a</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="nx">b</span><span class="p">}}},</span><span class="nx">propFix</span><span class="o">:</span><span class="p">{</span><span class="nx">tabindex</span><span class="o">:</span><span class="s2">&quot;tabIndex&quot;</span><span class="p">,</span><span class="nx">readonly</span><span class="o">:</span><span class="s2">&quot;readOnly&quot;</span><span class="p">,</span><span class="s2">&quot;for&quot;</span><span class="o">:</span><span class="s2">&quot;htmlFor&quot;</span><span class="p">,</span><span class="s2">&quot;class&quot;</span><span class="o">:</span><span class="s2">&quot;className&quot;</span><span class="p">,</span><span class="nx">maxlength</span><span class="o">:</span><span class="s2">&quot;maxLength&quot;</span><span class="p">,</span><span class="nx">cellspacing</span><span class="o">:</span><span class="s2">&quot;cellSpacing&quot;</span><span class="p">,</span><span class="nx">cellpadding</span><span class="o">:</span><span class="s2">&quot;cellPadding&quot;</span><span class="p">,</span><span class="nx">rowspan</span><span class="o">:</span><span class="s2">&quot;rowSpan&quot;</span><span class="p">,</span><span class="nx">colspan</span><span class="o">:</span><span class="s2">&quot;colSpan&quot;</span><span class="p">,</span><span class="nx">usemap</span><span class="o">:</span><span class="s2">&quot;useMap&quot;</span><span class="p">,</span><span class="nx">frameborder</span><span class="o">:</span><span class="s2">&quot;frameBorder&quot;</span><span class="p">,</span><span class="nx">contenteditable</span><span class="o">:</span><span class="s2">&quot;contentEditable&quot;</span><span class="p">},</span><span class="nx">prop</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!!</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="nx">i</span><span class="o">!==</span><span class="mi">3</span><span class="o">&amp;&amp;</span><span class="nx">i</span><span class="o">!==</span><span class="mi">8</span><span class="o">&amp;&amp;</span><span class="nx">i</span><span class="o">!==</span><span class="mi">2</span><span class="p">){</span><span class="nx">h</span><span class="o">=</span><span class="nx">i</span><span class="o">!==</span><span class="mi">1</span><span class="o">||!</span><span class="nx">f</span><span class="p">.</span><span class="nx">isXMLDoc</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span><span class="nx">h</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">propFix</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">||</span><span class="nx">c</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">propHooks</span><span class="p">[</span><span class="nx">c</span><span class="p">]);</span><span class="k">return</span> <span class="nx">d</span><span class="o">!==</span><span class="nx">b</span><span class="o">?</span><span class="nx">g</span><span class="o">&amp;&amp;</span><span class="s2">&quot;set&quot;</span><span class="k">in</span> <span class="nx">g</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">c</span><span class="p">))</span><span class="o">!==</span><span class="nx">b</span><span class="o">?</span><span class="nx">e</span><span class="o">:</span><span class="nx">a</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">=</span><span class="nx">d</span><span class="o">:</span><span class="nx">g</span><span class="o">&amp;&amp;</span><span class="s2">&quot;get&quot;</span><span class="k">in</span> <span class="nx">g</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">))</span><span class="o">!==</span><span class="kc">null</span><span class="o">?</span><span class="nx">e</span><span class="o">:</span><span class="nx">a</span><span class="p">[</span><span class="nx">c</span><span class="p">]}},</span><span class="nx">propHooks</span><span class="o">:</span><span class="p">{</span><span class="nx">tabIndex</span><span class="o">:</span><span class="p">{</span><span class="nx">get</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">getAttributeNode</span><span class="p">(</span><span class="s2">&quot;tabindex&quot;</span><span class="p">);</span><span class="k">return</span> <span class="nx">c</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="p">.</span><span class="nx">specified</span><span class="o">?</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="o">:</span><span class="nx">s</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">)</span><span class="o">||</span><span class="nx">t</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">href</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="nx">b</span><span class="p">}}}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">attrHooks</span><span class="p">.</span><span class="nx">tabindex</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">propHooks</span><span class="p">.</span><span class="nx">tabIndex</span><span class="p">,</span><span class="nx">x</span><span class="o">=</span><span class="p">{</span><span class="nx">get</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">prop</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">);</span><span class="k">return</span> <span class="nx">e</span><span class="o">===!</span><span class="mi">0</span><span class="o">||</span><span class="k">typeof</span> <span class="nx">e</span><span class="o">!=</span><span class="s2">&quot;boolean&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">getAttributeNode</span><span class="p">(</span><span class="nx">c</span><span class="p">))</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">nodeValue</span><span class="o">!==!</span><span class="mi">1</span><span class="o">?</span><span class="nx">c</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="o">:</span><span class="nx">b</span><span class="p">},</span><span class="nx">set</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="p">;</span><span class="nx">b</span><span class="o">===!</span><span class="mi">1</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">removeAttr</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">)</span><span class="o">:</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">propFix</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">||</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span> <span class="k">in</span> <span class="nx">a</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">=!</span><span class="mi">0</span><span class="p">),</span><span class="nx">a</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">c</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()));</span><span class="k">return</span> <span class="nx">c</span><span class="p">}},</span><span class="nx">v</span><span class="o">||</span><span class="p">(</span><span class="nx">y</span><span class="o">=</span><span class="p">{</span><span class="nx">name</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">id</span><span class="o">:!</span><span class="mi">0</span><span class="p">},</span><span class="nx">w</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">valHooks</span><span class="p">.</span><span class="nx">button</span><span class="o">=</span><span class="p">{</span><span class="nx">get</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="p">;</span><span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">getAttributeNode</span><span class="p">(</span><span class="nx">c</span><span class="p">);</span><span class="k">return</span> <span class="nx">d</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">y</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">?</span><span class="nx">d</span><span class="p">.</span><span class="nx">nodeValue</span><span class="o">!==</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="nx">d</span><span class="p">.</span><span class="nx">specified</span><span class="p">)</span><span class="o">?</span><span class="nx">d</span><span class="p">.</span><span class="nx">nodeValue</span><span class="o">:</span><span class="nx">b</span><span class="p">},</span><span class="nx">set</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">getAttributeNode</span><span class="p">(</span><span class="nx">d</span><span class="p">);</span><span class="nx">e</span><span class="o">||</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">createAttribute</span><span class="p">(</span><span class="nx">d</span><span class="p">),</span><span class="nx">a</span><span class="p">.</span><span class="nx">setAttributeNode</span><span class="p">(</span><span class="nx">e</span><span class="p">));</span><span class="k">return</span> <span class="nx">e</span><span class="p">.</span><span class="nx">nodeValue</span><span class="o">=</span><span class="nx">b</span><span class="o">+</span><span class="s2">&quot;&quot;</span><span class="p">}},</span><span class="nx">f</span><span class="p">.</span><span class="nx">attrHooks</span><span class="p">.</span><span class="nx">tabindex</span><span class="p">.</span><span class="nx">set</span><span class="o">=</span><span class="nx">w</span><span class="p">.</span><span class="nx">set</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">([</span><span class="s2">&quot;width&quot;</span><span class="p">,</span><span class="s2">&quot;height&quot;</span><span class="p">],</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">attrHooks</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">attrHooks</span><span class="p">[</span><span class="nx">b</span><span class="p">],{</span><span class="nx">set</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="o">===</span><span class="s2">&quot;&quot;</span><span class="p">){</span><span class="nx">a</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="s2">&quot;auto&quot;</span><span class="p">);</span><span class="k">return</span> <span class="nx">c</span><span class="p">}}})}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">attrHooks</span><span class="p">.</span><span class="nx">contenteditable</span><span class="o">=</span><span class="p">{</span><span class="nx">get</span><span class="o">:</span><span class="nx">w</span><span class="p">.</span><span class="nx">get</span><span class="p">,</span><span class="nx">set</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="nx">b</span><span class="o">===</span><span class="s2">&quot;&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">b</span><span class="o">=</span><span class="s2">&quot;false&quot;</span><span class="p">),</span><span class="nx">w</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">)}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">hrefNormalized</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">([</span><span class="s2">&quot;href&quot;</span><span class="p">,</span><span class="s2">&quot;src&quot;</span><span class="p">,</span><span class="s2">&quot;width&quot;</span><span class="p">,</span><span class="s2">&quot;height&quot;</span><span class="p">],</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">attrHooks</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">attrHooks</span><span class="p">[</span><span class="nx">c</span><span class="p">],{</span><span class="nx">get</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span><span class="k">return</span> <span class="nx">d</span><span class="o">===</span><span class="kc">null</span><span class="o">?</span><span class="nx">b</span><span class="o">:</span><span class="nx">d</span><span class="p">}})}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">style</span><span class="o">||</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">attrHooks</span><span class="p">.</span><span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">get</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">cssText</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="o">||</span><span class="nx">b</span><span class="p">},</span><span class="nx">set</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">cssText</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="o">+</span><span class="nx">b</span><span class="p">}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">optSelected</span><span class="o">||</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">propHooks</span><span class="p">.</span><span class="nx">selected</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">propHooks</span><span class="p">.</span><span class="nx">selected</span><span class="p">,{</span><span class="nx">get</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">selectedIndex</span><span class="p">,</span><span class="nx">b</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">selectedIndex</span><span class="p">);</span><span class="k">return</span> <span class="kc">null</span><span class="p">}})),</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">enctype</span><span class="o">||</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">propFix</span><span class="p">.</span><span class="nx">enctype</span><span class="o">=</span><span class="s2">&quot;encoding&quot;</span><span class="p">),</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">checkOn</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">([</span><span class="s2">&quot;radio&quot;</span><span class="p">,</span><span class="s2">&quot;checkbox&quot;</span><span class="p">],</span><span class="kd">function</span><span class="p">(){</span><span class="nx">f</span><span class="p">.</span><span class="nx">valHooks</span><span class="p">[</span><span class="k">this</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="nx">get</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span><span class="o">===</span><span class="kc">null</span><span class="o">?</span><span class="s2">&quot;on&quot;</span><span class="o">:</span><span class="nx">a</span><span class="p">.</span><span class="nx">value</span><span class="p">}}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">([</span><span class="s2">&quot;radio&quot;</span><span class="p">,</span><span class="s2">&quot;checkbox&quot;</span><span class="p">],</span><span class="kd">function</span><span class="p">(){</span><span class="nx">f</span><span class="p">.</span><span class="nx">valHooks</span><span class="p">[</span><span class="k">this</span><span class="p">]</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">valHooks</span><span class="p">[</span><span class="k">this</span><span class="p">],{</span><span class="nx">set</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">b</span><span class="p">))</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">checked</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">inArray</span><span class="p">(</span><span class="nx">f</span><span class="p">(</span><span class="nx">a</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span><span class="nx">b</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">}})});</span><span class="kd">var</span> <span class="nx">z</span><span class="o">=</span><span class="sr">/^(?:textarea|input|select)$/i</span><span class="p">,</span><span class="nx">A</span><span class="o">=</span><span class="sr">/^([^\.]*)?(?:\.(.+))?$/</span><span class="p">,</span><span class="nx">B</span><span class="o">=</span><span class="sr">/\bhover(\.\S+)?\b/</span><span class="p">,</span><span class="nx">C</span><span class="o">=</span><span class="sr">/^key/</span><span class="p">,</span><span class="nx">D</span><span class="o">=</span><span class="sr">/^(?:mouse|contextmenu)|click/</span><span class="p">,</span><span class="nx">E</span><span class="o">=</span><span class="sr">/^(?:focusinfocus|focusoutblur)$/</span><span class="p">,</span><span class="nx">F</span><span class="o">=</span><span class="sr">/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/</span><span class="p">,</span><span class="nx">G</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">F</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">(),</span><span class="nx">b</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;(?:^|\\s)&quot;</span><span class="o">+</span><span class="nx">b</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;(?:\\s|$)&quot;</span><span class="p">));</span><span class="k">return</span> <span class="nx">b</span><span class="p">},</span><span class="nx">H</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">attributes</span><span class="o">||</span><span class="p">{};</span><span class="k">return</span><span class="p">(</span><span class="o">!</span><span class="nx">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="o">===</span><span class="nx">b</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="nx">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">||</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">id</span><span class="o">||</span><span class="p">{}).</span><span class="nx">value</span><span class="o">===</span><span class="nx">b</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="nx">b</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">||</span><span class="nx">b</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="nx">test</span><span class="p">((</span><span class="nx">c</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">]</span><span class="o">||</span><span class="p">{}).</span><span class="nx">value</span><span class="p">))},</span><span class="nx">I</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">.</span><span class="nx">hover</span><span class="o">?</span><span class="nx">a</span><span class="o">:</span><span class="nx">a</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">B</span><span class="p">,</span><span class="s2">&quot;mouseenter$1 mouseleave$1&quot;</span><span class="p">)};</span>
<span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="o">=</span><span class="p">{</span><span class="nx">add</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="p">){</span><span class="kd">var</span> <span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="nx">k</span><span class="p">,</span><span class="nx">l</span><span class="p">,</span><span class="nx">m</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">o</span><span class="p">,</span><span class="nx">p</span><span class="p">,</span><span class="nx">q</span><span class="p">,</span><span class="nx">r</span><span class="p">,</span><span class="nx">s</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">3</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">8</span><span class="o">||!</span><span class="nx">c</span><span class="o">||!</span><span class="nx">d</span><span class="o">||!</span><span class="p">(</span><span class="nx">h</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">a</span><span class="p">)))){</span><span class="nx">d</span><span class="p">.</span><span class="nx">handler</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">p</span><span class="o">=</span><span class="nx">d</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">p</span><span class="p">.</span><span class="nx">handler</span><span class="p">),</span><span class="nx">d</span><span class="p">.</span><span class="nx">guid</span><span class="o">||</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">guid</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">guid</span><span class="o">++</span><span class="p">),</span><span class="nx">j</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">events</span><span class="p">,</span><span class="nx">j</span><span class="o">||</span><span class="p">(</span><span class="nx">h</span><span class="p">.</span><span class="nx">events</span><span class="o">=</span><span class="nx">j</span><span class="o">=</span><span class="p">{}),</span><span class="nx">i</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">handle</span><span class="p">,</span><span class="nx">i</span><span class="o">||</span><span class="p">(</span><span class="nx">h</span><span class="p">.</span><span class="nx">handle</span><span class="o">=</span><span class="nx">i</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="k">typeof</span> <span class="nx">f</span><span class="o">!=</span><span class="s2">&quot;undefined&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="nx">a</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">triggered</span><span class="o">!==</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">i</span><span class="p">.</span><span class="nx">elem</span><span class="p">,</span><span class="nx">arguments</span><span class="p">)</span><span class="o">:</span><span class="nx">b</span><span class="p">},</span><span class="nx">i</span><span class="p">.</span><span class="nx">elem</span><span class="o">=</span><span class="nx">a</span><span class="p">),</span><span class="nx">c</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">I</span><span class="p">(</span><span class="nx">c</span><span class="p">)).</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="nx">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">k</span><span class="o">&lt;</span><span class="nx">c</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">k</span><span class="o">++</span><span class="p">){</span><span class="nx">l</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">c</span><span class="p">[</span><span class="nx">k</span><span class="p">])</span><span class="o">||</span><span class="p">[],</span><span class="nx">m</span><span class="o">=</span><span class="nx">l</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nx">n</span><span class="o">=</span><span class="p">(</span><span class="nx">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">).</span><span class="nx">sort</span><span class="p">(),</span><span class="nx">s</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">[</span><span class="nx">m</span><span class="p">]</span><span class="o">||</span><span class="p">{},</span><span class="nx">m</span><span class="o">=</span><span class="p">(</span><span class="nx">g</span><span class="o">?</span><span class="nx">s</span><span class="p">.</span><span class="nx">delegateType</span><span class="o">:</span><span class="nx">s</span><span class="p">.</span><span class="nx">bindType</span><span class="p">)</span><span class="o">||</span><span class="nx">m</span><span class="p">,</span><span class="nx">s</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">[</span><span class="nx">m</span><span class="p">]</span><span class="o">||</span><span class="p">{},</span><span class="nx">o</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">type</span><span class="o">:</span><span class="nx">m</span><span class="p">,</span><span class="nx">origType</span><span class="o">:</span><span class="nx">l</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nx">data</span><span class="o">:</span><span class="nx">e</span><span class="p">,</span><span class="nx">handler</span><span class="o">:</span><span class="nx">d</span><span class="p">,</span><span class="nx">guid</span><span class="o">:</span><span class="nx">d</span><span class="p">.</span><span class="nx">guid</span><span class="p">,</span><span class="nx">selector</span><span class="o">:</span><span class="nx">g</span><span class="p">,</span><span class="nx">quick</span><span class="o">:</span><span class="nx">G</span><span class="p">(</span><span class="nx">g</span><span class="p">),</span><span class="nx">namespace</span><span class="o">:</span><span class="nx">n</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)},</span><span class="nx">p</span><span class="p">),</span><span class="nx">r</span><span class="o">=</span><span class="nx">j</span><span class="p">[</span><span class="nx">m</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">r</span><span class="p">){</span><span class="nx">r</span><span class="o">=</span><span class="nx">j</span><span class="p">[</span><span class="nx">m</span><span class="p">]</span><span class="o">=</span><span class="p">[],</span><span class="nx">r</span><span class="p">.</span><span class="nx">delegateCount</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">s</span><span class="p">.</span><span class="nx">setup</span><span class="o">||</span><span class="nx">s</span><span class="p">.</span><span class="nx">setup</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span><span class="o">===!</span><span class="mi">1</span><span class="p">)</span><span class="nx">a</span><span class="p">.</span><span class="nx">addEventListener</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">m</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="o">!</span><span class="mi">1</span><span class="p">)</span><span class="o">:</span><span class="nx">a</span><span class="p">.</span><span class="nx">attachEvent</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s2">&quot;on&quot;</span><span class="o">+</span><span class="nx">m</span><span class="p">,</span><span class="nx">i</span><span class="p">)}</span><span class="nx">s</span><span class="p">.</span><span class="nx">add</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">o</span><span class="p">),</span><span class="nx">o</span><span class="p">.</span><span class="nx">handler</span><span class="p">.</span><span class="nx">guid</span><span class="o">||</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">handler</span><span class="p">.</span><span class="nx">guid</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">guid</span><span class="p">)),</span><span class="nx">g</span><span class="o">?</span><span class="nx">r</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">delegateCount</span><span class="o">++</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nx">o</span><span class="p">)</span><span class="o">:</span><span class="nx">r</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">o</span><span class="p">),</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">global</span><span class="p">[</span><span class="nx">m</span><span class="p">]</span><span class="o">=!</span><span class="mi">0</span><span class="p">}</span><span class="nx">a</span><span class="o">=</span><span class="kc">null</span><span class="p">}},</span><span class="nx">global</span><span class="o">:</span><span class="p">{},</span><span class="nx">remove</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">){</span><span class="kd">var</span> <span class="nx">g</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">hasData</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="nx">k</span><span class="p">,</span><span class="nx">l</span><span class="p">,</span><span class="nx">m</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">o</span><span class="p">,</span><span class="nx">p</span><span class="p">,</span><span class="nx">q</span><span class="p">,</span><span class="nx">r</span><span class="p">,</span><span class="nx">s</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!!</span><span class="nx">g</span><span class="o">&amp;&amp;!!</span><span class="p">(</span><span class="nx">o</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">events</span><span class="p">)){</span><span class="nx">b</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">I</span><span class="p">(</span><span class="nx">b</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">)).</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="nx">h</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">h</span><span class="o">&lt;</span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">h</span><span class="o">++</span><span class="p">){</span><span class="nx">i</span><span class="o">=</span><span class="nx">A</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="nx">h</span><span class="p">])</span><span class="o">||</span><span class="p">[],</span><span class="nx">j</span><span class="o">=</span><span class="nx">k</span><span class="o">=</span><span class="nx">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nx">l</span><span class="o">=</span><span class="nx">i</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">j</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="nx">j</span> <span class="k">in</span> <span class="nx">o</span><span class="p">)</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">j</span><span class="o">+</span><span class="nx">b</span><span class="p">[</span><span class="nx">h</span><span class="p">],</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">);</span><span class="k">continue</span><span class="p">}</span><span class="nx">p</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span><span class="o">||</span><span class="p">{},</span><span class="nx">j</span><span class="o">=</span><span class="p">(</span><span class="nx">d</span><span class="o">?</span><span class="nx">p</span><span class="p">.</span><span class="nx">delegateType</span><span class="o">:</span><span class="nx">p</span><span class="p">.</span><span class="nx">bindType</span><span class="p">)</span><span class="o">||</span><span class="nx">j</span><span class="p">,</span><span class="nx">r</span><span class="o">=</span><span class="nx">o</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span><span class="o">||</span><span class="p">[],</span><span class="nx">m</span><span class="o">=</span><span class="nx">r</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">l</span><span class="o">=</span><span class="nx">l</span><span class="o">?</span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;(^|\\.)&quot;</span><span class="o">+</span><span class="nx">l</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">).</span><span class="nx">sort</span><span class="p">().</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;\\.(?:.*\\.)?&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;(\\.|$)&quot;</span><span class="p">)</span><span class="o">:</span><span class="kc">null</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nx">n</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">n</span><span class="o">&lt;</span><span class="nx">r</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">n</span><span class="o">++</span><span class="p">)</span><span class="nx">s</span><span class="o">=</span><span class="nx">r</span><span class="p">[</span><span class="nx">n</span><span class="p">],(</span><span class="nx">e</span><span class="o">||</span><span class="nx">k</span><span class="o">===</span><span class="nx">s</span><span class="p">.</span><span class="nx">origType</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="nx">c</span><span class="o">||</span><span class="nx">c</span><span class="p">.</span><span class="nx">guid</span><span class="o">===</span><span class="nx">s</span><span class="p">.</span><span class="nx">guid</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="nx">l</span><span class="o">||</span><span class="nx">l</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">namespace</span><span class="p">))</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="nx">d</span><span class="o">||</span><span class="nx">d</span><span class="o">===</span><span class="nx">s</span><span class="p">.</span><span class="nx">selector</span><span class="o">||</span><span class="nx">d</span><span class="o">===</span><span class="s2">&quot;**&quot;</span><span class="o">&amp;&amp;</span><span class="nx">s</span><span class="p">.</span><span class="nx">selector</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">n</span><span class="o">--</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nx">s</span><span class="p">.</span><span class="nx">selector</span><span class="o">&amp;&amp;</span><span class="nx">r</span><span class="p">.</span><span class="nx">delegateCount</span><span class="o">--</span><span class="p">,</span><span class="nx">p</span><span class="p">.</span><span class="nx">remove</span><span class="o">&amp;&amp;</span><span class="nx">p</span><span class="p">.</span><span class="nx">remove</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">s</span><span class="p">));</span><span class="nx">r</span><span class="p">.</span><span class="nx">length</span><span class="o">===</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="nx">m</span><span class="o">!==</span><span class="nx">r</span><span class="p">.</span><span class="nx">length</span><span class="o">&amp;&amp;</span><span class="p">((</span><span class="o">!</span><span class="nx">p</span><span class="p">.</span><span class="nx">teardown</span><span class="o">||</span><span class="nx">p</span><span class="p">.</span><span class="nx">teardown</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">l</span><span class="p">)</span><span class="o">===!</span><span class="mi">1</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">removeEvent</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="nx">g</span><span class="p">.</span><span class="nx">handle</span><span class="p">),</span><span class="k">delete</span> <span class="nx">o</span><span class="p">[</span><span class="nx">j</span><span class="p">])}</span><span class="nx">f</span><span class="p">.</span><span class="nx">isEmptyObject</span><span class="p">(</span><span class="nx">o</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">q</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">handle</span><span class="p">,</span><span class="nx">q</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">q</span><span class="p">.</span><span class="nx">elem</span><span class="o">=</span><span class="kc">null</span><span class="p">),</span><span class="nx">f</span><span class="p">.</span><span class="nx">removeData</span><span class="p">(</span><span class="nx">a</span><span class="p">,[</span><span class="s2">&quot;events&quot;</span><span class="p">,</span><span class="s2">&quot;handle&quot;</span><span class="p">],</span><span class="o">!</span><span class="mi">0</span><span class="p">))}},</span><span class="nx">customEvent</span><span class="o">:</span><span class="p">{</span><span class="nx">getData</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">setData</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">changeData</span><span class="o">:!</span><span class="mi">0</span><span class="p">},</span><span class="nx">trigger</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">e</span><span class="o">||</span><span class="nx">e</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">!==</span><span class="mi">3</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">!==</span><span class="mi">8</span><span class="p">){</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">type</span><span class="o">||</span><span class="nx">c</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="p">[],</span><span class="nx">j</span><span class="p">,</span><span class="nx">k</span><span class="p">,</span><span class="nx">l</span><span class="p">,</span><span class="nx">m</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">o</span><span class="p">,</span><span class="nx">p</span><span class="p">,</span><span class="nx">q</span><span class="p">,</span><span class="nx">r</span><span class="p">,</span><span class="nx">s</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">E</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">h</span><span class="o">+</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">triggered</span><span class="p">))</span><span class="k">return</span><span class="p">;</span><span class="nx">h</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;!&quot;</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">h</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="nx">k</span><span class="o">=!</span><span class="mi">0</span><span class="p">),</span><span class="nx">h</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">),</span><span class="nx">h</span><span class="o">=</span><span class="nx">i</span><span class="p">.</span><span class="nx">shift</span><span class="p">(),</span><span class="nx">i</span><span class="p">.</span><span class="nx">sort</span><span class="p">());</span><span class="k">if</span><span class="p">((</span><span class="o">!</span><span class="nx">e</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">customEvent</span><span class="p">[</span><span class="nx">h</span><span class="p">])</span><span class="o">&amp;&amp;!</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">global</span><span class="p">[</span><span class="nx">h</span><span class="p">])</span><span class="k">return</span><span class="p">;</span><span class="nx">c</span><span class="o">=</span><span class="k">typeof</span> <span class="nx">c</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="o">?</span><span class="nx">c</span><span class="p">[</span><span class="nx">f</span><span class="p">.</span><span class="nx">expando</span><span class="p">]</span><span class="o">?</span><span class="nx">c</span><span class="o">:</span><span class="k">new</span> <span class="nx">f</span><span class="p">.</span><span class="nx">Event</span><span class="p">(</span><span class="nx">h</span><span class="p">,</span><span class="nx">c</span><span class="p">)</span><span class="o">:</span><span class="k">new</span> <span class="nx">f</span><span class="p">.</span><span class="nx">Event</span><span class="p">(</span><span class="nx">h</span><span class="p">),</span><span class="nx">c</span><span class="p">.</span><span class="nx">type</span><span class="o">=</span><span class="nx">h</span><span class="p">,</span><span class="nx">c</span><span class="p">.</span><span class="nx">isTrigger</span><span class="o">=!</span><span class="mi">0</span><span class="p">,</span><span class="nx">c</span><span class="p">.</span><span class="nx">exclusive</span><span class="o">=</span><span class="nx">k</span><span class="p">,</span><span class="nx">c</span><span class="p">.</span><span class="nx">namespace</span><span class="o">=</span><span class="nx">i</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">),</span><span class="nx">c</span><span class="p">.</span><span class="nx">namespace_re</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">namespace</span><span class="o">?</span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;(^|\\.)&quot;</span><span class="o">+</span><span class="nx">i</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;\\.(?:.*\\.)?&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;(\\.|$)&quot;</span><span class="p">)</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span><span class="nx">o</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">?</span><span class="s2">&quot;on&quot;</span><span class="o">+</span><span class="nx">h</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">e</span><span class="p">){</span><span class="nx">j</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">cache</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nx">l</span> <span class="k">in</span> <span class="nx">j</span><span class="p">)</span><span class="nx">j</span><span class="p">[</span><span class="nx">l</span><span class="p">].</span><span class="nx">events</span><span class="o">&amp;&amp;</span><span class="nx">j</span><span class="p">[</span><span class="nx">l</span><span class="p">].</span><span class="nx">events</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">j</span><span class="p">[</span><span class="nx">l</span><span class="p">].</span><span class="nx">handle</span><span class="p">.</span><span class="nx">elem</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">);</span><span class="k">return</span><span class="p">}</span><span class="nx">c</span><span class="p">.</span><span class="nx">result</span><span class="o">=</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">.</span><span class="nx">target</span><span class="o">||</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">target</span><span class="o">=</span><span class="nx">e</span><span class="p">),</span><span class="nx">d</span><span class="o">=</span><span class="nx">d</span><span class="o">!=</span><span class="kc">null</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">makeArray</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">:</span><span class="p">[],</span><span class="nx">d</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">c</span><span class="p">),</span><span class="nx">p</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span><span class="o">||</span><span class="p">{};</span><span class="k">if</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">trigger</span><span class="o">&amp;&amp;</span><span class="nx">p</span><span class="p">.</span><span class="nx">trigger</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="nx">d</span><span class="p">)</span><span class="o">===!</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span><span class="p">;</span><span class="nx">r</span><span class="o">=</span><span class="p">[[</span><span class="nx">e</span><span class="p">,</span><span class="nx">p</span><span class="p">.</span><span class="nx">bindType</span><span class="o">||</span><span class="nx">h</span><span class="p">]];</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">g</span><span class="o">&amp;&amp;!</span><span class="nx">p</span><span class="p">.</span><span class="nx">noBubble</span><span class="o">&amp;&amp;!</span><span class="nx">f</span><span class="p">.</span><span class="nx">isWindow</span><span class="p">(</span><span class="nx">e</span><span class="p">)){</span><span class="nx">s</span><span class="o">=</span><span class="nx">p</span><span class="p">.</span><span class="nx">delegateType</span><span class="o">||</span><span class="nx">h</span><span class="p">,</span><span class="nx">m</span><span class="o">=</span><span class="nx">E</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">s</span><span class="o">+</span><span class="nx">h</span><span class="p">)</span><span class="o">?</span><span class="nx">e</span><span class="o">:</span><span class="nx">e</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">,</span><span class="nx">n</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">for</span><span class="p">(;</span><span class="nx">m</span><span class="p">;</span><span class="nx">m</span><span class="o">=</span><span class="nx">m</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">)</span><span class="nx">r</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">m</span><span class="p">,</span><span class="nx">s</span><span class="p">]),</span><span class="nx">n</span><span class="o">=</span><span class="nx">m</span><span class="p">;</span><span class="nx">n</span><span class="o">&amp;&amp;</span><span class="nx">n</span><span class="o">===</span><span class="nx">e</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="o">&amp;&amp;</span><span class="nx">r</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">n</span><span class="p">.</span><span class="nx">defaultView</span><span class="o">||</span><span class="nx">n</span><span class="p">.</span><span class="nx">parentWindow</span><span class="o">||</span><span class="nx">a</span><span class="p">,</span><span class="nx">s</span><span class="p">])}</span><span class="k">for</span><span class="p">(</span><span class="nx">l</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">l</span><span class="o">&lt;</span><span class="nx">r</span><span class="p">.</span><span class="nx">length</span><span class="o">&amp;&amp;!</span><span class="nx">c</span><span class="p">.</span><span class="nx">isPropagationStopped</span><span class="p">();</span><span class="nx">l</span><span class="o">++</span><span class="p">)</span><span class="nx">m</span><span class="o">=</span><span class="nx">r</span><span class="p">[</span><span class="nx">l</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="nx">c</span><span class="p">.</span><span class="nx">type</span><span class="o">=</span><span class="nx">r</span><span class="p">[</span><span class="nx">l</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="nx">q</span><span class="o">=</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">m</span><span class="p">,</span><span class="s2">&quot;events&quot;</span><span class="p">)</span><span class="o">||</span><span class="p">{})[</span><span class="nx">c</span><span class="p">.</span><span class="nx">type</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">m</span><span class="p">,</span><span class="s2">&quot;handle&quot;</span><span class="p">),</span><span class="nx">q</span><span class="o">&amp;&amp;</span><span class="nx">q</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">m</span><span class="p">,</span><span class="nx">d</span><span class="p">),</span><span class="nx">q</span><span class="o">=</span><span class="nx">o</span><span class="o">&amp;&amp;</span><span class="nx">m</span><span class="p">[</span><span class="nx">o</span><span class="p">],</span><span class="nx">q</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">acceptData</span><span class="p">(</span><span class="nx">m</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">q</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">m</span><span class="p">,</span><span class="nx">d</span><span class="p">)</span><span class="o">===!</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span><span class="nx">c</span><span class="p">.</span><span class="nx">type</span><span class="o">=</span><span class="nx">h</span><span class="p">,</span><span class="o">!</span><span class="nx">g</span><span class="o">&amp;&amp;!</span><span class="nx">c</span><span class="p">.</span><span class="nx">isDefaultPrevented</span><span class="p">()</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="nx">p</span><span class="p">.</span><span class="nx">_default</span><span class="o">||</span><span class="nx">p</span><span class="p">.</span><span class="nx">_default</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="p">,</span><span class="nx">d</span><span class="p">)</span><span class="o">===!</span><span class="mi">1</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">h</span><span class="o">!==</span><span class="s2">&quot;click&quot;</span><span class="o">||!</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="s2">&quot;a&quot;</span><span class="p">))</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">acceptData</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">o</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">h</span><span class="o">!==</span><span class="s2">&quot;focus&quot;</span><span class="o">&amp;&amp;</span><span class="nx">h</span><span class="o">!==</span><span class="s2">&quot;blur&quot;</span><span class="o">||</span><span class="nx">c</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="o">!==</span><span class="mi">0</span><span class="p">)</span><span class="o">&amp;&amp;!</span><span class="nx">f</span><span class="p">.</span><span class="nx">isWindow</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">n</span><span class="o">=</span><span class="nx">e</span><span class="p">[</span><span class="nx">o</span><span class="p">],</span><span class="nx">n</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="p">[</span><span class="nx">o</span><span class="p">]</span><span class="o">=</span><span class="kc">null</span><span class="p">),</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">triggered</span><span class="o">=</span><span class="nx">h</span><span class="p">,</span><span class="nx">e</span><span class="p">[</span><span class="nx">h</span><span class="p">](),</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">triggered</span><span class="o">=</span><span class="nx">b</span><span class="p">,</span><span class="nx">n</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="p">[</span><span class="nx">o</span><span class="p">]</span><span class="o">=</span><span class="nx">n</span><span class="p">));</span><span class="k">return</span> <span class="nx">c</span><span class="p">.</span><span class="nx">result</span><span class="p">}},</span><span class="nx">dispatch</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span><span class="nx">c</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">fix</span><span class="p">(</span><span class="nx">c</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">event</span><span class="p">);</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;events&quot;</span><span class="p">)</span><span class="o">||</span><span class="p">{})[</span><span class="nx">c</span><span class="p">.</span><span class="nx">type</span><span class="p">]</span><span class="o">||</span><span class="p">[],</span><span class="nx">e</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">delegateCount</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="p">[].</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="nx">h</span><span class="o">=!</span><span class="nx">c</span><span class="p">.</span><span class="nx">exclusive</span><span class="o">&amp;&amp;!</span><span class="nx">c</span><span class="p">.</span><span class="nx">namespace</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="p">[],</span><span class="nx">j</span><span class="p">,</span><span class="nx">k</span><span class="p">,</span><span class="nx">l</span><span class="p">,</span><span class="nx">m</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">o</span><span class="p">,</span><span class="nx">p</span><span class="p">,</span><span class="nx">q</span><span class="p">,</span><span class="nx">r</span><span class="p">,</span><span class="nx">s</span><span class="p">,</span><span class="nx">t</span><span class="p">;</span><span class="nx">g</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nx">c</span><span class="p">,</span><span class="nx">c</span><span class="p">.</span><span class="nx">delegateTarget</span><span class="o">=</span><span class="k">this</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="o">&amp;&amp;!</span><span class="nx">c</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">disabled</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="nx">c</span><span class="p">.</span><span class="nx">button</span><span class="o">||</span><span class="nx">c</span><span class="p">.</span><span class="nx">type</span><span class="o">!==</span><span class="s2">&quot;click&quot;</span><span class="p">)){</span><span class="nx">m</span><span class="o">=</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">),</span><span class="nx">m</span><span class="p">.</span><span class="nx">context</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="o">||</span><span class="k">this</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nx">l</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">target</span><span class="p">;</span><span class="nx">l</span><span class="o">!=</span><span class="k">this</span><span class="p">;</span><span class="nx">l</span><span class="o">=</span><span class="nx">l</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">||</span><span class="k">this</span><span class="p">){</span><span class="nx">o</span><span class="o">=</span><span class="p">{},</span><span class="nx">q</span><span class="o">=</span><span class="p">[],</span><span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nx">l</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nx">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">j</span><span class="o">&lt;</span><span class="nx">e</span><span class="p">;</span><span class="nx">j</span><span class="o">++</span><span class="p">)</span><span class="nx">r</span><span class="o">=</span><span class="nx">d</span><span class="p">[</span><span class="nx">j</span><span class="p">],</span><span class="nx">s</span><span class="o">=</span><span class="nx">r</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span><span class="nx">o</span><span class="p">[</span><span class="nx">s</span><span class="p">]</span><span class="o">===</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">o</span><span class="p">[</span><span class="nx">s</span><span class="p">]</span><span class="o">=</span><span class="nx">r</span><span class="p">.</span><span class="nx">quick</span><span class="o">?</span><span class="nx">H</span><span class="p">(</span><span class="nx">l</span><span class="p">,</span><span class="nx">r</span><span class="p">.</span><span class="nx">quick</span><span class="p">)</span><span class="o">:</span><span class="nx">m</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="nx">s</span><span class="p">)),</span><span class="nx">o</span><span class="p">[</span><span class="nx">s</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">q</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">r</span><span class="p">);</span><span class="nx">q</span><span class="p">.</span><span class="nx">length</span><span class="o">&amp;&amp;</span><span class="nx">i</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="nx">elem</span><span class="o">:</span><span class="nx">l</span><span class="p">,</span><span class="nx">matches</span><span class="o">:</span><span class="nx">q</span><span class="p">})}}</span><span class="nx">d</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="nx">e</span><span class="o">&amp;&amp;</span><span class="nx">i</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="nx">elem</span><span class="o">:</span><span class="k">this</span><span class="p">,</span><span class="nx">matches</span><span class="o">:</span><span class="nx">d</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">e</span><span class="p">)});</span><span class="k">for</span><span class="p">(</span><span class="nx">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">j</span><span class="o">&lt;</span><span class="nx">i</span><span class="p">.</span><span class="nx">length</span><span class="o">&amp;&amp;!</span><span class="nx">c</span><span class="p">.</span><span class="nx">isPropagationStopped</span><span class="p">();</span><span class="nx">j</span><span class="o">++</span><span class="p">){</span><span class="nx">p</span><span class="o">=</span><span class="nx">i</span><span class="p">[</span><span class="nx">j</span><span class="p">],</span><span class="nx">c</span><span class="p">.</span><span class="nx">currentTarget</span><span class="o">=</span><span class="nx">p</span><span class="p">.</span><span class="nx">elem</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nx">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">k</span><span class="o">&lt;</span><span class="nx">p</span><span class="p">.</span><span class="nx">matches</span><span class="p">.</span><span class="nx">length</span><span class="o">&amp;&amp;!</span><span class="nx">c</span><span class="p">.</span><span class="nx">isImmediatePropagationStopped</span><span class="p">();</span><span class="nx">k</span><span class="o">++</span><span class="p">){</span><span class="nx">r</span><span class="o">=</span><span class="nx">p</span><span class="p">.</span><span class="nx">matches</span><span class="p">[</span><span class="nx">k</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">h</span><span class="o">||!</span><span class="nx">c</span><span class="p">.</span><span class="nx">namespace</span><span class="o">&amp;&amp;!</span><span class="nx">r</span><span class="p">.</span><span class="nx">namespace</span><span class="o">||</span><span class="nx">c</span><span class="p">.</span><span class="nx">namespace_re</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="p">.</span><span class="nx">namespace_re</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">namespace</span><span class="p">))</span><span class="nx">c</span><span class="p">.</span><span class="nx">data</span><span class="o">=</span><span class="nx">r</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span><span class="nx">c</span><span class="p">.</span><span class="nx">handleObj</span><span class="o">=</span><span class="nx">r</span><span class="p">,</span><span class="nx">n</span><span class="o">=</span><span class="p">((</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">[</span><span class="nx">r</span><span class="p">.</span><span class="nx">origType</span><span class="p">]</span><span class="o">||</span><span class="p">{}).</span><span class="nx">handle</span><span class="o">||</span><span class="nx">r</span><span class="p">.</span><span class="nx">handler</span><span class="p">).</span><span class="nx">apply</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">elem</span><span class="p">,</span><span class="nx">g</span><span class="p">),</span><span class="nx">n</span><span class="o">!==</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">result</span><span class="o">=</span><span class="nx">n</span><span class="p">,</span><span class="nx">n</span><span class="o">===!</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">(),</span><span class="nx">c</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">()))}}</span><span class="k">return</span> <span class="nx">c</span><span class="p">.</span><span class="nx">result</span><span class="p">},</span><span class="nx">props</span><span class="o">:</span><span class="s2">&quot;attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which&quot;</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="nx">fixHooks</span><span class="o">:</span><span class="p">{},</span><span class="nx">keyHooks</span><span class="o">:</span><span class="p">{</span><span class="nx">props</span><span class="o">:</span><span class="s2">&quot;char charCode key keyCode&quot;</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="nx">filter</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">a</span><span class="p">.</span><span class="nx">which</span><span class="o">==</span><span class="kc">null</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">which</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">charCode</span><span class="o">!=</span><span class="kc">null</span><span class="o">?</span><span class="nx">b</span><span class="p">.</span><span class="nx">charCode</span><span class="o">:</span><span class="nx">b</span><span class="p">.</span><span class="nx">keyCode</span><span class="p">);</span><span class="k">return</span> <span class="nx">a</span><span class="p">}},</span><span class="nx">mouseHooks</span><span class="o">:</span><span class="p">{</span><span class="nx">props</span><span class="o">:</span><span class="s2">&quot;button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement&quot;</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="nx">filter</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="p">,</span><span class="nx">f</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">button</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">fromElement</span><span class="p">;</span><span class="nx">a</span><span class="p">.</span><span class="nx">pageX</span><span class="o">==</span><span class="kc">null</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">clientX</span><span class="o">!=</span><span class="kc">null</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="o">||</span><span class="nx">c</span><span class="p">,</span><span class="nx">f</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span><span class="nx">a</span><span class="p">.</span><span class="nx">pageX</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">clientX</span><span class="o">+</span><span class="p">(</span><span class="nx">f</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="o">||</span><span class="nx">g</span><span class="o">&amp;&amp;</span><span class="nx">g</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="o">||</span><span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="nx">f</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">clientLeft</span><span class="o">||</span><span class="nx">g</span><span class="o">&amp;&amp;</span><span class="nx">g</span><span class="p">.</span><span class="nx">clientLeft</span><span class="o">||</span><span class="mi">0</span><span class="p">),</span><span class="nx">a</span><span class="p">.</span><span class="nx">pageY</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">clientY</span><span class="o">+</span><span class="p">(</span><span class="nx">f</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">scrollTop</span><span class="o">||</span><span class="nx">g</span><span class="o">&amp;&amp;</span><span class="nx">g</span><span class="p">.</span><span class="nx">scrollTop</span><span class="o">||</span><span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="nx">f</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">clientTop</span><span class="o">||</span><span class="nx">g</span><span class="o">&amp;&amp;</span><span class="nx">g</span><span class="p">.</span><span class="nx">clientTop</span><span class="o">||</span><span class="mi">0</span><span class="p">)),</span><span class="o">!</span><span class="nx">a</span><span class="p">.</span><span class="nx">relatedTarget</span><span class="o">&amp;&amp;</span><span class="nx">i</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">relatedTarget</span><span class="o">=</span><span class="nx">i</span><span class="o">===</span><span class="nx">a</span><span class="p">.</span><span class="nx">target</span><span class="o">?</span><span class="nx">d</span><span class="p">.</span><span class="nx">toElement</span><span class="o">:</span><span class="nx">i</span><span class="p">),</span><span class="o">!</span><span class="nx">a</span><span class="p">.</span><span class="nx">which</span><span class="o">&amp;&amp;</span><span class="nx">h</span><span class="o">!==</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">which</span><span class="o">=</span><span class="nx">h</span><span class="o">&amp;</span><span class="mi">1</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="nx">h</span><span class="o">&amp;</span><span class="mi">2</span><span class="o">?</span><span class="mi">3</span><span class="o">:</span><span class="nx">h</span><span class="o">&amp;</span><span class="mi">4</span><span class="o">?</span><span class="mi">2</span><span class="o">:</span><span class="mi">0</span><span class="p">);</span><span class="k">return</span> <span class="nx">a</span><span class="p">}},</span><span class="nx">fix</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">f</span><span class="p">.</span><span class="nx">expando</span><span class="p">])</span><span class="k">return</span> <span class="nx">a</span><span class="p">;</span><span class="kd">var</span> <span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">a</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">fixHooks</span><span class="p">[</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="p">]</span><span class="o">||</span><span class="p">{},</span><span class="nx">i</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">props</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">h</span><span class="p">.</span><span class="nx">props</span><span class="p">)</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span><span class="nx">a</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">Event</span><span class="p">(</span><span class="nx">g</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="nx">i</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">d</span><span class="p">;)</span><span class="nx">e</span><span class="o">=</span><span class="nx">i</span><span class="p">[</span><span class="o">--</span><span class="nx">d</span><span class="p">],</span><span class="nx">a</span><span class="p">[</span><span class="nx">e</span><span class="p">]</span><span class="o">=</span><span class="nx">g</span><span class="p">[</span><span class="nx">e</span><span class="p">];</span><span class="nx">a</span><span class="p">.</span><span class="nx">target</span><span class="o">||</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">target</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">srcElement</span><span class="o">||</span><span class="nx">c</span><span class="p">),</span><span class="nx">a</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">3</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">target</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">),</span><span class="nx">a</span><span class="p">.</span><span class="nx">metaKey</span><span class="o">===</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">metaKey</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">ctrlKey</span><span class="p">);</span><span class="k">return</span> <span class="nx">h</span><span class="p">.</span><span class="nx">filter</span><span class="o">?</span><span class="nx">h</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">g</span><span class="p">)</span><span class="o">:</span><span class="nx">a</span><span class="p">},</span><span class="nx">special</span><span class="o">:</span><span class="p">{</span><span class="nx">ready</span><span class="o">:</span><span class="p">{</span><span class="nx">setup</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">bindReady</span><span class="p">},</span><span class="nx">load</span><span class="o">:</span><span class="p">{</span><span class="nx">noBubble</span><span class="o">:!</span><span class="mi">0</span><span class="p">},</span><span class="nx">focus</span><span class="o">:</span><span class="p">{</span><span class="nx">delegateType</span><span class="o">:</span><span class="s2">&quot;focusin&quot;</span><span class="p">},</span><span class="nx">blur</span><span class="o">:</span><span class="p">{</span><span class="nx">delegateType</span><span class="o">:</span><span class="s2">&quot;focusout&quot;</span><span class="p">},</span><span class="nx">beforeunload</span><span class="o">:</span><span class="p">{</span><span class="nx">setup</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">isWindow</span><span class="p">(</span><span class="k">this</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">onbeforeunload</span><span class="o">=</span><span class="nx">c</span><span class="p">)},</span><span class="nx">teardown</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">onbeforeunload</span><span class="o">===</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">onbeforeunload</span><span class="o">=</span><span class="kc">null</span><span class="p">)}}},</span><span class="nx">simulate</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="k">new</span> <span class="nx">f</span><span class="p">.</span><span class="nx">Event</span><span class="p">,</span><span class="nx">c</span><span class="p">,{</span><span class="nx">type</span><span class="o">:</span><span class="nx">a</span><span class="p">,</span><span class="nx">isSimulated</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">originalEvent</span><span class="o">:</span><span class="p">{}});</span><span class="nx">d</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="nx">b</span><span class="p">)</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">e</span><span class="p">),</span><span class="nx">e</span><span class="p">.</span><span class="nx">isDefaultPrevented</span><span class="p">()</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()}},</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">handle</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">removeEvent</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="o">?</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="nx">a</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="o">!</span><span class="mi">1</span><span class="p">)}</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="nx">a</span><span class="p">.</span><span class="nx">detachEvent</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">detachEvent</span><span class="p">(</span><span class="s2">&quot;on&quot;</span><span class="o">+</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">)},</span><span class="nx">f</span><span class="p">.</span><span class="nx">Event</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="k">this</span> <span class="k">instanceof</span> <span class="nx">f</span><span class="p">.</span><span class="nx">Event</span><span class="p">))</span><span class="k">return</span> <span class="k">new</span> <span class="nx">f</span><span class="p">.</span><span class="nx">Event</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">);</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="o">?</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">originalEvent</span><span class="o">=</span><span class="nx">a</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">type</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">isDefaultPrevented</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">defaultPrevented</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">returnValue</span><span class="o">===!</span><span class="mi">1</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">getPreventDefault</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">getPreventDefault</span><span class="p">()</span><span class="o">?</span><span class="nx">K</span><span class="o">:</span><span class="nx">J</span><span class="p">)</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">type</span><span class="o">=</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">b</span><span class="p">),</span><span class="k">this</span><span class="p">.</span><span class="nx">timeStamp</span><span class="o">=</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">timeStamp</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span><span class="k">this</span><span class="p">[</span><span class="nx">f</span><span class="p">.</span><span class="nx">expando</span><span class="p">]</span><span class="o">=!</span><span class="mi">0</span><span class="p">},</span><span class="nx">f</span><span class="p">.</span><span class="nx">Event</span><span class="p">.</span><span class="nx">prototype</span><span class="o">=</span><span class="p">{</span><span class="nx">preventDefault</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">isDefaultPrevented</span><span class="o">=</span><span class="nx">K</span><span class="p">;</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">originalEvent</span><span class="p">;</span><span class="o">!</span><span class="nx">a</span><span class="o">||</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">preventDefault</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span><span class="o">:</span><span class="nx">a</span><span class="p">.</span><span class="nx">returnValue</span><span class="o">=!</span><span class="mi">1</span><span class="p">)},</span><span class="nx">stopPropagation</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">isPropagationStopped</span><span class="o">=</span><span class="nx">K</span><span class="p">;</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">originalEvent</span><span class="p">;</span><span class="o">!</span><span class="nx">a</span><span class="o">||</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">(),</span><span class="nx">a</span><span class="p">.</span><span class="nx">cancelBubble</span><span class="o">=!</span><span class="mi">0</span><span class="p">)},</span><span class="nx">stopImmediatePropagation</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">isImmediatePropagationStopped</span><span class="o">=</span><span class="nx">K</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">()},</span><span class="nx">isDefaultPrevented</span><span class="o">:</span><span class="nx">J</span><span class="p">,</span><span class="nx">isPropagationStopped</span><span class="o">:</span><span class="nx">J</span><span class="p">,</span><span class="nx">isImmediatePropagationStopped</span><span class="o">:</span><span class="nx">J</span><span class="p">},</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">({</span><span class="nx">mouseenter</span><span class="o">:</span><span class="s2">&quot;mouseover&quot;</span><span class="p">,</span><span class="nx">mouseleave</span><span class="o">:</span><span class="s2">&quot;mouseout&quot;</span><span class="p">},</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="nx">delegateType</span><span class="o">:</span><span class="nx">b</span><span class="p">,</span><span class="nx">bindType</span><span class="o">:</span><span class="nx">b</span><span class="p">,</span><span class="nx">handle</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="k">this</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">relatedTarget</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">handleObj</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span><span class="nx">h</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">d</span><span class="o">||</span><span class="nx">d</span><span class="o">!==</span><span class="nx">c</span><span class="o">&amp;&amp;!</span><span class="nx">f</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">))</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">origType</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">handler</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">arguments</span><span class="p">),</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="o">=</span><span class="nx">b</span><span class="p">;</span><span class="k">return</span> <span class="nx">h</span><span class="p">}}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">submitBubbles</span><span class="o">||</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">.</span><span class="nx">submit</span><span class="o">=</span><span class="p">{</span><span class="nx">setup</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;form&quot;</span><span class="p">))</span><span class="k">return</span><span class="o">!</span><span class="mi">1</span><span class="p">;</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;click._submit keypress._submit&quot;</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="s2">&quot;input&quot;</span><span class="p">)</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="s2">&quot;button&quot;</span><span class="p">)</span><span class="o">?</span><span class="nx">c</span><span class="p">.</span><span class="nx">form</span><span class="o">:</span><span class="nx">b</span><span class="p">;</span><span class="nx">d</span><span class="o">&amp;&amp;!</span><span class="nx">d</span><span class="p">.</span><span class="nx">_submit_attached</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="s2">&quot;submit._submit&quot;</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">&amp;&amp;!</span><span class="nx">a</span><span class="p">.</span><span class="nx">isTrigger</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">simulate</span><span class="p">(</span><span class="s2">&quot;submit&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">)}),</span><span class="nx">d</span><span class="p">.</span><span class="nx">_submit_attached</span><span class="o">=!</span><span class="mi">0</span><span class="p">)})},</span><span class="nx">teardown</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;form&quot;</span><span class="p">))</span><span class="k">return</span><span class="o">!</span><span class="mi">1</span><span class="p">;</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;._submit&quot;</span><span class="p">)}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">changeBubbles</span><span class="o">||</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">.</span><span class="nx">change</span><span class="o">=</span><span class="p">{</span><span class="nx">setup</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="nx">z</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">)){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">type</span><span class="o">===</span><span class="s2">&quot;checkbox&quot;</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">type</span><span class="o">===</span><span class="s2">&quot;radio&quot;</span><span class="p">)</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;propertychange._change&quot;</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">a</span><span class="p">.</span><span class="nx">originalEvent</span><span class="p">.</span><span class="nx">propertyName</span><span class="o">===</span><span class="s2">&quot;checked&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_just_changed</span><span class="o">=!</span><span class="mi">0</span><span class="p">)}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;click._change&quot;</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">_just_changed</span><span class="o">&amp;&amp;!</span><span class="nx">a</span><span class="p">.</span><span class="nx">isTrigger</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_just_changed</span><span class="o">=!</span><span class="mi">1</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">simulate</span><span class="p">(</span><span class="s2">&quot;change&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">))});</span><span class="k">return</span><span class="o">!</span><span class="mi">1</span><span class="p">}</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;beforeactivate._change&quot;</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">target</span><span class="p">;</span><span class="nx">z</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">)</span><span class="o">&amp;&amp;!</span><span class="nx">b</span><span class="p">.</span><span class="nx">_change_attached</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="s2">&quot;change._change&quot;</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">&amp;&amp;!</span><span class="nx">a</span><span class="p">.</span><span class="nx">isSimulated</span><span class="o">&amp;&amp;!</span><span class="nx">a</span><span class="p">.</span><span class="nx">isTrigger</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">simulate</span><span class="p">(</span><span class="s2">&quot;change&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">)}),</span><span class="nx">b</span><span class="p">.</span><span class="nx">_change_attached</span><span class="o">=!</span><span class="mi">0</span><span class="p">)})},</span><span class="nx">handle</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">target</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="o">!==</span><span class="nx">b</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">isSimulated</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">isTrigger</span><span class="o">||</span><span class="nx">b</span><span class="p">.</span><span class="nx">type</span><span class="o">!==</span><span class="s2">&quot;radio&quot;</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="p">.</span><span class="nx">type</span><span class="o">!==</span><span class="s2">&quot;checkbox&quot;</span><span class="p">)</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">handleObj</span><span class="p">.</span><span class="nx">handler</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">arguments</span><span class="p">)},</span><span class="nx">teardown</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;._change&quot;</span><span class="p">);</span><span class="k">return</span> <span class="nx">z</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">)}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">focusinBubbles</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">({</span><span class="nx">focus</span><span class="o">:</span><span class="s2">&quot;focusin&quot;</span><span class="p">,</span><span class="nx">blur</span><span class="o">:</span><span class="s2">&quot;focusout&quot;</span><span class="p">},</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">simulate</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">a</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">fix</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span><span class="o">!</span><span class="mi">0</span><span class="p">)};</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="nx">setup</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">d</span><span class="o">++===</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">)},</span><span class="nx">teardown</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="o">--</span><span class="nx">d</span><span class="o">===</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">)}}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">on</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="p">){</span><span class="kd">var</span> <span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="p">){</span><span class="k">typeof</span> <span class="nx">c</span><span class="o">!=</span><span class="s2">&quot;string&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="nx">c</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="nx">b</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">a</span><span class="p">)</span><span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span><span class="nx">g</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">}</span><span class="nx">d</span><span class="o">==</span><span class="kc">null</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="o">==</span><span class="kc">null</span><span class="o">?</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">c</span><span class="o">=</span><span class="nx">b</span><span class="p">)</span><span class="o">:</span><span class="nx">e</span><span class="o">==</span><span class="kc">null</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">c</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="o">?</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">d</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="p">)</span><span class="o">:</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">d</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">c</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="nx">b</span><span class="p">));</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="o">===!</span><span class="mi">1</span><span class="p">)</span><span class="nx">e</span><span class="o">=</span><span class="nx">J</span><span class="p">;</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">e</span><span class="p">)</span><span class="k">return</span> <span class="k">this</span><span class="p">;</span><span class="nx">g</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">h</span><span class="o">=</span><span class="nx">e</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">f</span><span class="p">().</span><span class="nx">off</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="k">return</span> <span class="nx">h</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">arguments</span><span class="p">)},</span><span class="nx">e</span><span class="p">.</span><span class="nx">guid</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">guid</span><span class="o">||</span><span class="p">(</span><span class="nx">h</span><span class="p">.</span><span class="nx">guid</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">guid</span><span class="o">++</span><span class="p">));</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">c</span><span class="p">)})},</span><span class="nx">one</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="mi">1</span><span class="p">)},</span><span class="nx">off</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">preventDefault</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">handleObj</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">handleObj</span><span class="p">;</span><span class="nx">f</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">delegateTarget</span><span class="p">).</span><span class="nx">off</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">namespace</span><span class="o">?</span><span class="nx">e</span><span class="p">.</span><span class="nx">type</span><span class="o">+</span><span class="s2">&quot;.&quot;</span><span class="o">+</span><span class="nx">e</span><span class="p">.</span><span class="nx">namespace</span><span class="o">:</span><span class="nx">e</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">handler</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">g</span> <span class="k">in</span> <span class="nx">a</span><span class="p">)</span><span class="k">this</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="nx">g</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">a</span><span class="p">[</span><span class="nx">g</span><span class="p">]);</span><span class="k">return</span> <span class="k">this</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="o">===!</span><span class="mi">1</span><span class="o">||</span><span class="k">typeof</span> <span class="nx">c</span><span class="o">==</span><span class="s2">&quot;function&quot;</span><span class="p">)</span><span class="nx">d</span><span class="o">=</span><span class="nx">c</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="nx">b</span><span class="p">;</span><span class="nx">d</span><span class="o">===!</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="nx">J</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">c</span><span class="p">)})},</span><span class="nx">bind</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">)},</span><span class="nx">unbind</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="nx">b</span><span class="p">)},</span><span class="nx">live</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">die</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">).</span><span class="nx">off</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">selector</span><span class="o">||</span><span class="s2">&quot;**&quot;</span><span class="p">,</span><span class="nx">b</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">delegate</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">)},</span><span class="nx">undelegate</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">return</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">1</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;**&quot;</span><span class="p">)</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">)},</span><span class="nx">trigger</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="k">this</span><span class="p">)})},</span><span class="nx">triggerHandler</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">!</span><span class="mi">0</span><span class="p">)},</span><span class="nx">toggle</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">arguments</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">guid</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">guid</span><span class="o">++</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;lastToggle&quot;</span><span class="o">+</span><span class="nx">a</span><span class="p">.</span><span class="nx">guid</span><span class="p">)</span><span class="o">||</span><span class="mi">0</span><span class="p">)</span><span class="o">%</span><span class="nx">d</span><span class="p">;</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;lastToggle&quot;</span><span class="o">+</span><span class="nx">a</span><span class="p">.</span><span class="nx">guid</span><span class="p">,</span><span class="nx">e</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="nx">c</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span><span class="k">return</span> <span class="nx">b</span><span class="p">[</span><span class="nx">e</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">arguments</span><span class="p">)</span><span class="o">||!</span><span class="mi">1</span><span class="p">};</span><span class="nx">e</span><span class="p">.</span><span class="nx">guid</span><span class="o">=</span><span class="nx">c</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="nx">d</span><span class="o">&lt;</span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="nx">b</span><span class="p">[</span><span class="nx">d</span><span class="o">++</span><span class="p">].</span><span class="nx">guid</span><span class="o">=</span><span class="nx">c</span><span class="p">;</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="nx">e</span><span class="p">)},</span><span class="nx">hover</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">mouseenter</span><span class="p">(</span><span class="nx">a</span><span class="p">).</span><span class="nx">mouseleave</span><span class="p">(</span><span class="nx">b</span><span class="o">||</span><span class="nx">a</span><span class="p">)}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="s2">&quot;blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu&quot;</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="nx">c</span><span class="o">==</span><span class="kc">null</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">,</span><span class="nx">a</span><span class="o">=</span><span class="kc">null</span><span class="p">);</span><span class="k">return</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">)</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="nx">b</span><span class="p">)},</span><span class="nx">f</span><span class="p">.</span><span class="nx">attrFn</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">attrFn</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">=!</span><span class="mi">0</span><span class="p">),</span><span class="nx">C</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">fixHooks</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">keyHooks</span><span class="p">),</span><span class="nx">D</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">fixHooks</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">mouseHooks</span><span class="p">)}),</span><span class="kd">function</span><span class="p">(){</span><span class="kd">function</span> <span class="nx">x</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">f</span><span class="p">,</span><span class="nx">g</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">h</span><span class="o">&lt;</span><span class="nx">i</span><span class="p">;</span><span class="nx">h</span><span class="o">++</span><span class="p">){</span><span class="kd">var</span> <span class="nx">j</span><span class="o">=</span><span class="nx">e</span><span class="p">[</span><span class="nx">h</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">j</span><span class="p">){</span><span class="kd">var</span> <span class="nx">k</span><span class="o">=!</span><span class="mi">1</span><span class="p">;</span><span class="nx">j</span><span class="o">=</span><span class="nx">j</span><span class="p">[</span><span class="nx">a</span><span class="p">];</span><span class="k">while</span><span class="p">(</span><span class="nx">j</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">j</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">===</span><span class="nx">c</span><span class="p">){</span><span class="nx">k</span><span class="o">=</span><span class="nx">e</span><span class="p">[</span><span class="nx">j</span><span class="p">.</span><span class="nx">sizset</span><span class="p">];</span><span class="k">break</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">j</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="p">){</span><span class="nx">g</span><span class="o">||</span><span class="p">(</span><span class="nx">j</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">=</span><span class="nx">c</span><span class="p">,</span><span class="nx">j</span><span class="p">.</span><span class="nx">sizset</span><span class="o">=</span><span class="nx">h</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">b</span><span class="o">!=</span><span class="s2">&quot;string&quot;</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">j</span><span class="o">===</span><span class="nx">b</span><span class="p">){</span><span class="nx">k</span><span class="o">=!</span><span class="mi">0</span><span class="p">;</span><span class="k">break</span><span class="p">}}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">b</span><span class="p">,[</span><span class="nx">j</span><span class="p">]).</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span><span class="nx">k</span><span class="o">=</span><span class="nx">j</span><span class="p">;</span><span class="k">break</span><span class="p">}}</span><span class="nx">j</span><span class="o">=</span><span class="nx">j</span><span class="p">[</span><span class="nx">a</span><span class="p">]}</span><span class="nx">e</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span><span class="o">=</span><span class="nx">k</span><span class="p">}}}</span><span class="kd">function</span> <span class="nx">w</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">f</span><span class="p">,</span><span class="nx">g</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">h</span><span class="o">&lt;</span><span class="nx">i</span><span class="p">;</span><span class="nx">h</span><span class="o">++</span><span class="p">){</span><span class="kd">var</span> <span class="nx">j</span><span class="o">=</span><span class="nx">e</span><span class="p">[</span><span class="nx">h</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">j</span><span class="p">){</span><span class="kd">var</span> <span class="nx">k</span><span class="o">=!</span><span class="mi">1</span><span class="p">;</span><span class="nx">j</span><span class="o">=</span><span class="nx">j</span><span class="p">[</span><span class="nx">a</span><span class="p">];</span><span class="k">while</span><span class="p">(</span><span class="nx">j</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">j</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">===</span><span class="nx">c</span><span class="p">){</span><span class="nx">k</span><span class="o">=</span><span class="nx">e</span><span class="p">[</span><span class="nx">j</span><span class="p">.</span><span class="nx">sizset</span><span class="p">];</span><span class="k">break</span><span class="p">}</span><span class="nx">j</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;!</span><span class="nx">g</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">j</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">=</span><span class="nx">c</span><span class="p">,</span><span class="nx">j</span><span class="p">.</span><span class="nx">sizset</span><span class="o">=</span><span class="nx">h</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">j</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="o">===</span><span class="nx">b</span><span class="p">){</span><span class="nx">k</span><span class="o">=</span><span class="nx">j</span><span class="p">;</span><span class="k">break</span><span class="p">}</span><span class="nx">j</span><span class="o">=</span><span class="nx">j</span><span class="p">[</span><span class="nx">a</span><span class="p">]}</span><span class="nx">e</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span><span class="o">=</span><span class="nx">k</span><span class="p">}}}</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="sr">/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|[&#39;&quot;][^&#39;&quot;]*[&#39;&quot;]|[^\[\]&#39;&quot;]+)+\]|\\.|[^ &gt;+~,(\[\\]+)+|[&gt;+~])(\s*,\s*)?((?:.|\r|\n)*)/g</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="s2">&quot;sizcache&quot;</span><span class="o">+</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span><span class="nx">e</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">,</span><span class="nx">h</span><span class="o">=!</span><span class="mi">1</span><span class="p">,</span><span class="nx">i</span><span class="o">=!</span><span class="mi">0</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="sr">/\\/g</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="sr">/\r\n/g</span><span class="p">,</span><span class="nx">l</span><span class="o">=</span><span class="sr">/\W/</span><span class="p">;[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">].</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">i</span><span class="o">=!</span><span class="mi">1</span><span class="p">;</span><span class="k">return</span> <span class="mi">0</span><span class="p">});</span><span class="kd">var</span> <span class="nx">m</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">f</span><span class="p">){</span><span class="nx">e</span><span class="o">=</span><span class="nx">e</span><span class="o">||</span><span class="p">[],</span><span class="nx">d</span><span class="o">=</span><span class="nx">d</span><span class="o">||</span><span class="nx">c</span><span class="p">;</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="nx">d</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">!==</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">!==</span><span class="mi">9</span><span class="p">)</span><span class="k">return</span><span class="p">[];</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">b</span><span class="o">||</span><span class="k">typeof</span> <span class="nx">b</span><span class="o">!=</span><span class="s2">&quot;string&quot;</span><span class="p">)</span><span class="k">return</span> <span class="nx">e</span><span class="p">;</span><span class="kd">var</span> <span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="nx">k</span><span class="p">,</span><span class="nx">l</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">q</span><span class="p">,</span><span class="nx">r</span><span class="p">,</span><span class="nx">t</span><span class="p">,</span><span class="nx">u</span><span class="o">=!</span><span class="mi">0</span><span class="p">,</span><span class="nx">v</span><span class="o">=</span><span class="nx">m</span><span class="p">.</span><span class="nx">isXML</span><span class="p">(</span><span class="nx">d</span><span class="p">),</span><span class="nx">w</span><span class="o">=</span><span class="p">[],</span><span class="nx">x</span><span class="o">=</span><span class="nx">b</span><span class="p">;</span><span class="k">do</span><span class="p">{</span><span class="nx">a</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span><span class="nx">i</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">i</span><span class="p">){</span><span class="nx">x</span><span class="o">=</span><span class="nx">i</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="nx">w</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="k">if</span><span class="p">(</span><span class="nx">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]){</span><span class="nx">l</span><span class="o">=</span><span class="nx">i</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span><span class="k">break</span><span class="p">}}}</span><span class="k">while</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">w</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">p</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">b</span><span class="p">))</span><span class="k">if</span><span class="p">(</span><span class="nx">w</span><span class="p">.</span><span class="nx">length</span><span class="o">===</span><span class="mi">2</span><span class="o">&amp;&amp;</span><span class="nx">o</span><span class="p">.</span><span class="nx">relative</span><span class="p">[</span><span class="nx">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span><span class="nx">j</span><span class="o">=</span><span class="nx">y</span><span class="p">(</span><span class="nx">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="nx">w</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nx">d</span><span class="p">,</span><span class="nx">f</span><span class="p">);</span><span class="k">else</span><span class="p">{</span><span class="nx">j</span><span class="o">=</span><span class="nx">o</span><span class="p">.</span><span class="nx">relative</span><span class="p">[</span><span class="nx">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">?</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">:</span><span class="nx">m</span><span class="p">(</span><span class="nx">w</span><span class="p">.</span><span class="nx">shift</span><span class="p">(),</span><span class="nx">d</span><span class="p">);</span><span class="k">while</span><span class="p">(</span><span class="nx">w</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="nx">b</span><span class="o">=</span><span class="nx">w</span><span class="p">.</span><span class="nx">shift</span><span class="p">(),</span><span class="nx">o</span><span class="p">.</span><span class="nx">relative</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">b</span><span class="o">+=</span><span class="nx">w</span><span class="p">.</span><span class="nx">shift</span><span class="p">()),</span><span class="nx">j</span><span class="o">=</span><span class="nx">y</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="nx">f</span><span class="p">)}</span><span class="k">else</span><span class="p">{</span><span class="o">!</span><span class="nx">f</span><span class="o">&amp;&amp;</span><span class="nx">w</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">9</span><span class="o">&amp;&amp;!</span><span class="nx">v</span><span class="o">&amp;&amp;</span><span class="nx">o</span><span class="p">.</span><span class="nx">match</span><span class="p">.</span><span class="nx">ID</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">w</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">&amp;&amp;!</span><span class="nx">o</span><span class="p">.</span><span class="nx">match</span><span class="p">.</span><span class="nx">ID</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">w</span><span class="p">[</span><span class="nx">w</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">n</span><span class="o">=</span><span class="nx">m</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">w</span><span class="p">.</span><span class="nx">shift</span><span class="p">(),</span><span class="nx">d</span><span class="p">,</span><span class="nx">v</span><span class="p">),</span><span class="nx">d</span><span class="o">=</span><span class="nx">n</span><span class="p">.</span><span class="nx">expr</span><span class="o">?</span><span class="nx">m</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">expr</span><span class="p">,</span><span class="nx">n</span><span class="p">.</span><span class="nx">set</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">:</span><span class="nx">n</span><span class="p">.</span><span class="nx">set</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="nx">n</span><span class="o">=</span><span class="nx">f</span><span class="o">?</span><span class="p">{</span><span class="nx">expr</span><span class="o">:</span><span class="nx">w</span><span class="p">.</span><span class="nx">pop</span><span class="p">(),</span><span class="nx">set</span><span class="o">:</span><span class="nx">s</span><span class="p">(</span><span class="nx">f</span><span class="p">)}</span><span class="o">:</span><span class="nx">m</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">w</span><span class="p">.</span><span class="nx">pop</span><span class="p">(),</span><span class="nx">w</span><span class="p">.</span><span class="nx">length</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">===</span><span class="s2">&quot;~&quot;</span><span class="o">||</span><span class="nx">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">===</span><span class="s2">&quot;+&quot;</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">?</span><span class="nx">d</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">:</span><span class="nx">d</span><span class="p">,</span><span class="nx">v</span><span class="p">),</span><span class="nx">j</span><span class="o">=</span><span class="nx">n</span><span class="p">.</span><span class="nx">expr</span><span class="o">?</span><span class="nx">m</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">expr</span><span class="p">,</span><span class="nx">n</span><span class="p">.</span><span class="nx">set</span><span class="p">)</span><span class="o">:</span><span class="nx">n</span><span class="p">.</span><span class="nx">set</span><span class="p">,</span><span class="nx">w</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">?</span><span class="nx">k</span><span class="o">=</span><span class="nx">s</span><span class="p">(</span><span class="nx">j</span><span class="p">)</span><span class="o">:</span><span class="nx">u</span><span class="o">=!</span><span class="mi">1</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="nx">w</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="nx">q</span><span class="o">=</span><span class="nx">w</span><span class="p">.</span><span class="nx">pop</span><span class="p">(),</span><span class="nx">r</span><span class="o">=</span><span class="nx">q</span><span class="p">,</span><span class="nx">o</span><span class="p">.</span><span class="nx">relative</span><span class="p">[</span><span class="nx">q</span><span class="p">]</span><span class="o">?</span><span class="nx">r</span><span class="o">=</span><span class="nx">w</span><span class="p">.</span><span class="nx">pop</span><span class="p">()</span><span class="o">:</span><span class="nx">q</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">r</span><span class="o">==</span><span class="kc">null</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">r</span><span class="o">=</span><span class="nx">d</span><span class="p">),</span><span class="nx">o</span><span class="p">.</span><span class="nx">relative</span><span class="p">[</span><span class="nx">q</span><span class="p">](</span><span class="nx">k</span><span class="p">,</span><span class="nx">r</span><span class="p">,</span><span class="nx">v</span><span class="p">)}</span><span class="k">else</span> <span class="nx">k</span><span class="o">=</span><span class="nx">w</span><span class="o">=</span><span class="p">[]}</span><span class="nx">k</span><span class="o">||</span><span class="p">(</span><span class="nx">k</span><span class="o">=</span><span class="nx">j</span><span class="p">),</span><span class="nx">k</span><span class="o">||</span><span class="nx">m</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">q</span><span class="o">||</span><span class="nx">b</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">g</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">k</span><span class="p">)</span><span class="o">===</span><span class="s2">&quot;[object Array]&quot;</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">u</span><span class="p">)</span><span class="nx">e</span><span class="p">.</span><span class="nx">push</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="nx">k</span><span class="p">);</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="nx">t</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">k</span><span class="p">[</span><span class="nx">t</span><span class="p">]</span><span class="o">!=</span><span class="kc">null</span><span class="p">;</span><span class="nx">t</span><span class="o">++</span><span class="p">)</span><span class="nx">k</span><span class="p">[</span><span class="nx">t</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">k</span><span class="p">[</span><span class="nx">t</span><span class="p">]</span><span class="o">===!</span><span class="mi">0</span><span class="o">||</span><span class="nx">k</span><span class="p">[</span><span class="nx">t</span><span class="p">].</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">m</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">k</span><span class="p">[</span><span class="nx">t</span><span class="p">]))</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">j</span><span class="p">[</span><span class="nx">t</span><span class="p">]);</span><span class="k">else</span> <span class="k">for</span><span class="p">(</span><span class="nx">t</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">k</span><span class="p">[</span><span class="nx">t</span><span class="p">]</span><span class="o">!=</span><span class="kc">null</span><span class="p">;</span><span class="nx">t</span><span class="o">++</span><span class="p">)</span><span class="nx">k</span><span class="p">[</span><span class="nx">t</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">k</span><span class="p">[</span><span class="nx">t</span><span class="p">].</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">j</span><span class="p">[</span><span class="nx">t</span><span class="p">]);</span><span class="k">else</span> <span class="nx">s</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span><span class="nx">e</span><span class="p">);</span><span class="nx">l</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">m</span><span class="p">(</span><span class="nx">l</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">f</span><span class="p">),</span><span class="nx">m</span><span class="p">.</span><span class="nx">uniqueSort</span><span class="p">(</span><span class="nx">e</span><span class="p">));</span><span class="k">return</span> <span class="nx">e</span><span class="p">};</span><span class="nx">m</span><span class="p">.</span><span class="nx">uniqueSort</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">u</span><span class="p">){</span><span class="nx">h</span><span class="o">=</span><span class="nx">i</span><span class="p">,</span><span class="nx">a</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="nx">u</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">h</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="nx">b</span><span class="o">&lt;</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">b</span><span class="o">++</span><span class="p">)</span><span class="nx">a</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">===</span><span class="nx">a</span><span class="p">[</span><span class="nx">b</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">b</span><span class="o">--</span><span class="p">,</span><span class="mi">1</span><span class="p">)}</span><span class="k">return</span> <span class="nx">a</span><span class="p">},</span><span class="nx">m</span><span class="p">.</span><span class="nx">matches</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="nx">m</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="nx">b</span><span class="p">)},</span><span class="nx">m</span><span class="p">.</span><span class="nx">matchesSelector</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="nx">m</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">null</span><span class="p">,[</span><span class="nx">a</span><span class="p">]).</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">},</span><span class="nx">m</span><span class="p">.</span><span class="nx">find</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">f</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">a</span><span class="p">)</span><span class="k">return</span><span class="p">[];</span><span class="k">for</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">f</span><span class="o">=</span><span class="nx">o</span><span class="p">.</span><span class="nx">order</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">e</span><span class="o">&lt;</span><span class="nx">f</span><span class="p">;</span><span class="nx">e</span><span class="o">++</span><span class="p">){</span><span class="nx">h</span><span class="o">=</span><span class="nx">o</span><span class="p">.</span><span class="nx">order</span><span class="p">[</span><span class="nx">e</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">g</span><span class="o">=</span><span class="nx">o</span><span class="p">.</span><span class="nx">leftMatch</span><span class="p">[</span><span class="nx">h</span><span class="p">].</span><span class="nx">exec</span><span class="p">(</span><span class="nx">a</span><span class="p">)){</span><span class="nx">i</span><span class="o">=</span><span class="nx">g</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nx">g</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">i</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">i</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">!==</span><span class="s2">&quot;\\&quot;</span><span class="p">){</span><span class="nx">g</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="nx">g</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">j</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span><span class="nx">d</span><span class="o">=</span><span class="nx">o</span><span class="p">.</span><span class="nx">find</span><span class="p">[</span><span class="nx">h</span><span class="p">](</span><span class="nx">g</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="o">!=</span><span class="kc">null</span><span class="p">){</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">match</span><span class="p">[</span><span class="nx">h</span><span class="p">],</span><span class="s2">&quot;&quot;</span><span class="p">);</span><span class="k">break</span><span class="p">}}}}</span><span class="nx">d</span><span class="o">||</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="k">typeof</span> <span class="nx">b</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="o">!=</span><span class="s2">&quot;undefined&quot;</span><span class="o">?</span><span class="nx">b</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span><span class="o">:</span><span class="p">[]);</span><span class="k">return</span><span class="p">{</span><span class="nx">set</span><span class="o">:</span><span class="nx">d</span><span class="p">,</span><span class="nx">expr</span><span class="o">:</span><span class="nx">a</span><span class="p">}},</span><span class="nx">m</span><span class="p">.</span><span class="nx">filter</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">){</span><span class="kd">var</span> <span class="nx">f</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="nx">k</span><span class="p">,</span><span class="nx">l</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">p</span><span class="p">,</span><span class="nx">q</span><span class="o">=</span><span class="nx">a</span><span class="p">,</span><span class="nx">r</span><span class="o">=</span><span class="p">[],</span><span class="nx">s</span><span class="o">=</span><span class="nx">c</span><span class="p">,</span><span class="nx">t</span><span class="o">=</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">m</span><span class="p">.</span><span class="nx">isXML</span><span class="p">(</span><span class="nx">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span><span class="k">while</span><span class="p">(</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="p">.</span><span class="nx">length</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="nx">h</span> <span class="k">in</span> <span class="nx">o</span><span class="p">.</span><span class="nx">filter</span><span class="p">)</span><span class="k">if</span><span class="p">((</span><span class="nx">f</span><span class="o">=</span><span class="nx">o</span><span class="p">.</span><span class="nx">leftMatch</span><span class="p">[</span><span class="nx">h</span><span class="p">].</span><span class="nx">exec</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span><span class="o">!=</span><span class="kc">null</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]){</span><span class="nx">k</span><span class="o">=</span><span class="nx">o</span><span class="p">.</span><span class="nx">filter</span><span class="p">[</span><span class="nx">h</span><span class="p">],</span><span class="nx">l</span><span class="o">=</span><span class="nx">f</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nx">g</span><span class="o">=!</span><span class="mi">1</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">l</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">l</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">===</span><span class="s2">&quot;\\&quot;</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span><span class="nx">s</span><span class="o">===</span><span class="nx">r</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">r</span><span class="o">=</span><span class="p">[]);</span><span class="k">if</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">preFilter</span><span class="p">[</span><span class="nx">h</span><span class="p">]){</span><span class="nx">f</span><span class="o">=</span><span class="nx">o</span><span class="p">.</span><span class="nx">preFilter</span><span class="p">[</span><span class="nx">h</span><span class="p">](</span><span class="nx">f</span><span class="p">,</span><span class="nx">s</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">r</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">t</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">f</span><span class="p">)</span><span class="nx">g</span><span class="o">=</span><span class="nx">i</span><span class="o">=!</span><span class="mi">0</span><span class="p">;</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="o">===!</span><span class="mi">0</span><span class="p">)</span><span class="k">continue</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="nx">n</span><span class="o">=</span><span class="mi">0</span><span class="p">;(</span><span class="nx">j</span><span class="o">=</span><span class="nx">s</span><span class="p">[</span><span class="nx">n</span><span class="p">])</span><span class="o">!=</span><span class="kc">null</span><span class="p">;</span><span class="nx">n</span><span class="o">++</span><span class="p">)</span><span class="nx">j</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="nx">k</span><span class="p">(</span><span class="nx">j</span><span class="p">,</span><span class="nx">f</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">s</span><span class="p">),</span><span class="nx">p</span><span class="o">=</span><span class="nx">e</span><span class="o">^</span><span class="nx">i</span><span class="p">,</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="nx">i</span><span class="o">!=</span><span class="kc">null</span><span class="o">?</span><span class="nx">p</span><span class="o">?</span><span class="nx">g</span><span class="o">=!</span><span class="mi">0</span><span class="o">:</span><span class="nx">s</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span><span class="o">=!</span><span class="mi">1</span><span class="o">:</span><span class="nx">p</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">j</span><span class="p">),</span><span class="nx">g</span><span class="o">=!</span><span class="mi">0</span><span class="p">));</span><span class="k">if</span><span class="p">(</span><span class="nx">i</span><span class="o">!==</span><span class="nx">b</span><span class="p">){</span><span class="nx">d</span><span class="o">||</span><span class="p">(</span><span class="nx">s</span><span class="o">=</span><span class="nx">r</span><span class="p">),</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">match</span><span class="p">[</span><span class="nx">h</span><span class="p">],</span><span class="s2">&quot;&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">g</span><span class="p">)</span><span class="k">return</span><span class="p">[];</span><span class="k">break</span><span class="p">}}</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">===</span><span class="nx">q</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">g</span><span class="o">==</span><span class="kc">null</span><span class="p">)</span><span class="nx">m</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="k">else</span> <span class="k">break</span><span class="p">;</span><span class="nx">q</span><span class="o">=</span><span class="nx">a</span><span class="p">}</span><span class="k">return</span> <span class="nx">s</span><span class="p">},</span><span class="nx">m</span><span class="p">.</span><span class="nx">error</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;Syntax error, unrecognized expression: &quot;</span><span class="o">+</span><span class="nx">a</span><span class="p">)};</span><span class="kd">var</span> <span class="nx">n</span><span class="o">=</span><span class="nx">m</span><span class="p">.</span><span class="nx">getText</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="o">===</span><span class="mi">1</span><span class="o">||</span><span class="nx">d</span><span class="o">===</span><span class="mi">9</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span><span class="p">.</span><span class="nx">textContent</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="p">)</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">textContent</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span><span class="p">.</span><span class="nx">innerText</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="p">)</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">innerText</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">;</span><span class="nx">a</span><span class="p">;</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">)</span><span class="nx">e</span><span class="o">+=</span><span class="nx">n</span><span class="p">(</span><span class="nx">a</span><span class="p">)}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="o">===</span><span class="mi">3</span><span class="o">||</span><span class="nx">d</span><span class="o">===</span><span class="mi">4</span><span class="p">)</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">nodeValue</span><span class="p">}</span><span class="k">else</span> <span class="k">for</span><span class="p">(</span><span class="nx">b</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">b</span><span class="p">];</span><span class="nx">b</span><span class="o">++</span><span class="p">)</span><span class="nx">c</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">!==</span><span class="mi">8</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="o">+=</span><span class="nx">n</span><span class="p">(</span><span class="nx">c</span><span class="p">));</span><span class="k">return</span> <span class="nx">e</span><span class="p">},</span><span class="nx">o</span><span class="o">=</span><span class="nx">m</span><span class="p">.</span><span class="nx">selectors</span><span class="o">=</span><span class="p">{</span><span class="nx">order</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">,</span><span class="s2">&quot;NAME&quot;</span><span class="p">,</span><span class="s2">&quot;TAG&quot;</span><span class="p">],</span><span class="nx">match</span><span class="o">:</span><span class="p">{</span><span class="nx">ID</span><span class="o">:</span><span class="sr">/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/</span><span class="p">,</span><span class="nx">CLASS</span><span class="o">:</span><span class="sr">/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/</span><span class="p">,</span><span class="nx">NAME</span><span class="o">:</span><span class="sr">/\[name=[&#39;&quot;]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)[&#39;&quot;]*\]/</span><span class="p">,</span><span class="nx">ATTR</span><span class="o">:</span><span class="sr">/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:([&#39;&quot;])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/</span><span class="p">,</span><span class="nx">TAG</span><span class="o">:</span><span class="sr">/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/</span><span class="p">,</span><span class="nx">CHILD</span><span class="o">:</span><span class="sr">/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/</span><span class="p">,</span><span class="nx">POS</span><span class="o">:</span><span class="sr">/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/</span><span class="p">,</span><span class="nx">PSEUDO</span><span class="o">:</span><span class="sr">/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\(([&#39;&quot;]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/</span><span class="p">},</span><span class="nx">leftMatch</span><span class="o">:</span><span class="p">{},</span><span class="nx">attrMap</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="o">:</span><span class="s2">&quot;className&quot;</span><span class="p">,</span><span class="s2">&quot;for&quot;</span><span class="o">:</span><span class="s2">&quot;htmlFor&quot;</span><span class="p">},</span><span class="nx">attrHandle</span><span class="o">:</span><span class="p">{</span><span class="nx">href</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;href&quot;</span><span class="p">)},</span><span class="nx">type</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)}},</span><span class="nx">relative</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;+&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="k">typeof</span> <span class="nx">b</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">c</span><span class="o">&amp;&amp;!</span><span class="nx">l</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">b</span><span class="p">),</span><span class="nx">e</span><span class="o">=</span><span class="nx">c</span><span class="o">&amp;&amp;!</span><span class="nx">d</span><span class="p">;</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">b</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">());</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">f</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">h</span><span class="p">;</span><span class="nx">f</span><span class="o">&lt;</span><span class="nx">g</span><span class="p">;</span><span class="nx">f</span><span class="o">++</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">h</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">f</span><span class="p">]){</span><span class="k">while</span><span class="p">((</span><span class="nx">h</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">previousSibling</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">h</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">!==</span><span class="mi">1</span><span class="p">);</span><span class="nx">a</span><span class="p">[</span><span class="nx">f</span><span class="p">]</span><span class="o">=</span><span class="nx">e</span><span class="o">||</span><span class="nx">h</span><span class="o">&amp;&amp;</span><span class="nx">h</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="o">===</span><span class="nx">b</span><span class="o">?</span><span class="nx">h</span><span class="o">||!</span><span class="mi">1</span><span class="o">:</span><span class="nx">h</span><span class="o">===</span><span class="nx">b</span><span class="p">}</span><span class="nx">e</span><span class="o">&amp;&amp;</span><span class="nx">m</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">)},</span><span class="s2">&quot;&gt;&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="k">typeof</span> <span class="nx">b</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">f</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="o">&amp;&amp;!</span><span class="nx">l</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">b</span><span class="p">)){</span><span class="nx">b</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="k">for</span><span class="p">(;</span><span class="nx">e</span><span class="o">&lt;</span><span class="nx">f</span><span class="p">;</span><span class="nx">e</span><span class="o">++</span><span class="p">){</span><span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">e</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">g</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span><span class="nx">a</span><span class="p">[</span><span class="nx">e</span><span class="p">]</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="o">===</span><span class="nx">b</span><span class="o">?</span><span class="nx">g</span><span class="o">:!</span><span class="mi">1</span><span class="p">}}}</span><span class="k">else</span><span class="p">{</span><span class="k">for</span><span class="p">(;</span><span class="nx">e</span><span class="o">&lt;</span><span class="nx">f</span><span class="p">;</span><span class="nx">e</span><span class="o">++</span><span class="p">)</span><span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">e</span><span class="p">],</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">e</span><span class="p">]</span><span class="o">=</span><span class="nx">d</span><span class="o">?</span><span class="nx">c</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">:</span><span class="nx">c</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">===</span><span class="nx">b</span><span class="p">);</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="nx">m</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">)}},</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="p">,</span><span class="nx">f</span><span class="o">=</span><span class="nx">e</span><span class="o">++</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">x</span><span class="p">;</span><span class="k">typeof</span> <span class="nx">b</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="o">&amp;&amp;!</span><span class="nx">l</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">b</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">(),</span><span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">w</span><span class="p">),</span><span class="nx">g</span><span class="p">(</span><span class="s2">&quot;parentNode&quot;</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">f</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">c</span><span class="p">)},</span><span class="s2">&quot;~&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="p">,</span><span class="nx">f</span><span class="o">=</span><span class="nx">e</span><span class="o">++</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">x</span><span class="p">;</span><span class="k">typeof</span> <span class="nx">b</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="o">&amp;&amp;!</span><span class="nx">l</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">b</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">(),</span><span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">w</span><span class="p">),</span><span class="nx">g</span><span class="p">(</span><span class="s2">&quot;previousSibling&quot;</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">f</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">c</span><span class="p">)}},</span><span class="nx">find</span><span class="o">:</span><span class="p">{</span><span class="nx">ID</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">b</span><span class="p">.</span><span class="nx">getElementById</span><span class="o">!=</span><span class="s2">&quot;undefined&quot;</span><span class="o">&amp;&amp;!</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="k">return</span> <span class="nx">d</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">?</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">:</span><span class="p">[]}},</span><span class="nx">NAME</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">b</span><span class="p">.</span><span class="nx">getElementsByName</span><span class="o">!=</span><span class="s2">&quot;undefined&quot;</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="p">[],</span><span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">getElementsByName</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">f</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">e</span><span class="o">&lt;</span><span class="nx">f</span><span class="p">;</span><span class="nx">e</span><span class="o">++</span><span class="p">)</span><span class="nx">d</span><span class="p">[</span><span class="nx">e</span><span class="p">].</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span><span class="o">===</span><span class="nx">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="nx">e</span><span class="p">]);</span><span class="k">return</span> <span class="nx">c</span><span class="p">.</span><span class="nx">length</span><span class="o">===</span><span class="mi">0</span><span class="o">?</span><span class="kc">null</span><span class="o">:</span><span class="nx">c</span><span class="p">}},</span><span class="nx">TAG</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">b</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="o">!=</span><span class="s2">&quot;undefined&quot;</span><span class="p">)</span><span class="k">return</span> <span class="nx">b</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])}},</span><span class="nx">preFilter</span><span class="o">:</span><span class="p">{</span><span class="nx">CLASS</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">f</span><span class="p">){</span><span class="nx">a</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">a</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="nx">j</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span><span class="k">return</span> <span class="nx">a</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">h</span><span class="p">;(</span><span class="nx">h</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="nx">g</span><span class="p">])</span><span class="o">!=</span><span class="kc">null</span><span class="p">;</span><span class="nx">g</span><span class="o">++</span><span class="p">)</span><span class="nx">h</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="o">^</span><span class="p">(</span><span class="nx">h</span><span class="p">.</span><span class="nx">className</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">h</span><span class="p">.</span><span class="nx">className</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[\t\n\r]/g</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">).</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span><span class="o">?</span><span class="nx">c</span><span class="o">||</span><span class="nx">d</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">h</span><span class="p">)</span><span class="o">:</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="nx">g</span><span class="p">]</span><span class="o">=!</span><span class="mi">1</span><span class="p">));</span><span class="k">return</span><span class="o">!</span><span class="mi">1</span><span class="p">},</span><span class="nx">ID</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="nx">j</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)},</span><span class="nx">TAG</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="nx">j</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">()},</span><span class="nx">CHILD</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">===</span><span class="s2">&quot;nth&quot;</span><span class="p">){</span><span class="nx">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">||</span><span class="nx">m</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nx">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^\+|\s*/g</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">);</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="sr">/(-?)(\d*)(?:n([+\-]?\d*))?/</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">===</span><span class="s2">&quot;even&quot;</span><span class="o">&amp;&amp;</span><span class="s2">&quot;2n&quot;</span><span class="o">||</span><span class="nx">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">===</span><span class="s2">&quot;odd&quot;</span><span class="o">&amp;&amp;</span><span class="s2">&quot;2n+1&quot;</span><span class="o">||!</span><span class="sr">/\D/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">&amp;&amp;</span><span class="s2">&quot;0n+&quot;</span><span class="o">+</span><span class="nx">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">||</span><span class="nx">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span><span class="nx">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">||</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">0</span><span class="p">,</span><span class="nx">a</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="mi">0</span><span class="p">}</span><span class="k">else</span> <span class="nx">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">m</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span><span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nx">e</span><span class="o">++</span><span class="p">;</span><span class="k">return</span> <span class="nx">a</span><span class="p">},</span><span class="nx">ATTR</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">f</span><span class="p">){</span><span class="kd">var</span> <span class="nx">g</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="nx">j</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">);</span><span class="o">!</span><span class="nx">f</span><span class="o">&amp;&amp;</span><span class="nx">o</span><span class="p">.</span><span class="nx">attrMap</span><span class="p">[</span><span class="nx">g</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="nx">o</span><span class="p">.</span><span class="nx">attrMap</span><span class="p">[</span><span class="nx">g</span><span class="p">]),</span><span class="nx">a</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">||</span><span class="nx">a</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">j</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span><span class="nx">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">===</span><span class="s2">&quot;~=&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">a</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="p">);</span><span class="k">return</span> <span class="nx">a</span><span class="p">},</span><span class="nx">PSEUDO</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">f</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">===</span><span class="s2">&quot;not&quot;</span><span class="p">)</span><span class="k">if</span><span class="p">((</span><span class="nx">a</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">||</span><span class="sr">/^\w/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span><span class="nx">b</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="nx">m</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="kc">null</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="nx">c</span><span class="p">);</span><span class="k">else</span><span class="p">{</span><span class="kd">var</span> <span class="nx">g</span><span class="o">=</span><span class="nx">m</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="o">^</span><span class="nx">f</span><span class="p">);</span><span class="nx">d</span><span class="o">||</span><span class="nx">e</span><span class="p">.</span><span class="nx">push</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="p">);</span><span class="k">return</span><span class="o">!</span><span class="mi">1</span><span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">match</span><span class="p">.</span><span class="nx">POS</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">||</span><span class="nx">o</span><span class="p">.</span><span class="nx">match</span><span class="p">.</span><span class="nx">CHILD</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="k">return</span><span class="o">!</span><span class="mi">0</span><span class="p">;</span><span class="k">return</span> <span class="nx">b</span><span class="p">},</span><span class="nx">POS</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">a</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="o">!</span><span class="mi">0</span><span class="p">);</span><span class="k">return</span> <span class="nx">a</span><span class="p">}},</span><span class="nx">filters</span><span class="o">:</span><span class="p">{</span><span class="nx">enabled</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">disabled</span><span class="o">===!</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="o">!==</span><span class="s2">&quot;hidden&quot;</span><span class="p">},</span><span class="nx">disabled</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">disabled</span><span class="o">===!</span><span class="mi">0</span><span class="p">},</span><span class="nx">checked</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">checked</span><span class="o">===!</span><span class="mi">0</span><span class="p">},</span><span class="nx">selected</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">a</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">selectedIndex</span><span class="p">;</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">selected</span><span class="o">===!</span><span class="mi">0</span><span class="p">},</span><span class="nx">parent</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span><span class="o">!!</span><span class="nx">a</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">},</span><span class="nx">empty</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span><span class="o">!</span><span class="nx">a</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">},</span><span class="nx">has</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">return</span><span class="o">!!</span><span class="nx">m</span><span class="p">(</span><span class="nx">c</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="nx">a</span><span class="p">).</span><span class="nx">length</span><span class="p">},</span><span class="nx">header</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span><span class="sr">/h\d/i</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">)},</span><span class="nx">text</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">),</span><span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="p">;</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="o">===</span><span class="s2">&quot;input&quot;</span><span class="o">&amp;&amp;</span><span class="s2">&quot;text&quot;</span><span class="o">===</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">b</span><span class="o">===</span><span class="nx">c</span><span class="o">||</span><span class="nx">b</span><span class="o">===</span><span class="kc">null</span><span class="p">)},</span><span class="nx">radio</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="o">===</span><span class="s2">&quot;input&quot;</span><span class="o">&amp;&amp;</span><span class="s2">&quot;radio&quot;</span><span class="o">===</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="p">},</span><span class="nx">checkbox</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="o">===</span><span class="s2">&quot;input&quot;</span><span class="o">&amp;&amp;</span><span class="s2">&quot;checkbox&quot;</span><span class="o">===</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="p">},</span><span class="nx">file</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="o">===</span><span class="s2">&quot;input&quot;</span><span class="o">&amp;&amp;</span><span class="s2">&quot;file&quot;</span><span class="o">===</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="p">},</span><span class="nx">password</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="o">===</span><span class="s2">&quot;input&quot;</span><span class="o">&amp;&amp;</span><span class="s2">&quot;password&quot;</span><span class="o">===</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="p">},</span><span class="nx">submit</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="k">return</span><span class="p">(</span><span class="nx">b</span><span class="o">===</span><span class="s2">&quot;input&quot;</span><span class="o">||</span><span class="nx">b</span><span class="o">===</span><span class="s2">&quot;button&quot;</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="s2">&quot;submit&quot;</span><span class="o">===</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="p">},</span><span class="nx">image</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="o">===</span><span class="s2">&quot;input&quot;</span><span class="o">&amp;&amp;</span><span class="s2">&quot;image&quot;</span><span class="o">===</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="p">},</span><span class="nx">reset</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="k">return</span><span class="p">(</span><span class="nx">b</span><span class="o">===</span><span class="s2">&quot;input&quot;</span><span class="o">||</span><span class="nx">b</span><span class="o">===</span><span class="s2">&quot;button&quot;</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="s2">&quot;reset&quot;</span><span class="o">===</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="p">},</span><span class="nx">button</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="k">return</span> <span class="nx">b</span><span class="o">===</span><span class="s2">&quot;input&quot;</span><span class="o">&amp;&amp;</span><span class="s2">&quot;button&quot;</span><span class="o">===</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="o">||</span><span class="nx">b</span><span class="o">===</span><span class="s2">&quot;button&quot;</span><span class="p">},</span><span class="nx">input</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span><span class="sr">/input|select|textarea|button/i</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">)},</span><span class="nx">focus</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="o">===</span><span class="nx">a</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="p">.</span><span class="nx">activeElement</span><span class="p">}},</span><span class="nx">setFilters</span><span class="o">:</span><span class="p">{</span><span class="nx">first</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="nx">b</span><span class="o">===</span><span class="mi">0</span><span class="p">},</span><span class="nx">last</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">b</span><span class="o">===</span><span class="nx">d</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">},</span><span class="nx">even</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="nx">b</span><span class="o">%</span><span class="mi">2</span><span class="o">===</span><span class="mi">0</span><span class="p">},</span><span class="nx">odd</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="nx">b</span><span class="o">%</span><span class="mi">2</span><span class="o">===</span><span class="mi">1</span><span class="p">},</span><span class="nx">lt</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">return</span> <span class="nx">b</span><span class="o">&lt;</span><span class="nx">c</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="mi">0</span><span class="p">},</span><span class="nx">gt</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">return</span> <span class="nx">b</span><span class="o">&gt;</span><span class="nx">c</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="mi">0</span><span class="p">},</span><span class="nx">nth</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">return</span> <span class="nx">c</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="mi">0</span><span class="o">===</span><span class="nx">b</span><span class="p">},</span><span class="nx">eq</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">return</span> <span class="nx">c</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="mi">0</span><span class="o">===</span><span class="nx">b</span><span class="p">}},</span><span class="nx">filter</span><span class="o">:</span><span class="p">{</span><span class="nx">PSEUDO</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nx">f</span><span class="o">=</span><span class="nx">o</span><span class="p">.</span><span class="nx">filters</span><span class="p">[</span><span class="nx">e</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span><span class="k">return</span> <span class="nx">f</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="o">===</span><span class="s2">&quot;contains&quot;</span><span class="p">)</span><span class="k">return</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">textContent</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">innerText</span><span class="o">||</span><span class="nx">n</span><span class="p">([</span><span class="nx">a</span><span class="p">])</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="o">===</span><span class="s2">&quot;not&quot;</span><span class="p">){</span><span class="kd">var</span> <span class="nx">g</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">h</span><span class="o">&lt;</span><span class="nx">i</span><span class="p">;</span><span class="nx">h</span><span class="o">++</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">g</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span><span class="o">===</span><span class="nx">a</span><span class="p">)</span><span class="k">return</span><span class="o">!</span><span class="mi">1</span><span class="p">;</span><span class="k">return</span><span class="o">!</span><span class="mi">0</span><span class="p">}</span><span class="nx">m</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">e</span><span class="p">)},</span><span class="nx">CHILD</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">f</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nx">l</span><span class="o">=</span><span class="nx">a</span><span class="p">;</span><span class="k">switch</span><span class="p">(</span><span class="nx">k</span><span class="p">){</span><span class="k">case</span><span class="s2">&quot;only&quot;</span><span class="o">:</span><span class="k">case</span><span class="s2">&quot;first&quot;</span><span class="o">:</span><span class="k">while</span><span class="p">(</span><span class="nx">l</span><span class="o">=</span><span class="nx">l</span><span class="p">.</span><span class="nx">previousSibling</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">l</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span><span class="o">!</span><span class="mi">1</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">k</span><span class="o">===</span><span class="s2">&quot;first&quot;</span><span class="p">)</span><span class="k">return</span><span class="o">!</span><span class="mi">0</span><span class="p">;</span><span class="nx">l</span><span class="o">=</span><span class="nx">a</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;last&quot;</span><span class="o">:</span><span class="k">while</span><span class="p">(</span><span class="nx">l</span><span class="o">=</span><span class="nx">l</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">l</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span><span class="o">!</span><span class="mi">1</span><span class="p">;</span><span class="k">return</span><span class="o">!</span><span class="mi">0</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;nth&quot;</span><span class="o">:</span><span class="nx">c</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="nx">e</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="o">===</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span><span class="o">!</span><span class="mi">0</span><span class="p">;</span><span class="nx">f</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">g</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">g</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">g</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">!==</span><span class="nx">f</span><span class="o">||!</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeIndex</span><span class="p">)){</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nx">l</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">;</span><span class="nx">l</span><span class="p">;</span><span class="nx">l</span><span class="o">=</span><span class="nx">l</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">)</span><span class="nx">l</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">l</span><span class="p">.</span><span class="nx">nodeIndex</span><span class="o">=++</span><span class="nx">i</span><span class="p">);</span><span class="nx">g</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">=</span><span class="nx">f</span><span class="p">}</span><span class="nx">j</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeIndex</span><span class="o">-</span><span class="nx">e</span><span class="p">;</span><span class="k">return</span> <span class="nx">c</span><span class="o">===</span><span class="mi">0</span><span class="o">?</span><span class="nx">j</span><span class="o">===</span><span class="mi">0</span><span class="o">:</span><span class="nx">j</span><span class="o">%</span><span class="nx">c</span><span class="o">===</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="nx">j</span><span class="o">/</span><span class="nx">c</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">}},</span><span class="nx">ID</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span><span class="o">===</span><span class="nx">b</span><span class="p">},</span><span class="nx">TAG</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="nx">b</span><span class="o">===</span><span class="s2">&quot;*&quot;</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">||!!</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="o">===</span><span class="nx">b</span><span class="p">},</span><span class="nx">CLASS</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">className</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">))</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="p">).</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">},</span><span class="nx">ATTR</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nx">d</span><span class="o">=</span><span class="nx">m</span><span class="p">.</span><span class="nx">attr</span><span class="o">?</span><span class="nx">m</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">)</span><span class="o">:</span><span class="nx">o</span><span class="p">.</span><span class="nx">attrHandle</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">?</span><span class="nx">o</span><span class="p">.</span><span class="nx">attrHandle</span><span class="p">[</span><span class="nx">c</span><span class="p">](</span><span class="nx">a</span><span class="p">)</span><span class="o">:</span><span class="nx">a</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">!=</span><span class="kc">null</span><span class="o">?</span><span class="nx">a</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">:</span><span class="nx">a</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="nx">c</span><span class="p">),</span><span class="nx">e</span><span class="o">=</span><span class="nx">d</span><span class="o">+</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">f</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="nx">g</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span><span class="k">return</span> <span class="nx">d</span><span class="o">==</span><span class="kc">null</span><span class="o">?</span><span class="nx">f</span><span class="o">===</span><span class="s2">&quot;!=&quot;</span><span class="o">:!</span><span class="nx">f</span><span class="o">&amp;&amp;</span><span class="nx">m</span><span class="p">.</span><span class="nx">attr</span><span class="o">?</span><span class="nx">d</span><span class="o">!=</span><span class="kc">null</span><span class="o">:</span><span class="nx">f</span><span class="o">===</span><span class="s2">&quot;=&quot;</span><span class="o">?</span><span class="nx">e</span><span class="o">===</span><span class="nx">g</span><span class="o">:</span><span class="nx">f</span><span class="o">===</span><span class="s2">&quot;*=&quot;</span><span class="o">?</span><span class="nx">e</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">g</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span><span class="o">:</span><span class="nx">f</span><span class="o">===</span><span class="s2">&quot;~=&quot;</span><span class="o">?</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">e</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="p">).</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">g</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span><span class="o">:</span><span class="nx">g</span><span class="o">?</span><span class="nx">f</span><span class="o">===</span><span class="s2">&quot;!=&quot;</span><span class="o">?</span><span class="nx">e</span><span class="o">!==</span><span class="nx">g</span><span class="o">:</span><span class="nx">f</span><span class="o">===</span><span class="s2">&quot;^=&quot;</span><span class="o">?</span><span class="nx">e</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">g</span><span class="p">)</span><span class="o">===</span><span class="mi">0</span><span class="o">:</span><span class="nx">f</span><span class="o">===</span><span class="s2">&quot;$=&quot;</span><span class="o">?</span><span class="nx">e</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="nx">g</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="o">===</span><span class="nx">g</span><span class="o">:</span><span class="nx">f</span><span class="o">===</span><span class="s2">&quot;|=&quot;</span><span class="o">?</span><span class="nx">e</span><span class="o">===</span><span class="nx">g</span><span class="o">||</span><span class="nx">e</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">g</span><span class="p">.</span><span class="nx">length</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">===</span><span class="nx">g</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">:!</span><span class="mi">1</span><span class="o">:</span><span class="nx">e</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="o">!==!</span><span class="mi">1</span><span class="p">},</span><span class="nx">POS</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="nx">f</span><span class="o">=</span><span class="nx">o</span><span class="p">.</span><span class="nx">setFilters</span><span class="p">[</span><span class="nx">e</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span><span class="k">return</span> <span class="nx">f</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">)}}},</span><span class="nx">p</span><span class="o">=</span><span class="nx">o</span><span class="p">.</span><span class="nx">match</span><span class="p">.</span><span class="nx">POS</span><span class="p">,</span><span class="nx">q</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span><span class="s2">&quot;\\&quot;</span><span class="o">+</span><span class="p">(</span><span class="nx">b</span><span class="o">-</span><span class="mi">0</span><span class="o">+</span><span class="mi">1</span><span class="p">)};</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">r</span> <span class="k">in</span> <span class="nx">o</span><span class="p">.</span><span class="nx">match</span><span class="p">)</span><span class="nx">o</span><span class="p">.</span><span class="nx">match</span><span class="p">[</span><span class="nx">r</span><span class="p">]</span><span class="o">=</span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">match</span><span class="p">[</span><span class="nx">r</span><span class="p">].</span><span class="nx">source</span><span class="o">+</span><span class="sr">/(?![^\[]*\])(?![^\(]*\))/</span><span class="p">.</span><span class="nx">source</span><span class="p">),</span><span class="nx">o</span><span class="p">.</span><span class="nx">leftMatch</span><span class="p">[</span><span class="nx">r</span><span class="p">]</span><span class="o">=</span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="sr">/(^(?:.|\r|\n)*?)/</span><span class="p">.</span><span class="nx">source</span><span class="o">+</span><span class="nx">o</span><span class="p">.</span><span class="nx">match</span><span class="p">[</span><span class="nx">r</span><span class="p">].</span><span class="nx">source</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\\(\d+)/g</span><span class="p">,</span><span class="nx">q</span><span class="p">));</span><span class="kd">var</span> <span class="nx">s</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">a</span><span class="o">=</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="nx">b</span><span class="p">.</span><span class="nx">push</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">a</span><span class="p">);</span><span class="k">return</span> <span class="nx">b</span><span class="p">}</span><span class="k">return</span> <span class="nx">a</span><span class="p">};</span><span class="k">try</span><span class="p">{</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">,</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">nodeType</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">t</span><span class="p">){</span><span class="nx">s</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="o">||</span><span class="p">[];</span><span class="k">if</span><span class="p">(</span><span class="nx">g</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">===</span><span class="s2">&quot;[object Array]&quot;</span><span class="p">)</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">push</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">);</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="s2">&quot;number&quot;</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">c</span><span class="o">&lt;</span><span class="nx">e</span><span class="p">;</span><span class="nx">c</span><span class="o">++</span><span class="p">)</span><span class="nx">d</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">c</span><span class="p">]);</span><span class="k">else</span> <span class="k">for</span><span class="p">(;</span><span class="nx">a</span><span class="p">[</span><span class="nx">c</span><span class="p">];</span><span class="nx">c</span><span class="o">++</span><span class="p">)</span><span class="nx">d</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">c</span><span class="p">]);</span><span class="k">return</span> <span class="nx">d</span><span class="p">}}</span><span class="kd">var</span> <span class="nx">u</span><span class="p">,</span><span class="nx">v</span><span class="p">;</span><span class="nx">c</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">compareDocumentPosition</span><span class="o">?</span><span class="nx">u</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">===</span><span class="nx">b</span><span class="p">){</span><span class="nx">h</span><span class="o">=!</span><span class="mi">0</span><span class="p">;</span><span class="k">return</span> <span class="mi">0</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">a</span><span class="p">.</span><span class="nx">compareDocumentPosition</span><span class="o">||!</span><span class="nx">b</span><span class="p">.</span><span class="nx">compareDocumentPosition</span><span class="p">)</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">compareDocumentPosition</span><span class="o">?-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">compareDocumentPosition</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">4</span><span class="o">?-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">}</span><span class="o">:</span><span class="p">(</span><span class="nx">u</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">===</span><span class="nx">b</span><span class="p">){</span><span class="nx">h</span><span class="o">=!</span><span class="mi">0</span><span class="p">;</span><span class="k">return</span> <span class="mi">0</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">sourceIndex</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="p">.</span><span class="nx">sourceIndex</span><span class="p">)</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">sourceIndex</span><span class="o">-</span><span class="nx">b</span><span class="p">.</span><span class="nx">sourceIndex</span><span class="p">;</span><span class="kd">var</span> <span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="p">[],</span><span class="nx">f</span><span class="o">=</span><span class="p">[],</span><span class="nx">g</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="nx">g</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">g</span><span class="o">===</span><span class="nx">i</span><span class="p">)</span><span class="k">return</span> <span class="nx">v</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">g</span><span class="p">)</span><span class="k">return</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">i</span><span class="p">)</span><span class="k">return</span> <span class="mi">1</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="nx">j</span><span class="p">)</span><span class="nx">e</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">j</span><span class="p">),</span><span class="nx">j</span><span class="o">=</span><span class="nx">j</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span><span class="nx">j</span><span class="o">=</span><span class="nx">i</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="nx">j</span><span class="p">)</span><span class="nx">f</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">j</span><span class="p">),</span><span class="nx">j</span><span class="o">=</span><span class="nx">j</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span><span class="nx">c</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">k</span><span class="o">&lt;</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="nx">k</span><span class="o">&lt;</span><span class="nx">d</span><span class="p">;</span><span class="nx">k</span><span class="o">++</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span><span class="o">!==</span><span class="nx">f</span><span class="p">[</span><span class="nx">k</span><span class="p">])</span><span class="k">return</span> <span class="nx">v</span><span class="p">(</span><span class="nx">e</span><span class="p">[</span><span class="nx">k</span><span class="p">],</span><span class="nx">f</span><span class="p">[</span><span class="nx">k</span><span class="p">]);</span><span class="k">return</span> <span class="nx">k</span><span class="o">===</span><span class="nx">c</span><span class="o">?</span><span class="nx">v</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">f</span><span class="p">[</span><span class="nx">k</span><span class="p">],</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">:</span><span class="nx">v</span><span class="p">(</span><span class="nx">e</span><span class="p">[</span><span class="nx">k</span><span class="p">],</span><span class="nx">b</span><span class="p">,</span><span class="mi">1</span><span class="p">)},</span><span class="nx">v</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">===</span><span class="nx">b</span><span class="p">)</span><span class="k">return</span> <span class="nx">c</span><span class="p">;</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="o">===</span><span class="nx">b</span><span class="p">)</span><span class="k">return</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="nx">d</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">}</span><span class="k">return</span> <span class="mi">1</span><span class="p">}),</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">),</span><span class="nx">d</span><span class="o">=</span><span class="s2">&quot;script&quot;</span><span class="o">+</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">).</span><span class="nx">getTime</span><span class="p">(),</span><span class="nx">e</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">;</span><span class="nx">a</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="s2">&quot;&lt;a name=&#39;&quot;</span><span class="o">+</span><span class="nx">d</span><span class="o">+</span><span class="s2">&quot;&#39;/&gt;&quot;</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">),</span><span class="nx">c</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">find</span><span class="p">.</span><span class="nx">ID</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">c</span><span class="p">.</span><span class="nx">getElementById</span><span class="o">!=</span><span class="s2">&quot;undefined&quot;</span><span class="o">&amp;&amp;!</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="k">return</span> <span class="nx">e</span><span class="o">?</span><span class="nx">e</span><span class="p">.</span><span class="nx">id</span><span class="o">===</span><span class="nx">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">||</span><span class="k">typeof</span> <span class="nx">e</span><span class="p">.</span><span class="nx">getAttributeNode</span><span class="o">!=</span><span class="s2">&quot;undefined&quot;</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="p">.</span><span class="nx">getAttributeNode</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">).</span><span class="nx">nodeValue</span><span class="o">===</span><span class="nx">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">?</span><span class="p">[</span><span class="nx">e</span><span class="p">]</span><span class="o">:</span><span class="nx">b</span><span class="o">:</span><span class="p">[]}},</span><span class="nx">o</span><span class="p">.</span><span class="nx">filter</span><span class="p">.</span><span class="nx">ID</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="k">typeof</span> <span class="nx">a</span><span class="p">.</span><span class="nx">getAttributeNode</span><span class="o">!=</span><span class="s2">&quot;undefined&quot;</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">getAttributeNode</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">);</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="p">.</span><span class="nx">nodeValue</span><span class="o">===</span><span class="nx">b</span><span class="p">}),</span><span class="nx">e</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span><span class="nx">e</span><span class="o">=</span><span class="nx">a</span><span class="o">=</span><span class="kc">null</span><span class="p">}(),</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span><span class="nx">a</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">createComment</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)),</span><span class="nx">a</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">).</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">find</span><span class="p">.</span><span class="nx">TAG</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">===</span><span class="s2">&quot;*&quot;</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="p">[];</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">c</span><span class="p">[</span><span class="nx">e</span><span class="p">];</span><span class="nx">e</span><span class="o">++</span><span class="p">)</span><span class="nx">c</span><span class="p">[</span><span class="nx">e</span><span class="p">].</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">c</span><span class="p">[</span><span class="nx">e</span><span class="p">]);</span><span class="nx">c</span><span class="o">=</span><span class="nx">d</span><span class="p">}</span><span class="k">return</span> <span class="nx">c</span><span class="p">}),</span><span class="nx">a</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="s2">&quot;&lt;a href=&#39;#&#39;&gt;&lt;/a&gt;&quot;</span><span class="p">,</span><span class="nx">a</span><span class="p">.</span><span class="nx">firstChild</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">a</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">.</span><span class="nx">getAttribute</span><span class="o">!=</span><span class="s2">&quot;undefined&quot;</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;href&quot;</span><span class="p">)</span><span class="o">!==</span><span class="s2">&quot;#&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">attrHandle</span><span class="p">.</span><span class="nx">href</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;href&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">)}),</span><span class="nx">a</span><span class="o">=</span><span class="kc">null</span><span class="p">}(),</span><span class="nx">c</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="o">&amp;&amp;</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="nx">m</span><span class="p">,</span><span class="nx">b</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">),</span><span class="nx">d</span><span class="o">=</span><span class="s2">&quot;__sizzle__&quot;</span><span class="p">;</span><span class="nx">b</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="s2">&quot;&lt;p class=&#39;TEST&#39;&gt;&lt;/p&gt;&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">b</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="o">||</span><span class="nx">b</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;.TEST&quot;</span><span class="p">).</span><span class="nx">length</span><span class="o">!==</span><span class="mi">0</span><span class="p">){</span><span class="nx">m</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">f</span><span class="p">,</span><span class="nx">g</span><span class="p">){</span><span class="nx">e</span><span class="o">=</span><span class="nx">e</span><span class="o">||</span><span class="nx">c</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">g</span><span class="o">&amp;&amp;!</span><span class="nx">m</span><span class="p">.</span><span class="nx">isXML</span><span class="p">(</span><span class="nx">e</span><span class="p">)){</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="sr">/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">h</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">||</span><span class="nx">e</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">9</span><span class="p">)){</span><span class="k">if</span><span class="p">(</span><span class="nx">h</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="k">return</span> <span class="nx">s</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">b</span><span class="p">),</span><span class="nx">f</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">o</span><span class="p">.</span><span class="nx">find</span><span class="p">.</span><span class="nx">CLASS</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">)</span><span class="k">return</span> <span class="nx">s</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="nx">h</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="nx">f</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">9</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="o">===</span><span class="s2">&quot;body&quot;</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span><span class="k">return</span> <span class="nx">s</span><span class="p">([</span><span class="nx">e</span><span class="p">.</span><span class="nx">body</span><span class="p">],</span><span class="nx">f</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">h</span><span class="o">&amp;&amp;</span><span class="nx">h</span><span class="p">[</span><span class="mi">3</span><span class="p">]){</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">h</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">i</span><span class="o">||!</span><span class="nx">i</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">)</span><span class="k">return</span> <span class="nx">s</span><span class="p">([],</span><span class="nx">f</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">i</span><span class="p">.</span><span class="nx">id</span><span class="o">===</span><span class="nx">h</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="k">return</span> <span class="nx">s</span><span class="p">([</span><span class="nx">i</span><span class="p">],</span><span class="nx">f</span><span class="p">)}</span><span class="k">try</span><span class="p">{</span><span class="k">return</span> <span class="nx">s</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="nx">b</span><span class="p">),</span><span class="nx">f</span><span class="p">)}</span><span class="k">catch</span><span class="p">(</span><span class="nx">j</span><span class="p">){}}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="o">!==</span><span class="s2">&quot;object&quot;</span><span class="p">){</span><span class="kd">var</span> <span class="nx">k</span><span class="o">=</span><span class="nx">e</span><span class="p">,</span><span class="nx">l</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">),</span><span class="nx">n</span><span class="o">=</span><span class="nx">l</span><span class="o">||</span><span class="nx">d</span><span class="p">,</span><span class="nx">p</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">,</span><span class="nx">q</span><span class="o">=</span><span class="sr">/^\s*[+~]/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span><span class="nx">l</span><span class="o">?</span><span class="nx">n</span><span class="o">=</span><span class="nx">n</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&#39;/g</span><span class="p">,</span><span class="s2">&quot;\\$&amp;&quot;</span><span class="p">)</span><span class="o">:</span><span class="nx">e</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span><span class="nx">n</span><span class="p">),</span><span class="nx">q</span><span class="o">&amp;&amp;</span><span class="nx">p</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">);</span><span class="k">try</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">q</span><span class="o">||</span><span class="nx">p</span><span class="p">)</span><span class="k">return</span> <span class="nx">s</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;[id=&#39;&quot;</span><span class="o">+</span><span class="nx">n</span><span class="o">+</span><span class="s2">&quot;&#39;] &quot;</span><span class="o">+</span><span class="nx">b</span><span class="p">),</span><span class="nx">f</span><span class="p">)}</span><span class="k">catch</span><span class="p">(</span><span class="nx">r</span><span class="p">){}</span><span class="k">finally</span><span class="p">{</span><span class="nx">l</span><span class="o">||</span><span class="nx">k</span><span class="p">.</span><span class="nx">removeAttribute</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)}}}</span><span class="k">return</span> <span class="nx">a</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">f</span><span class="p">,</span><span class="nx">g</span><span class="p">)};</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">e</span> <span class="k">in</span> <span class="nx">a</span><span class="p">)</span><span class="nx">m</span><span class="p">[</span><span class="nx">e</span><span class="p">]</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">e</span><span class="p">];</span><span class="nx">b</span><span class="o">=</span><span class="kc">null</span><span class="p">}}(),</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">,</span><span class="nx">b</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">matchesSelector</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">mozMatchesSelector</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">webkitMatchesSelector</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">msMatchesSelector</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=!</span><span class="nx">b</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">),</span><span class="s2">&quot;div&quot;</span><span class="p">),</span><span class="nx">e</span><span class="o">=!</span><span class="mi">1</span><span class="p">;</span><span class="k">try</span><span class="p">{</span><span class="nx">b</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">,</span><span class="s2">&quot;[test!=&#39;&#39;]:sizzle&quot;</span><span class="p">)}</span><span class="k">catch</span><span class="p">(</span><span class="nx">f</span><span class="p">){</span><span class="nx">e</span><span class="o">=!</span><span class="mi">0</span><span class="p">}</span><span class="nx">m</span><span class="p">.</span><span class="nx">matchesSelector</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="nx">c</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\=\s*([^&#39;&quot;\]]*)\s*\]/g</span><span class="p">,</span><span class="s2">&quot;=&#39;$1&#39;]&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">m</span><span class="p">.</span><span class="nx">isXML</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span><span class="k">try</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="o">||!</span><span class="nx">o</span><span class="p">.</span><span class="nx">match</span><span class="p">.</span><span class="nx">PSEUDO</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span><span class="o">&amp;&amp;!</span><span class="sr">/!=/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">c</span><span class="p">)){</span><span class="kd">var</span> <span class="nx">f</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="o">||!</span><span class="nx">d</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nb">document</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">!==</span><span class="mi">11</span><span class="p">)</span><span class="k">return</span> <span class="nx">f</span><span class="p">}}</span><span class="k">catch</span><span class="p">(</span><span class="nx">g</span><span class="p">){}</span><span class="k">return</span> <span class="nx">m</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="kc">null</span><span class="p">,</span><span class="kc">null</span><span class="p">,[</span><span class="nx">a</span><span class="p">]).</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">}}}(),</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span><span class="nx">a</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="s2">&quot;&lt;div class=&#39;test e&#39;&gt;&lt;/div&gt;&lt;div class=&#39;test&#39;&gt;&lt;/div&gt;&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!!</span><span class="nx">a</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s2">&quot;e&quot;</span><span class="p">).</span><span class="nx">length</span><span class="o">!==</span><span class="mi">0</span><span class="p">){</span><span class="nx">a</span><span class="p">.</span><span class="nx">lastChild</span><span class="p">.</span><span class="nx">className</span><span class="o">=</span><span class="s2">&quot;e&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s2">&quot;e&quot;</span><span class="p">).</span><span class="nx">length</span><span class="o">===</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span><span class="p">;</span><span class="nx">o</span><span class="p">.</span><span class="nx">order</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;CLASS&quot;</span><span class="p">),</span><span class="nx">o</span><span class="p">.</span><span class="nx">find</span><span class="p">.</span><span class="nx">CLASS</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">b</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="o">!=</span><span class="s2">&quot;undefined&quot;</span><span class="o">&amp;&amp;!</span><span class="nx">c</span><span class="p">)</span><span class="k">return</span> <span class="nx">b</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])},</span><span class="nx">a</span><span class="o">=</span><span class="kc">null</span><span class="p">}}(),</span><span class="nx">c</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">contains</span><span class="o">?</span><span class="nx">m</span><span class="p">.</span><span class="nx">contains</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="o">!==</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">contains</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="o">:!</span><span class="mi">0</span><span class="p">)}</span><span class="o">:</span><span class="nx">c</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">compareDocumentPosition</span><span class="o">?</span><span class="nx">m</span><span class="p">.</span><span class="nx">contains</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span><span class="o">!!</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">compareDocumentPosition</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">16</span><span class="p">)}</span><span class="o">:</span><span class="nx">m</span><span class="p">.</span><span class="nx">contains</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span><span class="o">!</span><span class="mi">1</span><span class="p">},</span><span class="nx">m</span><span class="p">.</span><span class="nx">isXML</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="p">(</span><span class="nx">a</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="o">||</span><span class="nx">a</span><span class="o">:</span><span class="mi">0</span><span class="p">).</span><span class="nx">documentElement</span><span class="p">;</span><span class="k">return</span> <span class="nx">b</span><span class="o">?</span><span class="nx">b</span><span class="p">.</span><span class="nx">nodeName</span><span class="o">!==</span><span class="s2">&quot;HTML&quot;</span><span class="o">:!</span><span class="mi">1</span><span class="p">};</span><span class="kd">var</span> <span class="nx">y</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="p">[],</span><span class="nx">f</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">?</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">:</span><span class="nx">b</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="nx">o</span><span class="p">.</span><span class="nx">match</span><span class="p">.</span><span class="nx">PSEUDO</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span><span class="nx">f</span><span class="o">+=</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">match</span><span class="p">.</span><span class="nx">PSEUDO</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">);</span><span class="nx">a</span><span class="o">=</span><span class="nx">o</span><span class="p">.</span><span class="nx">relative</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span><span class="o">?</span><span class="nx">a</span><span class="o">+</span><span class="s2">&quot;*&quot;</span><span class="o">:</span><span class="nx">a</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">h</span><span class="o">&lt;</span><span class="nx">i</span><span class="p">;</span><span class="nx">h</span><span class="o">++</span><span class="p">)</span><span class="nx">m</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">g</span><span class="p">[</span><span class="nx">h</span><span class="p">],</span><span class="nx">e</span><span class="p">,</span><span class="nx">c</span><span class="p">);</span><span class="k">return</span> <span class="nx">m</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span><span class="nx">e</span><span class="p">)};</span><span class="nx">m</span><span class="p">.</span><span class="nx">attr</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">attr</span><span class="p">,</span><span class="nx">m</span><span class="p">.</span><span class="nx">selectors</span><span class="p">.</span><span class="nx">attrMap</span><span class="o">=</span><span class="p">{},</span><span class="nx">f</span><span class="p">.</span><span class="nx">find</span><span class="o">=</span><span class="nx">m</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">expr</span><span class="o">=</span><span class="nx">m</span><span class="p">.</span><span class="nx">selectors</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">expr</span><span class="p">[</span><span class="s2">&quot;:&quot;</span><span class="p">]</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">expr</span><span class="p">.</span><span class="nx">filters</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">unique</span><span class="o">=</span><span class="nx">m</span><span class="p">.</span><span class="nx">uniqueSort</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">text</span><span class="o">=</span><span class="nx">m</span><span class="p">.</span><span class="nx">getText</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">isXMLDoc</span><span class="o">=</span><span class="nx">m</span><span class="p">.</span><span class="nx">isXML</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">contains</span><span class="o">=</span><span class="nx">m</span><span class="p">.</span><span class="nx">contains</span><span class="p">}();</span><span class="kd">var</span> <span class="nx">L</span><span class="o">=</span><span class="sr">/Until$/</span><span class="p">,</span><span class="nx">M</span><span class="o">=</span><span class="sr">/^(?:parents|prevUntil|prevAll)/</span><span class="p">,</span><span class="nx">N</span><span class="o">=</span><span class="sr">/,/</span><span class="p">,</span><span class="nx">O</span><span class="o">=</span><span class="sr">/^.[^:#\[\.,]*$/</span><span class="p">,</span><span class="nx">P</span><span class="o">=</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">,</span><span class="nx">Q</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">expr</span><span class="p">.</span><span class="nx">match</span><span class="p">.</span><span class="nx">POS</span><span class="p">,</span><span class="nx">R</span><span class="o">=</span><span class="p">{</span><span class="nx">children</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">contents</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">next</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">prev</span><span class="o">:!</span><span class="mi">0</span><span class="p">};</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">find</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="k">this</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">!=</span><span class="s2">&quot;string&quot;</span><span class="p">)</span><span class="k">return</span> <span class="nx">f</span><span class="p">(</span><span class="nx">a</span><span class="p">).</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="k">for</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">c</span><span class="o">&lt;</span><span class="nx">d</span><span class="p">;</span><span class="nx">c</span><span class="o">++</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="nx">c</span><span class="p">],</span><span class="k">this</span><span class="p">))</span><span class="k">return</span><span class="o">!</span><span class="mi">0</span><span class="p">});</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">pushStack</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;find&quot;</span><span class="p">,</span><span class="nx">a</span><span class="p">),</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">c</span><span class="o">&lt;</span><span class="nx">d</span><span class="p">;</span><span class="nx">c</span><span class="o">++</span><span class="p">){</span><span class="nx">g</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="k">this</span><span class="p">[</span><span class="nx">c</span><span class="p">],</span><span class="nx">e</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="nx">h</span><span class="o">=</span><span class="nx">g</span><span class="p">;</span><span class="nx">h</span><span class="o">&lt;</span><span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">h</span><span class="o">++</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">g</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">===</span><span class="nx">e</span><span class="p">[</span><span class="nx">h</span><span class="p">]){</span><span class="nx">e</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">h</span><span class="o">--</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="k">break</span><span class="p">}}</span><span class="k">return</span> <span class="nx">e</span><span class="p">},</span><span class="nx">has</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">f</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">a</span><span class="o">&lt;</span><span class="nx">c</span><span class="p">;</span><span class="nx">a</span><span class="o">++</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">b</span><span class="p">[</span><span class="nx">a</span><span class="p">]))</span><span class="k">return</span><span class="o">!</span><span class="mi">0</span><span class="p">})},</span><span class="nx">not</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">pushStack</span><span class="p">(</span><span class="nx">T</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="o">!</span><span class="mi">1</span><span class="p">),</span><span class="s2">&quot;not&quot;</span><span class="p">,</span><span class="nx">a</span><span class="p">)},</span><span class="nx">filter</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">pushStack</span><span class="p">(</span><span class="nx">T</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">),</span><span class="s2">&quot;filter&quot;</span><span class="p">,</span><span class="nx">a</span><span class="p">)},</span><span class="nx">is</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span><span class="o">!!</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="o">?</span><span class="nx">Q</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">?</span><span class="nx">f</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">).</span><span class="nx">index</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">&gt;=</span><span class="mi">0</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="k">this</span><span class="p">).</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">a</span><span class="p">).</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)},</span><span class="nx">closest</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="p">[],</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">a</span><span class="p">)){</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="nx">g</span><span class="o">&amp;&amp;</span><span class="nx">g</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="o">&amp;&amp;</span><span class="nx">g</span><span class="o">!==</span><span class="nx">b</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">d</span><span class="o">&lt;</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">d</span><span class="o">++</span><span class="p">)</span><span class="nx">f</span><span class="p">(</span><span class="nx">g</span><span class="p">).</span><span class="nx">is</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">d</span><span class="p">])</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="nx">selector</span><span class="o">:</span><span class="nx">a</span><span class="p">[</span><span class="nx">d</span><span class="p">],</span><span class="nx">elem</span><span class="o">:</span><span class="nx">g</span><span class="p">,</span><span class="nx">level</span><span class="o">:</span><span class="nx">h</span><span class="p">});</span><span class="nx">g</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">,</span><span class="nx">h</span><span class="o">++</span><span class="p">}</span><span class="k">return</span> <span class="nx">c</span><span class="p">}</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="nx">Q</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">||</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">!=</span><span class="s2">&quot;string&quot;</span><span class="o">?</span><span class="nx">f</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">)</span><span class="o">:</span><span class="mi">0</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">d</span><span class="o">&lt;</span><span class="nx">e</span><span class="p">;</span><span class="nx">d</span><span class="o">++</span><span class="p">){</span><span class="nx">g</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="nx">d</span><span class="p">];</span><span class="k">while</span><span class="p">(</span><span class="nx">g</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">i</span><span class="o">?</span><span class="nx">i</span><span class="p">.</span><span class="nx">index</span><span class="p">(</span><span class="nx">g</span><span class="p">)</span><span class="o">&gt;-</span><span class="mi">1</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">find</span><span class="p">.</span><span class="nx">matchesSelector</span><span class="p">(</span><span class="nx">g</span><span class="p">,</span><span class="nx">a</span><span class="p">)){</span><span class="nx">c</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">g</span><span class="p">);</span><span class="k">break</span><span class="p">}</span><span class="nx">g</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">g</span><span class="o">||!</span><span class="nx">g</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="o">||</span><span class="nx">g</span><span class="o">===</span><span class="nx">b</span><span class="o">||</span><span class="nx">g</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">11</span><span class="p">)</span><span class="k">break</span><span class="p">}}</span><span class="nx">c</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">unique</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span><span class="o">:</span><span class="nx">c</span><span class="p">;</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">pushStack</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="s2">&quot;closest&quot;</span><span class="p">,</span><span class="nx">a</span><span class="p">)},</span><span class="nx">index</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">a</span><span class="p">)</span><span class="k">return</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">parentNode</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">prevAll</span><span class="p">().</span><span class="nx">length</span><span class="o">:-</span><span class="mi">1</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="p">)</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">inArray</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">f</span><span class="p">(</span><span class="nx">a</span><span class="p">));</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">inArray</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">jquery</span><span class="o">?</span><span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">:</span><span class="nx">a</span><span class="p">,</span><span class="k">this</span><span class="p">)},</span><span class="nx">add</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="o">?</span><span class="nx">f</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">)</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">makeArray</span><span class="p">(</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">?</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span><span class="o">:</span><span class="nx">a</span><span class="p">),</span><span class="nx">d</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(),</span><span class="nx">c</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">pushStack</span><span class="p">(</span><span class="nx">S</span><span class="p">(</span><span class="nx">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">||</span><span class="nx">S</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">?</span><span class="nx">d</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">unique</span><span class="p">(</span><span class="nx">d</span><span class="p">))},</span><span class="nx">andSelf</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">prevObject</span><span class="p">)}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">({</span><span class="nx">parent</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span><span class="k">return</span> <span class="nx">b</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">!==</span><span class="mi">11</span><span class="o">?</span><span class="nx">b</span><span class="o">:</span><span class="kc">null</span><span class="p">},</span><span class="nx">parents</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;parentNode&quot;</span><span class="p">)},</span><span class="nx">parentsUntil</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;parentNode&quot;</span><span class="p">,</span><span class="nx">c</span><span class="p">)},</span><span class="nx">next</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">nth</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;nextSibling&quot;</span><span class="p">)},</span><span class="nx">prev</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">nth</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;previousSibling&quot;</span><span class="p">)},</span><span class="nx">nextAll</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;nextSibling&quot;</span><span class="p">)},</span><span class="nx">prevAll</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;previousSibling&quot;</span><span class="p">)},</span><span class="nx">nextUntil</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;nextSibling&quot;</span><span class="p">,</span><span class="nx">c</span><span class="p">)},</span><span class="nx">prevUntil</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;previousSibling&quot;</span><span class="p">,</span><span class="nx">c</span><span class="p">)},</span><span class="nx">siblings</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">sibling</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">,</span><span class="nx">a</span><span class="p">)},</span><span class="nx">children</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">sibling</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">)},</span><span class="nx">contents</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;iframe&quot;</span><span class="p">)</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">contentDocument</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">contentWindow</span><span class="p">.</span><span class="nb">document</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">makeArray</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">)}},</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">);</span><span class="nx">L</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="nx">c</span><span class="p">),</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">d</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">)),</span><span class="nx">e</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&amp;&amp;!</span><span class="nx">R</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">unique</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="o">:</span><span class="nx">e</span><span class="p">,(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">||</span><span class="nx">N</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">d</span><span class="p">))</span><span class="o">&amp;&amp;</span><span class="nx">M</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">reverse</span><span class="p">());</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">pushStack</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">P</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">))}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">filter</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="o">=</span><span class="s2">&quot;:not(&quot;</span><span class="o">+</span><span class="nx">a</span><span class="o">+</span><span class="s2">&quot;)&quot;</span><span class="p">);</span><span class="k">return</span> <span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="o">===</span><span class="mi">1</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">find</span><span class="p">.</span><span class="nx">matchesSelector</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">a</span><span class="p">)</span><span class="o">?</span><span class="p">[</span><span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">:</span><span class="p">[]</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">find</span><span class="p">.</span><span class="nx">matches</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">)},</span><span class="nx">dir</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="p">[],</span><span class="nx">g</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">c</span><span class="p">];</span><span class="k">while</span><span class="p">(</span><span class="nx">g</span><span class="o">&amp;&amp;</span><span class="nx">g</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">!==</span><span class="mi">9</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">d</span><span class="o">===</span><span class="nx">b</span><span class="o">||</span><span class="nx">g</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">!==</span><span class="mi">1</span><span class="o">||!</span><span class="nx">f</span><span class="p">(</span><span class="nx">g</span><span class="p">).</span><span class="nx">is</span><span class="p">(</span><span class="nx">d</span><span class="p">)))</span><span class="nx">g</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">g</span><span class="p">),</span><span class="nx">g</span><span class="o">=</span><span class="nx">g</span><span class="p">[</span><span class="nx">c</span><span class="p">];</span><span class="k">return</span> <span class="nx">e</span><span class="p">},</span><span class="nx">nth</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="nx">b</span><span class="o">=</span><span class="nx">b</span><span class="o">||</span><span class="mi">1</span><span class="p">;</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">for</span><span class="p">(;</span><span class="nx">a</span><span class="p">;</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">c</span><span class="p">])</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;++</span><span class="nx">e</span><span class="o">===</span><span class="nx">b</span><span class="p">)</span><span class="k">break</span><span class="p">;</span><span class="k">return</span> <span class="nx">a</span><span class="p">},</span><span class="nx">sibling</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="p">[];</span><span class="k">for</span><span class="p">(;</span><span class="nx">a</span><span class="p">;</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">)</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="o">!==</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="k">return</span> <span class="nx">c</span><span class="p">}});</span><span class="kd">var</span> <span class="nx">V</span><span class="o">=</span><span class="s2">&quot;abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video&quot;</span><span class="p">,</span><span class="nx">W</span><span class="o">=</span><span class="sr">/ jQuery\d+=&quot;(?:\d+|null)&quot;/g</span><span class="p">,</span><span class="nx">X</span><span class="o">=</span><span class="sr">/^\s+/</span><span class="p">,</span><span class="nx">Y</span><span class="o">=</span><span class="sr">/&lt;(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^&gt;]*)\/&gt;/ig</span><span class="p">,</span><span class="nx">Z</span><span class="o">=</span><span class="sr">/&lt;([\w:]+)/</span><span class="p">,</span><span class="nx">$</span><span class="o">=</span><span class="sr">/&lt;tbody/i</span><span class="p">,</span><span class="nx">_</span><span class="o">=</span><span class="sr">/&lt;|&amp;#?\w+;/</span><span class="p">,</span><span class="nx">ba</span><span class="o">=</span><span class="sr">/&lt;(?:script|style)/i</span><span class="p">,</span><span class="nx">bb</span><span class="o">=</span><span class="sr">/&lt;(?:script|object|embed|option|style)/i</span><span class="p">,</span><span class="nx">bc</span><span class="o">=</span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;&lt;(?:&quot;</span><span class="o">+</span><span class="nx">V</span><span class="o">+</span><span class="s2">&quot;)&quot;</span><span class="p">,</span><span class="s2">&quot;i&quot;</span><span class="p">),</span><span class="nx">bd</span><span class="o">=</span><span class="sr">/checked\s*(?:[^=]|=\s*.checked.)/i</span><span class="p">,</span><span class="nx">be</span><span class="o">=</span><span class="sr">/\/(java|ecma)script/i</span><span class="p">,</span><span class="nx">bf</span><span class="o">=</span><span class="sr">/^\s*&lt;!(?:\[CDATA\[|\-\-)/</span><span class="p">,</span><span class="nx">bg</span><span class="o">=</span><span class="p">{</span><span class="nx">option</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;select multiple=&#39;multiple&#39;&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/select&gt;&quot;</span><span class="p">],</span><span class="nx">legend</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;fieldset&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/fieldset&gt;&quot;</span><span class="p">],</span><span class="nx">thead</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;table&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/table&gt;&quot;</span><span class="p">],</span><span class="nx">tr</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;&lt;table&gt;&lt;tbody&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/tbody&gt;&lt;/table&gt;&quot;</span><span class="p">],</span><span class="nx">td</span><span class="o">:</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&quot;</span><span class="p">],</span><span class="nx">col</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;&lt;table&gt;&lt;tbody&gt;&lt;/tbody&gt;&lt;colgroup&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/colgroup&gt;&lt;/table&gt;&quot;</span><span class="p">],</span><span class="nx">area</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;&lt;map&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/map&gt;&quot;</span><span class="p">],</span><span class="nx">_default</span><span class="o">:</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">]},</span><span class="nx">bh</span><span class="o">=</span><span class="nx">U</span><span class="p">(</span><span class="nx">c</span><span class="p">);</span><span class="nx">bg</span><span class="p">.</span><span class="nx">optgroup</span><span class="o">=</span><span class="nx">bg</span><span class="p">.</span><span class="nx">option</span><span class="p">,</span><span class="nx">bg</span><span class="p">.</span><span class="nx">tbody</span><span class="o">=</span><span class="nx">bg</span><span class="p">.</span><span class="nx">tfoot</span><span class="o">=</span><span class="nx">bg</span><span class="p">.</span><span class="nx">colgroup</span><span class="o">=</span><span class="nx">bg</span><span class="p">.</span><span class="nx">caption</span><span class="o">=</span><span class="nx">bg</span><span class="p">.</span><span class="nx">thead</span><span class="p">,</span><span class="nx">bg</span><span class="p">.</span><span class="nx">th</span><span class="o">=</span><span class="nx">bg</span><span class="p">.</span><span class="nx">td</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">htmlSerialize</span><span class="o">||</span><span class="p">(</span><span class="nx">bg</span><span class="p">.</span><span class="nx">_default</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;div&lt;div&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;/div&gt;&quot;</span><span class="p">]),</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">text</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="nx">c</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">.</span><span class="nx">text</span><span class="p">()))});</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">!=</span><span class="s2">&quot;object&quot;</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="o">!==</span><span class="nx">b</span><span class="p">)</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">empty</span><span class="p">().</span><span class="nx">append</span><span class="p">((</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">ownerDocument</span><span class="o">||</span><span class="nx">c</span><span class="p">).</span><span class="nx">createTextNode</span><span class="p">(</span><span class="nx">a</span><span class="p">));</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="k">this</span><span class="p">)},</span><span class="nx">wrapAll</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">wrapAll</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">b</span><span class="p">))});</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">f</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">ownerDocument</span><span class="p">).</span><span class="nx">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">clone</span><span class="p">(</span><span class="o">!</span><span class="mi">0</span><span class="p">);</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">parentNode</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nx">b</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="k">this</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">firstChild</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="p">)</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">;</span><span class="k">return</span> <span class="nx">a</span><span class="p">}).</span><span class="nx">append</span><span class="p">(</span><span class="k">this</span><span class="p">)}</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">wrapInner</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">wrapInner</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">b</span><span class="p">))});</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">),</span><span class="nx">c</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">contents</span><span class="p">();</span><span class="nx">c</span><span class="p">.</span><span class="nx">length</span><span class="o">?</span><span class="nx">c</span><span class="p">.</span><span class="nx">wrapAll</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">:</span><span class="nx">b</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">a</span><span class="p">)})},</span><span class="nx">wrap</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">wrapAll</span><span class="p">(</span><span class="nx">b</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">c</span><span class="p">)</span><span class="o">:</span><span class="nx">a</span><span class="p">)})},</span><span class="nx">unwrap</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">().</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;body&quot;</span><span class="p">)</span><span class="o">||</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">replaceWith</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">)}).</span><span class="nx">end</span><span class="p">()},</span><span class="nx">append</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">domManip</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">a</span><span class="p">)})},</span><span class="nx">prepend</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">domManip</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">)})},</span><span class="nx">before</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">parentNode</span><span class="p">)</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">domManip</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="o">!</span><span class="mi">1</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="k">this</span><span class="p">)});</span><span class="k">if</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">){</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">clean</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span><span class="nx">a</span><span class="p">.</span><span class="nx">push</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">toArray</span><span class="p">());</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">pushStack</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;before&quot;</span><span class="p">,</span><span class="nx">arguments</span><span class="p">)}},</span><span class="nx">after</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">parentNode</span><span class="p">)</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">domManip</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span><span class="o">!</span><span class="mi">1</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">)});</span><span class="k">if</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">){</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">pushStack</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;after&quot;</span><span class="p">,</span><span class="nx">arguments</span><span class="p">);</span><span class="nx">a</span><span class="p">.</span><span class="nx">push</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">clean</span><span class="p">(</span><span class="nx">arguments</span><span class="p">));</span><span class="k">return</span> <span class="nx">a</span><span class="p">}},</span><span class="nx">remove</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">d</span><span class="p">;(</span><span class="nx">d</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="nx">c</span><span class="p">])</span><span class="o">!=</span><span class="kc">null</span><span class="p">;</span><span class="nx">c</span><span class="o">++</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">a</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">a</span><span class="p">,[</span><span class="nx">d</span><span class="p">]).</span><span class="nx">length</span><span class="p">)</span><span class="o">!</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">cleanData</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)),</span><span class="nx">f</span><span class="p">.</span><span class="nx">cleanData</span><span class="p">([</span><span class="nx">d</span><span class="p">])),</span><span class="nx">d</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">d</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">empty</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span>
<span class="p">{</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">b</span><span class="p">;(</span><span class="nx">b</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="nx">a</span><span class="p">])</span><span class="o">!=</span><span class="kc">null</span><span class="p">;</span><span class="nx">a</span><span class="o">++</span><span class="p">){</span><span class="nx">b</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">cleanData</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">));</span><span class="k">while</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">)</span><span class="nx">b</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">)}</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">clone</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="o">==</span><span class="kc">null</span><span class="o">?!</span><span class="mi">1</span><span class="o">:</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="o">=</span><span class="nx">b</span><span class="o">==</span><span class="kc">null</span><span class="o">?</span><span class="nx">a</span><span class="o">:</span><span class="nx">b</span><span class="p">;</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">)})},</span><span class="nx">html</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">===</span><span class="nx">b</span><span class="p">)</span><span class="k">return</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">?</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">innerHTML</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">W</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">:</span><span class="kc">null</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="o">&amp;&amp;!</span><span class="nx">ba</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">leadingWhitespace</span><span class="o">||!</span><span class="nx">X</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span><span class="o">&amp;&amp;!</span><span class="nx">bg</span><span class="p">[(</span><span class="nx">Z</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">||</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">])[</span><span class="mi">1</span><span class="p">].</span><span class="nx">toLowerCase</span><span class="p">()]){</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span><span class="s2">&quot;&lt;$1&gt;&lt;/$2&gt;&quot;</span><span class="p">);</span><span class="k">try</span><span class="p">{</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">c</span><span class="o">&lt;</span><span class="nx">d</span><span class="p">;</span><span class="nx">c</span><span class="o">++</span><span class="p">)</span><span class="k">this</span><span class="p">[</span><span class="nx">c</span><span class="p">].</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">cleanData</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">c</span><span class="p">].</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)),</span><span class="k">this</span><span class="p">[</span><span class="nx">c</span><span class="p">].</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">a</span><span class="p">)}</span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">empty</span><span class="p">().</span><span class="nx">append</span><span class="p">(</span><span class="nx">a</span><span class="p">)}}</span><span class="k">else</span> <span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="nx">c</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">.</span><span class="nx">html</span><span class="p">()))})</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">empty</span><span class="p">().</span><span class="nx">append</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">replaceWith</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">parentNode</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">),</span><span class="nx">d</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">html</span><span class="p">();</span><span class="nx">c</span><span class="p">.</span><span class="nx">replaceWith</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">))});</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">!=</span><span class="s2">&quot;string&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="o">=</span><span class="nx">f</span><span class="p">(</span><span class="nx">a</span><span class="p">).</span><span class="nx">detach</span><span class="p">());</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">remove</span><span class="p">(),</span><span class="nx">b</span><span class="o">?</span><span class="nx">f</span><span class="p">(</span><span class="nx">b</span><span class="p">).</span><span class="nx">before</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">:</span><span class="nx">f</span><span class="p">(</span><span class="nx">c</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">a</span><span class="p">)})}</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">pushStack</span><span class="p">(</span><span class="nx">f</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">?</span><span class="nx">a</span><span class="p">()</span><span class="o">:</span><span class="nx">a</span><span class="p">),</span><span class="s2">&quot;replaceWith&quot;</span><span class="p">,</span><span class="nx">a</span><span class="p">)</span><span class="o">:</span><span class="k">this</span><span class="p">},</span><span class="nx">detach</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">)},</span><span class="nx">domManip</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">k</span><span class="o">=</span><span class="p">[];</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">checkClone</span><span class="o">&amp;&amp;</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="o">===</span><span class="mi">3</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">j</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="o">&amp;&amp;</span><span class="nx">bd</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">j</span><span class="p">))</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">domManip</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">)});</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">j</span><span class="p">))</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span><span class="kd">var</span> <span class="nx">g</span><span class="o">=</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nx">j</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">c</span><span class="o">?</span><span class="nx">g</span><span class="p">.</span><span class="nx">html</span><span class="p">()</span><span class="o">:</span><span class="nx">b</span><span class="p">),</span><span class="nx">g</span><span class="p">.</span><span class="nx">domManip</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">)});</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]){</span><span class="nx">i</span><span class="o">=</span><span class="nx">j</span><span class="o">&amp;&amp;</span><span class="nx">j</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">&amp;&amp;</span><span class="nx">i</span><span class="o">&amp;&amp;</span><span class="nx">i</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">11</span><span class="o">&amp;&amp;</span><span class="nx">i</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span><span class="o">===</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">?</span><span class="nx">e</span><span class="o">=</span><span class="p">{</span><span class="nx">fragment</span><span class="o">:</span><span class="nx">i</span><span class="p">}</span><span class="o">:</span><span class="nx">e</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">buildFragment</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="nx">k</span><span class="p">),</span><span class="nx">h</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">fragment</span><span class="p">,</span><span class="nx">h</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span><span class="o">===</span><span class="mi">1</span><span class="o">?</span><span class="nx">g</span><span class="o">=</span><span class="nx">h</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">firstChild</span><span class="o">:</span><span class="nx">g</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">g</span><span class="p">){</span><span class="nx">c</span><span class="o">=</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">(</span><span class="nx">g</span><span class="p">,</span><span class="s2">&quot;tr&quot;</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">m</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="nx">n</span><span class="o">=</span><span class="nx">m</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="nx">l</span><span class="o">&lt;</span><span class="nx">m</span><span class="p">;</span><span class="nx">l</span><span class="o">++</span><span class="p">)</span><span class="nx">d</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">c</span><span class="o">?</span><span class="nx">bi</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">l</span><span class="p">],</span><span class="nx">g</span><span class="p">)</span><span class="o">:</span><span class="k">this</span><span class="p">[</span><span class="nx">l</span><span class="p">],</span><span class="nx">e</span><span class="p">.</span><span class="nx">cacheable</span><span class="o">||</span><span class="nx">m</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">l</span><span class="o">&lt;</span><span class="nx">n</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">h</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span><span class="nx">h</span><span class="p">)}</span><span class="nx">k</span><span class="p">.</span><span class="nx">length</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span><span class="nx">bp</span><span class="p">)}</span><span class="k">return</span> <span class="k">this</span><span class="p">}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">buildFragment</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">ownerDocument</span><span class="o">||</span><span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nx">i</span><span class="p">.</span><span class="nx">createDocumentFragment</span><span class="o">||</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="nx">c</span><span class="p">),</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">j</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="o">&amp;&amp;</span><span class="nx">j</span><span class="p">.</span><span class="nx">length</span><span class="o">&lt;</span><span class="mi">512</span><span class="o">&amp;&amp;</span><span class="nx">i</span><span class="o">===</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="nx">j</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">===</span><span class="s2">&quot;&lt;&quot;</span><span class="o">&amp;&amp;!</span><span class="nx">bb</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">j</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">checkClone</span><span class="o">||!</span><span class="nx">bd</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">j</span><span class="p">))</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">html5Clone</span><span class="o">||!</span><span class="nx">bc</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">j</span><span class="p">))</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">g</span><span class="o">=!</span><span class="mi">0</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">fragments</span><span class="p">[</span><span class="nx">j</span><span class="p">],</span><span class="nx">h</span><span class="o">&amp;&amp;</span><span class="nx">h</span><span class="o">!==</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">h</span><span class="p">)),</span><span class="nx">e</span><span class="o">||</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">i</span><span class="p">.</span><span class="nx">createDocumentFragment</span><span class="p">(),</span><span class="nx">f</span><span class="p">.</span><span class="nx">clean</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">d</span><span class="p">)),</span><span class="nx">g</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">fragments</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span><span class="o">=</span><span class="nx">h</span><span class="o">?</span><span class="nx">e</span><span class="o">:</span><span class="mi">1</span><span class="p">);</span><span class="k">return</span><span class="p">{</span><span class="nx">fragment</span><span class="o">:</span><span class="nx">e</span><span class="p">,</span><span class="nx">cacheable</span><span class="o">:</span><span class="nx">g</span><span class="p">}},</span><span class="nx">f</span><span class="p">.</span><span class="nx">fragments</span><span class="o">=</span><span class="p">{},</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">({</span><span class="nx">appendTo</span><span class="o">:</span><span class="s2">&quot;append&quot;</span><span class="p">,</span><span class="nx">prependTo</span><span class="o">:</span><span class="s2">&quot;prepend&quot;</span><span class="p">,</span><span class="nx">insertBefore</span><span class="o">:</span><span class="s2">&quot;before&quot;</span><span class="p">,</span><span class="nx">insertAfter</span><span class="o">:</span><span class="s2">&quot;after&quot;</span><span class="p">,</span><span class="nx">replaceAll</span><span class="o">:</span><span class="s2">&quot;replaceWith&quot;</span><span class="p">},</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="p">[],</span><span class="nx">e</span><span class="o">=</span><span class="nx">f</span><span class="p">(</span><span class="nx">c</span><span class="p">),</span><span class="nx">g</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">parentNode</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">g</span><span class="o">&amp;&amp;</span><span class="nx">g</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">11</span><span class="o">&amp;&amp;</span><span class="nx">g</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span><span class="o">===</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="o">===</span><span class="mi">1</span><span class="p">){</span><span class="nx">e</span><span class="p">[</span><span class="nx">b</span><span class="p">](</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span><span class="k">return</span> <span class="k">this</span><span class="p">}</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">h</span><span class="o">&lt;</span><span class="nx">i</span><span class="p">;</span><span class="nx">h</span><span class="o">++</span><span class="p">){</span><span class="kd">var</span> <span class="nx">j</span><span class="o">=</span><span class="p">(</span><span class="nx">h</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="o">!</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span><span class="k">this</span><span class="p">).</span><span class="nx">get</span><span class="p">();</span><span class="nx">f</span><span class="p">(</span><span class="nx">e</span><span class="p">[</span><span class="nx">h</span><span class="p">])[</span><span class="nx">b</span><span class="p">](</span><span class="nx">j</span><span class="p">),</span><span class="nx">d</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">j</span><span class="p">)}</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">pushStack</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">selector</span><span class="p">)}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">clone</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">html5Clone</span><span class="o">||!</span><span class="nx">bc</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="o">+</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">)</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="o">!</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span><span class="nx">bo</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="k">if</span><span class="p">((</span><span class="o">!</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">noCloneEvent</span><span class="o">||!</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">noCloneChecked</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">11</span><span class="p">)</span><span class="o">&amp;&amp;!</span><span class="nx">f</span><span class="p">.</span><span class="nx">isXMLDoc</span><span class="p">(</span><span class="nx">a</span><span class="p">)){</span><span class="nx">bk</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">h</span><span class="p">),</span><span class="nx">d</span><span class="o">=</span><span class="nx">bl</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span><span class="nx">e</span><span class="o">=</span><span class="nx">bl</span><span class="p">(</span><span class="nx">h</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="nx">g</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">d</span><span class="p">[</span><span class="nx">g</span><span class="p">];</span><span class="o">++</span><span class="nx">g</span><span class="p">)</span><span class="nx">e</span><span class="p">[</span><span class="nx">g</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">bk</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="nx">g</span><span class="p">],</span><span class="nx">e</span><span class="p">[</span><span class="nx">g</span><span class="p">])}</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="nx">bj</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">h</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span><span class="nx">d</span><span class="o">=</span><span class="nx">bl</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span><span class="nx">e</span><span class="o">=</span><span class="nx">bl</span><span class="p">(</span><span class="nx">h</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="nx">g</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">d</span><span class="p">[</span><span class="nx">g</span><span class="p">];</span><span class="o">++</span><span class="nx">g</span><span class="p">)</span><span class="nx">bj</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="nx">g</span><span class="p">],</span><span class="nx">e</span><span class="p">[</span><span class="nx">g</span><span class="p">])}}</span><span class="nx">d</span><span class="o">=</span><span class="nx">e</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="k">return</span> <span class="nx">h</span><span class="p">},</span><span class="nx">clean</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">){</span><span class="kd">var</span> <span class="nx">g</span><span class="p">;</span><span class="nx">b</span><span class="o">=</span><span class="nx">b</span><span class="o">||</span><span class="nx">c</span><span class="p">,</span><span class="k">typeof</span> <span class="nx">b</span><span class="p">.</span><span class="nx">createElement</span><span class="o">==</span><span class="s2">&quot;undefined&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">b</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="o">||</span><span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">ownerDocument</span><span class="o">||</span><span class="nx">c</span><span class="p">);</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="p">[],</span><span class="nx">i</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">j</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">k</span><span class="p">;(</span><span class="nx">k</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">j</span><span class="p">])</span><span class="o">!=</span><span class="kc">null</span><span class="p">;</span><span class="nx">j</span><span class="o">++</span><span class="p">){</span><span class="k">typeof</span> <span class="nx">k</span><span class="o">==</span><span class="s2">&quot;number&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">k</span><span class="o">+=</span><span class="s2">&quot;&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">k</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">k</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">k</span><span class="p">))</span><span class="nx">k</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="nx">k</span><span class="p">);</span><span class="k">else</span><span class="p">{</span><span class="nx">k</span><span class="o">=</span><span class="nx">k</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span><span class="s2">&quot;&lt;$1&gt;&lt;/$2&gt;&quot;</span><span class="p">);</span><span class="kd">var</span> <span class="nx">l</span><span class="o">=</span><span class="p">(</span><span class="nx">Z</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">k</span><span class="p">)</span><span class="o">||</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">])[</span><span class="mi">1</span><span class="p">].</span><span class="nx">toLowerCase</span><span class="p">(),</span><span class="nx">m</span><span class="o">=</span><span class="nx">bg</span><span class="p">[</span><span class="nx">l</span><span class="p">]</span><span class="o">||</span><span class="nx">bg</span><span class="p">.</span><span class="nx">_default</span><span class="p">,</span><span class="nx">n</span><span class="o">=</span><span class="nx">m</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">o</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span><span class="nx">b</span><span class="o">===</span><span class="nx">c</span><span class="o">?</span><span class="nx">bh</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">o</span><span class="p">)</span><span class="o">:</span><span class="nx">U</span><span class="p">(</span><span class="nx">b</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">o</span><span class="p">),</span><span class="nx">o</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="nx">k</span><span class="o">+</span><span class="nx">m</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="k">while</span><span class="p">(</span><span class="nx">n</span><span class="o">--</span><span class="p">)</span><span class="nx">o</span><span class="o">=</span><span class="nx">o</span><span class="p">.</span><span class="nx">lastChild</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">tbody</span><span class="p">){</span><span class="kd">var</span> <span class="nx">p</span><span class="o">=</span><span class="nx">$</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">k</span><span class="p">),</span><span class="nx">q</span><span class="o">=</span><span class="nx">l</span><span class="o">===</span><span class="s2">&quot;table&quot;</span><span class="o">&amp;&amp;!</span><span class="nx">p</span><span class="o">?</span><span class="nx">o</span><span class="p">.</span><span class="nx">firstChild</span><span class="o">&amp;&amp;</span><span class="nx">o</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">.</span><span class="nx">childNodes</span><span class="o">:</span><span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">===</span><span class="s2">&quot;&lt;table&gt;&quot;</span><span class="o">&amp;&amp;!</span><span class="nx">p</span><span class="o">?</span><span class="nx">o</span><span class="p">.</span><span class="nx">childNodes</span><span class="o">:</span><span class="p">[];</span><span class="k">for</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="nx">q</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="nx">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="o">--</span><span class="nx">i</span><span class="p">)</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">(</span><span class="nx">q</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span><span class="s2">&quot;tbody&quot;</span><span class="p">)</span><span class="o">&amp;&amp;!</span><span class="nx">q</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span><span class="o">&amp;&amp;</span><span class="nx">q</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">q</span><span class="p">[</span><span class="nx">i</span><span class="p">])}</span><span class="o">!</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">leadingWhitespace</span><span class="o">&amp;&amp;</span><span class="nx">X</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">k</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">o</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="nx">X</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">k</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span><span class="nx">o</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">),</span><span class="nx">k</span><span class="o">=</span><span class="nx">o</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">}</span><span class="kd">var</span> <span class="nx">r</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">appendChecked</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="p">(</span><span class="nx">r</span><span class="o">=</span><span class="nx">k</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;number&quot;</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">r</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="nx">bn</span><span class="p">(</span><span class="nx">k</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span><span class="k">else</span> <span class="nx">bn</span><span class="p">(</span><span class="nx">k</span><span class="p">);</span><span class="nx">k</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">?</span><span class="nx">h</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">k</span><span class="p">)</span><span class="o">:</span><span class="nx">h</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">h</span><span class="p">,</span><span class="nx">k</span><span class="p">)}</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="nx">g</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span><span class="o">!</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="o">||</span><span class="nx">be</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="p">)};</span><span class="k">for</span><span class="p">(</span><span class="nx">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">h</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span><span class="nx">j</span><span class="o">++</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">(</span><span class="nx">h</span><span class="p">[</span><span class="nx">j</span><span class="p">],</span><span class="s2">&quot;script&quot;</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="nx">h</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">type</span><span class="o">||</span><span class="nx">h</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">type</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="o">===</span><span class="s2">&quot;text/javascript&quot;</span><span class="p">))</span><span class="nx">e</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">h</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">parentNode</span><span class="o">?</span><span class="nx">h</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">h</span><span class="p">[</span><span class="nx">j</span><span class="p">])</span><span class="o">:</span><span class="nx">h</span><span class="p">[</span><span class="nx">j</span><span class="p">]);</span><span class="k">else</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">h</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="p">){</span><span class="kd">var</span> <span class="nx">s</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">grep</span><span class="p">(</span><span class="nx">h</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">),</span><span class="nx">g</span><span class="p">);</span><span class="nx">h</span><span class="p">.</span><span class="nx">splice</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">h</span><span class="p">,[</span><span class="nx">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">s</span><span class="p">))}</span><span class="nx">d</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">h</span><span class="p">[</span><span class="nx">j</span><span class="p">])}}</span><span class="k">return</span> <span class="nx">h</span><span class="p">},</span><span class="nx">cleanData</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">cache</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">special</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">deleteExpando</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">i</span><span class="p">;(</span><span class="nx">i</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">h</span><span class="p">])</span><span class="o">!=</span><span class="kc">null</span><span class="p">;</span><span class="nx">h</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">i</span><span class="p">.</span><span class="nx">nodeName</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">noData</span><span class="p">[</span><span class="nx">i</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()])</span><span class="k">continue</span><span class="p">;</span><span class="nx">c</span><span class="o">=</span><span class="nx">i</span><span class="p">[</span><span class="nx">f</span><span class="p">.</span><span class="nx">expando</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span><span class="nx">b</span><span class="o">=</span><span class="nx">d</span><span class="p">[</span><span class="nx">c</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="p">.</span><span class="nx">events</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="k">in</span> <span class="nx">b</span><span class="p">.</span><span class="nx">events</span><span class="p">)</span><span class="nx">e</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">)</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">removeEvent</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="nx">b</span><span class="p">.</span><span class="nx">handle</span><span class="p">);</span><span class="nx">b</span><span class="p">.</span><span class="nx">handle</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">handle</span><span class="p">.</span><span class="nx">elem</span><span class="o">=</span><span class="kc">null</span><span class="p">)}</span><span class="nx">g</span><span class="o">?</span><span class="k">delete</span> <span class="nx">i</span><span class="p">[</span><span class="nx">f</span><span class="p">.</span><span class="nx">expando</span><span class="p">]</span><span class="o">:</span><span class="nx">i</span><span class="p">.</span><span class="nx">removeAttribute</span><span class="o">&amp;&amp;</span><span class="nx">i</span><span class="p">.</span><span class="nx">removeAttribute</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">expando</span><span class="p">),</span><span class="k">delete</span> <span class="nx">d</span><span class="p">[</span><span class="nx">c</span><span class="p">]}}}});</span><span class="kd">var</span> <span class="nx">bq</span><span class="o">=</span><span class="sr">/alpha\([^)]*\)/i</span><span class="p">,</span><span class="nx">br</span><span class="o">=</span><span class="sr">/opacity=([^)]*)/</span><span class="p">,</span><span class="nx">bs</span><span class="o">=</span><span class="sr">/([A-Z]|^ms)/g</span><span class="p">,</span><span class="nx">bt</span><span class="o">=</span><span class="sr">/^-?\d+(?:px)?$/i</span><span class="p">,</span><span class="nx">bu</span><span class="o">=</span><span class="sr">/^-?\d/</span><span class="p">,</span><span class="nx">bv</span><span class="o">=</span><span class="sr">/^([\-+])=([\-+.\de]+)/</span><span class="p">,</span><span class="nx">bw</span><span class="o">=</span><span class="p">{</span><span class="nx">position</span><span class="o">:</span><span class="s2">&quot;absolute&quot;</span><span class="p">,</span><span class="nx">visibility</span><span class="o">:</span><span class="s2">&quot;hidden&quot;</span><span class="p">,</span><span class="nx">display</span><span class="o">:</span><span class="s2">&quot;block&quot;</span><span class="p">},</span><span class="nx">bx</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Left&quot;</span><span class="p">,</span><span class="s2">&quot;Right&quot;</span><span class="p">],</span><span class="nx">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Top&quot;</span><span class="p">,</span><span class="s2">&quot;Bottom&quot;</span><span class="p">],</span><span class="nx">bz</span><span class="p">,</span><span class="nx">bA</span><span class="p">,</span><span class="nx">bB</span><span class="p">;</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">css</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="o">===</span><span class="mi">2</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="o">===</span><span class="nx">b</span><span class="p">)</span><span class="k">return</span> <span class="k">this</span><span class="p">;</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">access</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span><span class="o">!==</span><span class="nx">b</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">)</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">)})},</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">cssHooks</span><span class="o">:</span><span class="p">{</span><span class="nx">opacity</span><span class="o">:</span><span class="p">{</span><span class="nx">get</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="nx">bz</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;opacity&quot;</span><span class="p">,</span><span class="s2">&quot;opacity&quot;</span><span class="p">);</span><span class="k">return</span> <span class="nx">c</span><span class="o">===</span><span class="s2">&quot;&quot;</span><span class="o">?</span><span class="s2">&quot;1&quot;</span><span class="o">:</span><span class="nx">c</span><span class="p">}</span><span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">opacity</span><span class="p">}}},</span><span class="nx">cssNumber</span><span class="o">:</span><span class="p">{</span><span class="nx">fillOpacity</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">fontWeight</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">lineHeight</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">opacity</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">orphans</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">widows</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">zIndex</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">zoom</span><span class="o">:!</span><span class="mi">0</span><span class="p">},</span><span class="nx">cssProps</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;float&quot;</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">cssFloat</span><span class="o">?</span><span class="s2">&quot;cssFloat&quot;</span><span class="o">:</span><span class="s2">&quot;styleFloat&quot;</span><span class="p">},</span><span class="nx">style</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!!</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">!==</span><span class="mi">3</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">!==</span><span class="mi">8</span><span class="o">&amp;&amp;!!</span><span class="nx">a</span><span class="p">.</span><span class="nx">style</span><span class="p">){</span><span class="kd">var</span> <span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">camelCase</span><span class="p">(</span><span class="nx">c</span><span class="p">),</span><span class="nx">j</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">style</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">cssHooks</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span><span class="nx">c</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">cssProps</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">||</span><span class="nx">i</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="o">===</span><span class="nx">b</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">k</span><span class="o">&amp;&amp;</span><span class="s2">&quot;get&quot;</span><span class="k">in</span> <span class="nx">k</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">g</span><span class="o">=</span><span class="nx">k</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="o">!</span><span class="mi">1</span><span class="p">,</span><span class="nx">e</span><span class="p">))</span><span class="o">!==</span><span class="nx">b</span><span class="p">)</span><span class="k">return</span> <span class="nx">g</span><span class="p">;</span><span class="k">return</span> <span class="nx">j</span><span class="p">[</span><span class="nx">c</span><span class="p">]}</span><span class="nx">h</span><span class="o">=</span><span class="k">typeof</span> <span class="nx">d</span><span class="p">,</span><span class="nx">h</span><span class="o">===</span><span class="s2">&quot;string&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">g</span><span class="o">=</span><span class="nx">bv</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">d</span><span class="p">))</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">d</span><span class="o">=+</span><span class="p">(</span><span class="nx">g</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*+</span><span class="nx">g</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">)),</span><span class="nx">h</span><span class="o">=</span><span class="s2">&quot;number&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="o">==</span><span class="kc">null</span><span class="o">||</span><span class="nx">h</span><span class="o">===</span><span class="s2">&quot;number&quot;</span><span class="o">&amp;&amp;</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">d</span><span class="p">))</span><span class="k">return</span><span class="p">;</span><span class="nx">h</span><span class="o">===</span><span class="s2">&quot;number&quot;</span><span class="o">&amp;&amp;!</span><span class="nx">f</span><span class="p">.</span><span class="nx">cssNumber</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">d</span><span class="o">+=</span><span class="s2">&quot;px&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">k</span><span class="o">||!</span><span class="p">(</span><span class="s2">&quot;set&quot;</span><span class="k">in</span> <span class="nx">k</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="nx">k</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="p">))</span><span class="o">!==</span><span class="nx">b</span><span class="p">)</span><span class="k">try</span><span class="p">{</span><span class="nx">j</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">=</span><span class="nx">d</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">l</span><span class="p">){}}},</span><span class="nx">css</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="p">;</span><span class="nx">c</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">camelCase</span><span class="p">(</span><span class="nx">c</span><span class="p">),</span><span class="nx">g</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">cssHooks</span><span class="p">[</span><span class="nx">c</span><span class="p">],</span><span class="nx">c</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">cssProps</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">||</span><span class="nx">c</span><span class="p">,</span><span class="nx">c</span><span class="o">===</span><span class="s2">&quot;cssFloat&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="s2">&quot;float&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">g</span><span class="o">&amp;&amp;</span><span class="s2">&quot;get&quot;</span><span class="k">in</span> <span class="nx">g</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">,</span><span class="nx">d</span><span class="p">))</span><span class="o">!==</span><span class="nx">b</span><span class="p">)</span><span class="k">return</span> <span class="nx">e</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">bz</span><span class="p">)</span><span class="k">return</span> <span class="nx">bz</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">)},</span><span class="nx">swap</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="p">{};</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">e</span> <span class="k">in</span> <span class="nx">b</span><span class="p">)</span><span class="nx">d</span><span class="p">[</span><span class="nx">e</span><span class="p">]</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="nx">e</span><span class="p">],</span><span class="nx">a</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="nx">e</span><span class="p">]</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="nx">e</span><span class="p">];</span><span class="nx">c</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="nx">e</span> <span class="k">in</span> <span class="nx">b</span><span class="p">)</span><span class="nx">a</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="nx">e</span><span class="p">]</span><span class="o">=</span><span class="nx">d</span><span class="p">[</span><span class="nx">e</span><span class="p">]}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">curCSS</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">([</span><span class="s2">&quot;height&quot;</span><span class="p">,</span><span class="s2">&quot;width&quot;</span><span class="p">],</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">cssHooks</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="nx">get</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="o">!==</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="nx">bC</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">);</span><span class="nx">f</span><span class="p">.</span><span class="nx">swap</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">bw</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span><span class="nx">e</span><span class="o">=</span><span class="nx">bC</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">)});</span><span class="k">return</span> <span class="nx">e</span><span class="p">}},</span><span class="nx">set</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">bt</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">b</span><span class="p">))</span><span class="k">return</span> <span class="nx">b</span><span class="p">;</span><span class="nx">b</span><span class="o">=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="nx">b</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">}}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">opacity</span><span class="o">||</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">cssHooks</span><span class="p">.</span><span class="nx">opacity</span><span class="o">=</span><span class="p">{</span><span class="nx">get</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="nx">br</span><span class="p">.</span><span class="nx">test</span><span class="p">((</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">currentStyle</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">currentStyle</span><span class="p">.</span><span class="nx">filter</span><span class="o">:</span><span class="nx">a</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">filter</span><span class="p">)</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">?</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nb">RegExp</span><span class="p">.</span><span class="nx">$1</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="o">+</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="nx">b</span><span class="o">?</span><span class="s2">&quot;1&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">},</span><span class="nx">set</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">style</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">currentStyle</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">isNumeric</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;alpha(opacity=&quot;</span><span class="o">+</span><span class="nx">b</span><span class="o">*</span><span class="mi">100</span><span class="o">+</span><span class="s2">&quot;)&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">filter</span><span class="o">||</span><span class="nx">c</span><span class="p">.</span><span class="nx">filter</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="nx">c</span><span class="p">.</span><span class="nx">zoom</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="o">&gt;=</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">g</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">bq</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">))</span><span class="o">===</span><span class="s2">&quot;&quot;</span><span class="p">){</span><span class="nx">c</span><span class="p">.</span><span class="nx">removeAttribute</span><span class="p">(</span><span class="s2">&quot;filter&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="o">&amp;&amp;!</span><span class="nx">d</span><span class="p">.</span><span class="nx">filter</span><span class="p">)</span><span class="k">return</span><span class="p">}</span><span class="nx">c</span><span class="p">.</span><span class="nx">filter</span><span class="o">=</span><span class="nx">bq</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">g</span><span class="p">)</span><span class="o">?</span><span class="nx">g</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">bq</span><span class="p">,</span><span class="nx">e</span><span class="p">)</span><span class="o">:</span><span class="nx">g</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nx">e</span><span class="p">}}),</span><span class="nx">f</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">reliableMarginRight</span><span class="o">||</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">cssHooks</span><span class="p">.</span><span class="nx">marginRight</span><span class="o">=</span><span class="p">{</span><span class="nx">get</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="p">;</span><span class="nx">f</span><span class="p">.</span><span class="nx">swap</span><span class="p">(</span><span class="nx">a</span><span class="p">,{</span><span class="nx">display</span><span class="o">:</span><span class="s2">&quot;inline-block&quot;</span><span class="p">},</span><span class="kd">function</span><span class="p">(){</span><span class="nx">b</span><span class="o">?</span><span class="nx">c</span><span class="o">=</span><span class="nx">bz</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;margin-right&quot;</span><span class="p">,</span><span class="s2">&quot;marginRight&quot;</span><span class="p">)</span><span class="o">:</span><span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">marginRight</span><span class="p">});</span><span class="k">return</span> <span class="nx">c</span><span class="p">}})}),</span><span class="nx">c</span><span class="p">.</span><span class="nx">defaultView</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="p">.</span><span class="nx">defaultView</span><span class="p">.</span><span class="nx">getComputedStyle</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">bA</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">;</span><span class="nx">b</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">bs</span><span class="p">,</span><span class="s2">&quot;-$1&quot;</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">(),(</span><span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="p">.</span><span class="nx">defaultView</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="kc">null</span><span class="p">))</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">getPropertyValue</span><span class="p">(</span><span class="nx">b</span><span class="p">),</span><span class="nx">c</span><span class="o">===</span><span class="s2">&quot;&quot;</span><span class="o">&amp;&amp;!</span><span class="nx">f</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">,</span><span class="nx">a</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">)));</span><span class="k">return</span> <span class="nx">c</span><span class="p">}),</span><span class="nx">c</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">currentStyle</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">bB</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">f</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">currentStyle</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">currentStyle</span><span class="p">[</span><span class="nx">b</span><span class="p">],</span><span class="nx">g</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">style</span><span class="p">;</span><span class="nx">f</span><span class="o">===</span><span class="kc">null</span><span class="o">&amp;&amp;</span><span class="nx">g</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">g</span><span class="p">[</span><span class="nx">b</span><span class="p">])</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">f</span><span class="o">=</span><span class="nx">e</span><span class="p">),</span><span class="o">!</span><span class="nx">bt</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">bu</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">left</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">runtimeStyle</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">runtimeStyle</span><span class="p">.</span><span class="nx">left</span><span class="p">,</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">runtimeStyle</span><span class="p">.</span><span class="nx">left</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">currentStyle</span><span class="p">.</span><span class="nx">left</span><span class="p">),</span><span class="nx">g</span><span class="p">.</span><span class="nx">left</span><span class="o">=</span><span class="nx">b</span><span class="o">===</span><span class="s2">&quot;fontSize&quot;</span><span class="o">?</span><span class="s2">&quot;1em&quot;</span><span class="o">:</span><span class="nx">f</span><span class="o">||</span><span class="mi">0</span><span class="p">,</span><span class="nx">f</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">pixelLeft</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">,</span><span class="nx">g</span><span class="p">.</span><span class="nx">left</span><span class="o">=</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">runtimeStyle</span><span class="p">.</span><span class="nx">left</span><span class="o">=</span><span class="nx">d</span><span class="p">));</span><span class="k">return</span> <span class="nx">f</span><span class="o">===</span><span class="s2">&quot;&quot;</span><span class="o">?</span><span class="s2">&quot;auto&quot;</span><span class="o">:</span><span class="nx">f</span><span class="p">}),</span><span class="nx">bz</span><span class="o">=</span><span class="nx">bA</span><span class="o">||</span><span class="nx">bB</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">expr</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">expr</span><span class="p">.</span><span class="nx">filters</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">expr</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">hidden</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="p">;</span><span class="k">return</span> <span class="nx">b</span><span class="o">===</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="o">===</span><span class="mi">0</span><span class="o">||!</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">reliableHiddenOffsets</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">style</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;display&quot;</span><span class="p">))</span><span class="o">===</span><span class="s2">&quot;none&quot;</span><span class="p">},</span><span class="nx">f</span><span class="p">.</span><span class="nx">expr</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">visible</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span><span class="o">!</span><span class="nx">f</span><span class="p">.</span><span class="nx">expr</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">hidden</span><span class="p">(</span><span class="nx">a</span><span class="p">)});</span><span class="kd">var</span> <span class="nx">bD</span><span class="o">=</span><span class="sr">/%20/g</span><span class="p">,</span><span class="nx">bE</span><span class="o">=</span><span class="sr">/\[\]$/</span><span class="p">,</span><span class="nx">bF</span><span class="o">=</span><span class="sr">/\r?\n/g</span><span class="p">,</span><span class="nx">bG</span><span class="o">=</span><span class="sr">/#.*$/</span><span class="p">,</span><span class="nx">bH</span><span class="o">=</span><span class="sr">/^(.*?):[ \t]*([^\r\n]*)\r?$/mg</span><span class="p">,</span><span class="nx">bI</span><span class="o">=</span><span class="sr">/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i</span><span class="p">,</span><span class="nx">bJ</span><span class="o">=</span><span class="sr">/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/</span><span class="p">,</span><span class="nx">bK</span><span class="o">=</span><span class="sr">/^(?:GET|HEAD)$/</span><span class="p">,</span><span class="nx">bL</span><span class="o">=</span><span class="sr">/^\/\//</span><span class="p">,</span><span class="nx">bM</span><span class="o">=</span><span class="sr">/\?/</span><span class="p">,</span><span class="nx">bN</span><span class="o">=</span><span class="sr">/&lt;script\b[^&lt;]*(?:(?!&lt;\/script&gt;)&lt;[^&lt;]*)*&lt;\/script&gt;/gi</span><span class="p">,</span><span class="nx">bO</span><span class="o">=</span><span class="sr">/^(?:select|textarea)/i</span><span class="p">,</span><span class="nx">bP</span><span class="o">=</span><span class="sr">/\s+/</span><span class="p">,</span><span class="nx">bQ</span><span class="o">=</span><span class="sr">/([?&amp;])_=[^&amp;]*/</span><span class="p">,</span><span class="nx">bR</span><span class="o">=</span><span class="sr">/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/</span><span class="p">,</span><span class="nx">bS</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">load</span><span class="p">,</span><span class="nx">bT</span><span class="o">=</span><span class="p">{},</span><span class="nx">bU</span><span class="o">=</span><span class="p">{},</span><span class="nx">bV</span><span class="p">,</span><span class="nx">bW</span><span class="p">,</span><span class="nx">bX</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*/&quot;</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">];</span><span class="k">try</span><span class="p">{</span><span class="nx">bV</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">href</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">bY</span><span class="p">){</span><span class="nx">bV</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">),</span><span class="nx">bV</span><span class="p">.</span><span class="nx">href</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">bV</span><span class="o">=</span><span class="nx">bV</span><span class="p">.</span><span class="nx">href</span><span class="p">}</span><span class="nx">bW</span><span class="o">=</span><span class="nx">bR</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">bV</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">())</span><span class="o">||</span><span class="p">[],</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">load</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">!=</span><span class="s2">&quot;string&quot;</span><span class="o">&amp;&amp;</span><span class="nx">bS</span><span class="p">)</span><span class="k">return</span> <span class="nx">bS</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">arguments</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="k">return</span> <span class="k">this</span><span class="p">;</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">){</span><span class="kd">var</span> <span class="nx">g</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">e</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">;</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span><span class="o">?</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="nx">c</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="nx">b</span><span class="p">)</span><span class="o">:</span><span class="k">typeof</span> <span class="nx">c</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">param</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">ajaxSettings</span><span class="p">.</span><span class="nx">traditional</span><span class="p">),</span><span class="nx">h</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">));</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="k">this</span><span class="p">;</span><span class="nx">f</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span><span class="nx">url</span><span class="o">:</span><span class="nx">a</span><span class="p">,</span><span class="nx">type</span><span class="o">:</span><span class="nx">h</span><span class="p">,</span><span class="nx">dataType</span><span class="o">:</span><span class="s2">&quot;html&quot;</span><span class="p">,</span><span class="nx">data</span><span class="o">:</span><span class="nx">c</span><span class="p">,</span><span class="nx">complete</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">responseText</span><span class="p">,</span><span class="nx">a</span><span class="p">.</span><span class="nx">isResolved</span><span class="p">()</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">}),</span><span class="nx">i</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">g</span><span class="o">?</span><span class="nx">f</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">bN</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)).</span><span class="nx">find</span><span class="p">(</span><span class="nx">g</span><span class="p">)</span><span class="o">:</span><span class="nx">c</span><span class="p">)),</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="nx">i</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">d</span><span class="p">,[</span><span class="nx">c</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">a</span><span class="p">])}});</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">serialize</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">param</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">serializeArray</span><span class="p">())},</span><span class="nx">serializeArray</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">elements</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">makeArray</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">elements</span><span class="p">)</span><span class="o">:</span><span class="k">this</span><span class="p">}).</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="o">&amp;&amp;!</span><span class="k">this</span><span class="p">.</span><span class="nx">disabled</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">checked</span><span class="o">||</span><span class="nx">bO</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">)</span><span class="o">||</span><span class="nx">bI</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">type</span><span class="p">))}).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span><span class="k">return</span> <span class="nx">c</span><span class="o">==</span><span class="kc">null</span><span class="o">?</span><span class="kc">null</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">return</span><span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="nx">b</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span><span class="nx">value</span><span class="o">:</span><span class="nx">a</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">bF</span><span class="p">,</span><span class="s2">&quot;\r\n&quot;</span><span class="p">)}})</span><span class="o">:</span><span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="nx">b</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span><span class="nx">value</span><span class="o">:</span><span class="nx">c</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">bF</span><span class="p">,</span><span class="s2">&quot;\r\n&quot;</span><span class="p">)}}).</span><span class="nx">get</span><span class="p">()}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="s2">&quot;ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend&quot;</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">a</span><span class="p">)}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">([</span><span class="s2">&quot;get&quot;</span><span class="p">,</span><span class="s2">&quot;post&quot;</span><span class="p">],</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="nx">f</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">g</span><span class="o">=</span><span class="nx">g</span><span class="o">||</span><span class="nx">e</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">d</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="p">);</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span><span class="nx">type</span><span class="o">:</span><span class="nx">c</span><span class="p">,</span><span class="nx">url</span><span class="o">:</span><span class="nx">a</span><span class="p">,</span><span class="nx">data</span><span class="o">:</span><span class="nx">d</span><span class="p">,</span><span class="nx">success</span><span class="o">:</span><span class="nx">e</span><span class="p">,</span><span class="nx">dataType</span><span class="o">:</span><span class="nx">g</span><span class="p">})}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">getScript</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="s2">&quot;script&quot;</span><span class="p">)},</span><span class="nx">getJSON</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="s2">&quot;json&quot;</span><span class="p">)},</span><span class="nx">ajaxSetup</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">b</span><span class="o">?</span><span class="nx">b_</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">ajaxSettings</span><span class="p">)</span><span class="o">:</span><span class="p">(</span><span class="nx">b</span><span class="o">=</span><span class="nx">a</span><span class="p">,</span><span class="nx">a</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">ajaxSettings</span><span class="p">),</span><span class="nx">b_</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">);</span><span class="k">return</span> <span class="nx">a</span><span class="p">},</span><span class="nx">ajaxSettings</span><span class="o">:</span><span class="p">{</span><span class="nx">url</span><span class="o">:</span><span class="nx">bV</span><span class="p">,</span><span class="nx">isLocal</span><span class="o">:</span><span class="nx">bJ</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">bW</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nx">global</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">type</span><span class="o">:</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span><span class="nx">contentType</span><span class="o">:</span><span class="s2">&quot;application/x-www-form-urlencoded&quot;</span><span class="p">,</span><span class="nx">processData</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">async</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">accepts</span><span class="o">:</span><span class="p">{</span><span class="nx">xml</span><span class="o">:</span><span class="s2">&quot;application/xml, text/xml&quot;</span><span class="p">,</span><span class="nx">html</span><span class="o">:</span><span class="s2">&quot;text/html&quot;</span><span class="p">,</span><span class="nx">text</span><span class="o">:</span><span class="s2">&quot;text/plain&quot;</span><span class="p">,</span><span class="nx">json</span><span class="o">:</span><span class="s2">&quot;application/json, text/javascript&quot;</span><span class="p">,</span><span class="s2">&quot;*&quot;</span><span class="o">:</span><span class="nx">bX</span><span class="p">},</span><span class="nx">contents</span><span class="o">:</span><span class="p">{</span><span class="nx">xml</span><span class="o">:</span><span class="sr">/xml/</span><span class="p">,</span><span class="nx">html</span><span class="o">:</span><span class="sr">/html/</span><span class="p">,</span><span class="nx">json</span><span class="o">:</span><span class="sr">/json/</span><span class="p">},</span><span class="nx">responseFields</span><span class="o">:</span><span class="p">{</span><span class="nx">xml</span><span class="o">:</span><span class="s2">&quot;responseXML&quot;</span><span class="p">,</span><span class="nx">text</span><span class="o">:</span><span class="s2">&quot;responseText&quot;</span><span class="p">},</span><span class="nx">converters</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;* text&quot;</span><span class="o">:</span><span class="nx">a</span><span class="p">.</span><span class="nb">String</span><span class="p">,</span><span class="s2">&quot;text html&quot;</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;text json&quot;</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">parseJSON</span><span class="p">,</span><span class="s2">&quot;text xml&quot;</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">parseXML</span><span class="p">},</span><span class="nx">flatOptions</span><span class="o">:</span><span class="p">{</span><span class="nx">context</span><span class="o">:!</span><span class="mi">0</span><span class="p">,</span><span class="nx">url</span><span class="o">:!</span><span class="mi">0</span><span class="p">}},</span><span class="nx">ajaxPrefilter</span><span class="o">:</span><span class="nx">bZ</span><span class="p">(</span><span class="nx">bT</span><span class="p">),</span><span class="nx">ajaxTransport</span><span class="o">:</span><span class="nx">bZ</span><span class="p">(</span><span class="nx">bU</span><span class="p">),</span><span class="nx">ajax</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">function</span> <span class="nx">w</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">l</span><span class="p">,</span><span class="nx">m</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">s</span><span class="o">!==</span><span class="mi">2</span><span class="p">){</span><span class="nx">s</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="nx">q</span><span class="o">&amp;&amp;</span><span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">q</span><span class="p">),</span><span class="nx">p</span><span class="o">=</span><span class="nx">b</span><span class="p">,</span><span class="nx">n</span><span class="o">=</span><span class="nx">m</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">v</span><span class="p">.</span><span class="nx">readyState</span><span class="o">=</span><span class="nx">a</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">?</span><span class="mi">4</span><span class="o">:</span><span class="mi">0</span><span class="p">;</span><span class="kd">var</span> <span class="nx">o</span><span class="p">,</span><span class="nx">r</span><span class="p">,</span><span class="nx">u</span><span class="p">,</span><span class="nx">w</span><span class="o">=</span><span class="nx">c</span><span class="p">,</span><span class="nx">x</span><span class="o">=</span><span class="nx">l</span><span class="o">?</span><span class="nx">cb</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">v</span><span class="p">,</span><span class="nx">l</span><span class="p">)</span><span class="o">:</span><span class="nx">b</span><span class="p">,</span><span class="nx">y</span><span class="p">,</span><span class="nx">z</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">&gt;=</span><span class="mi">200</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="o">&lt;</span><span class="mi">300</span><span class="o">||</span><span class="nx">a</span><span class="o">===</span><span class="mi">304</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">ifModified</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">y</span><span class="o">=</span><span class="nx">v</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">(</span><span class="s2">&quot;Last-Modified&quot;</span><span class="p">))</span><span class="nx">f</span><span class="p">.</span><span class="nx">lastModified</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span><span class="o">=</span><span class="nx">y</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">z</span><span class="o">=</span><span class="nx">v</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">(</span><span class="s2">&quot;Etag&quot;</span><span class="p">))</span><span class="nx">f</span><span class="p">.</span><span class="nx">etag</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span><span class="o">=</span><span class="nx">z</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">===</span><span class="mi">304</span><span class="p">)</span><span class="nx">w</span><span class="o">=</span><span class="s2">&quot;notmodified&quot;</span><span class="p">,</span><span class="nx">o</span><span class="o">=!</span><span class="mi">0</span><span class="p">;</span><span class="k">else</span> <span class="k">try</span><span class="p">{</span><span class="nx">r</span><span class="o">=</span><span class="nx">cc</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">),</span><span class="nx">w</span><span class="o">=</span><span class="s2">&quot;success&quot;</span><span class="p">,</span><span class="nx">o</span><span class="o">=!</span><span class="mi">0</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">A</span><span class="p">){</span><span class="nx">w</span><span class="o">=</span><span class="s2">&quot;parsererror&quot;</span><span class="p">,</span><span class="nx">u</span><span class="o">=</span><span class="nx">A</span><span class="p">}}</span><span class="k">else</span><span class="p">{</span><span class="nx">u</span><span class="o">=</span><span class="nx">w</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">w</span><span class="o">||</span><span class="nx">a</span><span class="p">)</span><span class="nx">w</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">,</span><span class="nx">a</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="o">=</span><span class="mi">0</span><span class="p">)}</span><span class="nx">v</span><span class="p">.</span><span class="nx">status</span><span class="o">=</span><span class="nx">a</span><span class="p">,</span><span class="nx">v</span><span class="p">.</span><span class="nx">statusText</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="o">+</span><span class="p">(</span><span class="nx">c</span><span class="o">||</span><span class="nx">w</span><span class="p">),</span><span class="nx">o</span><span class="o">?</span><span class="nx">h</span><span class="p">.</span><span class="nx">resolveWith</span><span class="p">(</span><span class="nx">e</span><span class="p">,[</span><span class="nx">r</span><span class="p">,</span><span class="nx">w</span><span class="p">,</span><span class="nx">v</span><span class="p">])</span><span class="o">:</span><span class="nx">h</span><span class="p">.</span><span class="nx">rejectWith</span><span class="p">(</span><span class="nx">e</span><span class="p">,[</span><span class="nx">v</span><span class="p">,</span><span class="nx">w</span><span class="p">,</span><span class="nx">u</span><span class="p">]),</span><span class="nx">v</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">(</span><span class="nx">j</span><span class="p">),</span><span class="nx">j</span><span class="o">=</span><span class="nx">b</span><span class="p">,</span><span class="nx">t</span><span class="o">&amp;&amp;</span><span class="nx">g</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;ajax&quot;</span><span class="o">+</span><span class="p">(</span><span class="nx">o</span><span class="o">?</span><span class="s2">&quot;Success&quot;</span><span class="o">:</span><span class="s2">&quot;Error&quot;</span><span class="p">),[</span><span class="nx">v</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">o</span><span class="o">?</span><span class="nx">r</span><span class="o">:</span><span class="nx">u</span><span class="p">]),</span><span class="nx">i</span><span class="p">.</span><span class="nx">fireWith</span><span class="p">(</span><span class="nx">e</span><span class="p">,[</span><span class="nx">v</span><span class="p">,</span><span class="nx">w</span><span class="p">]),</span><span class="nx">t</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">g</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;ajaxComplete&quot;</span><span class="p">,[</span><span class="nx">v</span><span class="p">,</span><span class="nx">d</span><span class="p">]),</span><span class="o">--</span><span class="nx">f</span><span class="p">.</span><span class="nx">active</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;ajaxStop&quot;</span><span class="p">))}}</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">,</span><span class="nx">a</span><span class="o">=</span><span class="nx">b</span><span class="p">),</span><span class="nx">c</span><span class="o">=</span><span class="nx">c</span><span class="o">||</span><span class="p">{};</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">ajaxSetup</span><span class="p">({},</span><span class="nx">c</span><span class="p">),</span><span class="nx">e</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">context</span><span class="o">||</span><span class="nx">d</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">e</span><span class="o">!==</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">||</span><span class="nx">e</span> <span class="k">instanceof</span> <span class="nx">f</span><span class="p">)</span><span class="o">?</span><span class="nx">f</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">Deferred</span><span class="p">(),</span><span class="nx">i</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">Callbacks</span><span class="p">(</span><span class="s2">&quot;once memory&quot;</span><span class="p">),</span><span class="nx">j</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">statusCode</span><span class="o">||</span><span class="p">{},</span><span class="nx">k</span><span class="p">,</span><span class="nx">l</span><span class="o">=</span><span class="p">{},</span><span class="nx">m</span><span class="o">=</span><span class="p">{},</span><span class="nx">n</span><span class="p">,</span><span class="nx">o</span><span class="p">,</span><span class="nx">p</span><span class="p">,</span><span class="nx">q</span><span class="p">,</span><span class="nx">r</span><span class="p">,</span><span class="nx">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">t</span><span class="p">,</span><span class="nx">u</span><span class="p">,</span><span class="nx">v</span><span class="o">=</span><span class="p">{</span><span class="nx">readyState</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">setRequestHeader</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">s</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="nx">a</span><span class="o">=</span><span class="nx">m</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">=</span><span class="nx">m</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">||</span><span class="nx">a</span><span class="p">,</span><span class="nx">l</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span><span class="o">=</span><span class="nx">b</span><span class="p">}</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">getAllResponseHeaders</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">s</span><span class="o">===</span><span class="mi">2</span><span class="o">?</span><span class="nx">n</span><span class="o">:</span><span class="kc">null</span><span class="p">},</span><span class="nx">getResponseHeader</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">s</span><span class="o">===</span><span class="mi">2</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">o</span><span class="p">){</span><span class="nx">o</span><span class="o">=</span><span class="p">{};</span><span class="k">while</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="nx">bH</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">n</span><span class="p">))</span><span class="nx">o</span><span class="p">[</span><span class="nx">c</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">toLowerCase</span><span class="p">()]</span><span class="o">=</span><span class="nx">c</span><span class="p">[</span><span class="mi">2</span><span class="p">]}</span><span class="nx">c</span><span class="o">=</span><span class="nx">o</span><span class="p">[</span><span class="nx">a</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()]}</span><span class="k">return</span> <span class="nx">c</span><span class="o">===</span><span class="nx">b</span><span class="o">?</span><span class="kc">null</span><span class="o">:</span><span class="nx">c</span><span class="p">},</span><span class="nx">overrideMimeType</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">s</span><span class="o">||</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">mimeType</span><span class="o">=</span><span class="nx">a</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">abort</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="o">||</span><span class="s2">&quot;abort&quot;</span><span class="p">,</span><span class="nx">p</span><span class="o">&amp;&amp;</span><span class="nx">p</span><span class="p">.</span><span class="nx">abort</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span><span class="nx">w</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">a</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">}};</span><span class="nx">h</span><span class="p">.</span><span class="nx">promise</span><span class="p">(</span><span class="nx">v</span><span class="p">),</span><span class="nx">v</span><span class="p">.</span><span class="nx">success</span><span class="o">=</span><span class="nx">v</span><span class="p">.</span><span class="nx">done</span><span class="p">,</span><span class="nx">v</span><span class="p">.</span><span class="nx">error</span><span class="o">=</span><span class="nx">v</span><span class="p">.</span><span class="nx">fail</span><span class="p">,</span><span class="nx">v</span><span class="p">.</span><span class="nx">complete</span><span class="o">=</span><span class="nx">i</span><span class="p">.</span><span class="nx">add</span><span class="p">,</span><span class="nx">v</span><span class="p">.</span><span class="nx">statusCode</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">s</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="nx">b</span> <span class="k">in</span> <span class="nx">a</span><span class="p">)</span><span class="nx">j</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="nx">j</span><span class="p">[</span><span class="nx">b</span><span class="p">],</span><span class="nx">a</span><span class="p">[</span><span class="nx">b</span><span class="p">]];</span><span class="k">else</span> <span class="nx">b</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">v</span><span class="p">.</span><span class="nx">status</span><span class="p">],</span><span class="nx">v</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">b</span><span class="p">)}</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">d</span><span class="p">.</span><span class="nx">url</span><span class="o">=</span><span class="p">((</span><span class="nx">a</span><span class="o">||</span><span class="nx">d</span><span class="p">.</span><span class="nx">url</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">bG</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">bL</span><span class="p">,</span><span class="nx">bW</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;//&quot;</span><span class="p">),</span><span class="nx">d</span><span class="p">.</span><span class="nx">dataTypes</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">dataType</span><span class="o">||</span><span class="s2">&quot;*&quot;</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">split</span><span class="p">(</span><span class="nx">bP</span><span class="p">),</span><span class="nx">d</span><span class="p">.</span><span class="nx">crossDomain</span><span class="o">==</span><span class="kc">null</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">r</span><span class="o">=</span><span class="nx">bR</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()),</span><span class="nx">d</span><span class="p">.</span><span class="nx">crossDomain</span><span class="o">=!</span><span class="p">(</span><span class="o">!</span><span class="nx">r</span><span class="o">||</span><span class="nx">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="nx">bW</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="nx">bW</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">r</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">||</span><span class="p">(</span><span class="nx">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">===</span><span class="s2">&quot;http:&quot;</span><span class="o">?</span><span class="mi">80</span><span class="o">:</span><span class="mi">443</span><span class="p">))</span><span class="o">==</span><span class="p">(</span><span class="nx">bW</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">||</span><span class="p">(</span><span class="nx">bW</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">===</span><span class="s2">&quot;http:&quot;</span><span class="o">?</span><span class="mi">80</span><span class="o">:</span><span class="mi">443</span><span class="p">)))),</span><span class="nx">d</span><span class="p">.</span><span class="nx">data</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">processData</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">d</span><span class="p">.</span><span class="nx">data</span><span class="o">!=</span><span class="s2">&quot;string&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">data</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">param</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">traditional</span><span class="p">)),</span><span class="nx">b$</span><span class="p">(</span><span class="nx">bT</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">v</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">s</span><span class="o">===</span><span class="mi">2</span><span class="p">)</span><span class="k">return</span><span class="o">!</span><span class="mi">1</span><span class="p">;</span><span class="nx">t</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">global</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">type</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">(),</span><span class="nx">d</span><span class="p">.</span><span class="nx">hasContent</span><span class="o">=!</span><span class="nx">bK</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">type</span><span class="p">),</span><span class="nx">t</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">active</span><span class="o">++===</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;ajaxStart&quot;</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">d</span><span class="p">.</span><span class="nx">hasContent</span><span class="p">){</span><span class="nx">d</span><span class="p">.</span><span class="nx">data</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">url</span><span class="o">+=</span><span class="p">(</span><span class="nx">bM</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">url</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;&amp;&quot;</span><span class="o">:</span><span class="s2">&quot;?&quot;</span><span class="p">)</span><span class="o">+</span><span class="nx">d</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span><span class="k">delete</span> <span class="nx">d</span><span class="p">.</span><span class="nx">data</span><span class="p">),</span><span class="nx">k</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">url</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">cache</span><span class="o">===!</span><span class="mi">1</span><span class="p">){</span><span class="kd">var</span> <span class="nx">x</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span><span class="nx">y</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">bQ</span><span class="p">,</span><span class="s2">&quot;$1_=&quot;</span><span class="o">+</span><span class="nx">x</span><span class="p">);</span><span class="nx">d</span><span class="p">.</span><span class="nx">url</span><span class="o">=</span><span class="nx">y</span><span class="o">+</span><span class="p">(</span><span class="nx">y</span><span class="o">===</span><span class="nx">d</span><span class="p">.</span><span class="nx">url</span><span class="o">?</span><span class="p">(</span><span class="nx">bM</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">url</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;&amp;&quot;</span><span class="o">:</span><span class="s2">&quot;?&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_=&quot;</span><span class="o">+</span><span class="nx">x</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)}}(</span><span class="nx">d</span><span class="p">.</span><span class="nx">data</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">hasContent</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">contentType</span><span class="o">!==!</span><span class="mi">1</span><span class="o">||</span><span class="nx">c</span><span class="p">.</span><span class="nx">contentType</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">v</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">contentType</span><span class="p">),</span><span class="nx">d</span><span class="p">.</span><span class="nx">ifModified</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">k</span><span class="o">=</span><span class="nx">k</span><span class="o">||</span><span class="nx">d</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">lastModified</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">v</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="s2">&quot;If-Modified-Since&quot;</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">lastModified</span><span class="p">[</span><span class="nx">k</span><span class="p">]),</span><span class="nx">f</span><span class="p">.</span><span class="nx">etag</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">v</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="s2">&quot;If-None-Match&quot;</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">etag</span><span class="p">[</span><span class="nx">k</span><span class="p">])),</span><span class="nx">v</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="s2">&quot;Accept&quot;</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">dataTypes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">accepts</span><span class="p">[</span><span class="nx">d</span><span class="p">.</span><span class="nx">dataTypes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">?</span><span class="nx">d</span><span class="p">.</span><span class="nx">accepts</span><span class="p">[</span><span class="nx">d</span><span class="p">.</span><span class="nx">dataTypes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">dataTypes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!==</span><span class="s2">&quot;*&quot;</span><span class="o">?</span><span class="s2">&quot;, &quot;</span><span class="o">+</span><span class="nx">bX</span><span class="o">+</span><span class="s2">&quot;; q=0.01&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">:</span><span class="nx">d</span><span class="p">.</span><span class="nx">accepts</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">]);</span><span class="k">for</span><span class="p">(</span><span class="nx">u</span> <span class="k">in</span> <span class="nx">d</span><span class="p">.</span><span class="nx">headers</span><span class="p">)</span><span class="nx">v</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="nx">u</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="nx">u</span><span class="p">]);</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">beforeSend</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">beforeSend</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="nx">v</span><span class="p">,</span><span class="nx">d</span><span class="p">)</span><span class="o">===!</span><span class="mi">1</span><span class="o">||</span><span class="nx">s</span><span class="o">===</span><span class="mi">2</span><span class="p">)){</span><span class="nx">v</span><span class="p">.</span><span class="nx">abort</span><span class="p">();</span><span class="k">return</span><span class="o">!</span><span class="mi">1</span><span class="p">}</span><span class="k">for</span><span class="p">(</span><span class="nx">u</span> <span class="k">in</span><span class="p">{</span><span class="nx">success</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">error</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="nx">complete</span><span class="o">:</span><span class="mi">1</span><span class="p">})</span><span class="nx">v</span><span class="p">[</span><span class="nx">u</span><span class="p">](</span><span class="nx">d</span><span class="p">[</span><span class="nx">u</span><span class="p">]);</span><span class="nx">p</span><span class="o">=</span><span class="nx">b$</span><span class="p">(</span><span class="nx">bU</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">v</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">p</span><span class="p">)</span><span class="nx">w</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;No Transport&quot;</span><span class="p">);</span><span class="k">else</span><span class="p">{</span><span class="nx">v</span><span class="p">.</span><span class="nx">readyState</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nx">t</span><span class="o">&amp;&amp;</span><span class="nx">g</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;ajaxSend&quot;</span><span class="p">,[</span><span class="nx">v</span><span class="p">,</span><span class="nx">d</span><span class="p">]),</span><span class="nx">d</span><span class="p">.</span><span class="nx">async</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">timeout</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">q</span><span class="o">=</span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">v</span><span class="p">.</span><span class="nx">abort</span><span class="p">(</span><span class="s2">&quot;timeout&quot;</span><span class="p">)},</span><span class="nx">d</span><span class="p">.</span><span class="nx">timeout</span><span class="p">));</span><span class="k">try</span><span class="p">{</span><span class="nx">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nx">p</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">l</span><span class="p">,</span><span class="nx">w</span><span class="p">)}</span><span class="k">catch</span><span class="p">(</span><span class="nx">z</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">s</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">)</span><span class="nx">w</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nx">z</span><span class="p">);</span><span class="k">else</span> <span class="k">throw</span> <span class="nx">z</span><span class="p">}}</span><span class="k">return</span> <span class="nx">v</span><span class="p">},</span><span class="nx">param</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="p">[],</span><span class="nx">e</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">b</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="o">?</span><span class="nx">b</span><span class="p">()</span><span class="o">:</span><span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">[</span><span class="nx">d</span><span class="p">.</span><span class="nx">length</span><span class="p">]</span><span class="o">=</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;=&quot;</span><span class="o">+</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">b</span><span class="p">)};</span><span class="nx">c</span><span class="o">===</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">ajaxSettings</span><span class="p">.</span><span class="nx">traditional</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">||</span><span class="nx">a</span><span class="p">.</span><span class="nx">jquery</span><span class="o">&amp;&amp;!</span><span class="nx">f</span><span class="p">.</span><span class="nx">isPlainObject</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span><span class="nx">e</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">)});</span><span class="k">else</span> <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">g</span> <span class="k">in</span> <span class="nx">a</span><span class="p">)</span><span class="nx">ca</span><span class="p">(</span><span class="nx">g</span><span class="p">,</span><span class="nx">a</span><span class="p">[</span><span class="nx">g</span><span class="p">],</span><span class="nx">c</span><span class="p">,</span><span class="nx">e</span><span class="p">);</span><span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">bD</span><span class="p">,</span><span class="s2">&quot;+&quot;</span><span class="p">)}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">active</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">lastModified</span><span class="o">:</span><span class="p">{},</span><span class="nx">etag</span><span class="o">:</span><span class="p">{}});</span><span class="kd">var</span> <span class="nx">cd</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span><span class="nx">ce</span><span class="o">=</span><span class="sr">/(\=)\?(&amp;|$)|\?\?/i</span><span class="p">;</span><span class="nx">f</span><span class="p">.</span><span class="nx">ajaxSetup</span><span class="p">({</span><span class="nx">jsonp</span><span class="o">:</span><span class="s2">&quot;callback&quot;</span><span class="p">,</span><span class="nx">jsonpCallback</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">expando</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="nx">cd</span><span class="o">++</span><span class="p">}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">ajaxPrefilter</span><span class="p">(</span><span class="s2">&quot;json jsonp&quot;</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">contentType</span><span class="o">===</span><span class="s2">&quot;application/x-www-form-urlencoded&quot;</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">b</span><span class="p">.</span><span class="nx">data</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">dataTypes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">===</span><span class="s2">&quot;jsonp&quot;</span><span class="o">||</span><span class="nx">b</span><span class="p">.</span><span class="nx">jsonp</span><span class="o">!==!</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">ce</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">url</span><span class="p">)</span><span class="o">||</span><span class="nx">e</span><span class="o">&amp;&amp;</span><span class="nx">ce</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">data</span><span class="p">))){</span><span class="kd">var</span> <span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">jsonpCallback</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">jsonpCallback</span><span class="p">)</span><span class="o">?</span><span class="nx">b</span><span class="p">.</span><span class="nx">jsonpCallback</span><span class="p">()</span><span class="o">:</span><span class="nx">b</span><span class="p">.</span><span class="nx">jsonpCallback</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">h</span><span class="p">],</span><span class="nx">j</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span><span class="nx">l</span><span class="o">=</span><span class="s2">&quot;$1&quot;</span><span class="o">+</span><span class="nx">h</span><span class="o">+</span><span class="s2">&quot;$2&quot;</span><span class="p">;</span><span class="nx">b</span><span class="p">.</span><span class="nx">jsonp</span><span class="o">!==!</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">j</span><span class="o">=</span><span class="nx">j</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">ce</span><span class="p">,</span><span class="nx">l</span><span class="p">),</span><span class="nx">b</span><span class="p">.</span><span class="nx">url</span><span class="o">===</span><span class="nx">j</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">k</span><span class="o">=</span><span class="nx">k</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">ce</span><span class="p">,</span><span class="nx">l</span><span class="p">)),</span><span class="nx">b</span><span class="p">.</span><span class="nx">data</span><span class="o">===</span><span class="nx">k</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">j</span><span class="o">+=</span><span class="p">(</span><span class="sr">/\?/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">j</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;&amp;&quot;</span><span class="o">:</span><span class="s2">&quot;?&quot;</span><span class="p">)</span><span class="o">+</span><span class="nx">b</span><span class="p">.</span><span class="nx">jsonp</span><span class="o">+</span><span class="s2">&quot;=&quot;</span><span class="o">+</span><span class="nx">h</span><span class="p">))),</span><span class="nx">b</span><span class="p">.</span><span class="nx">url</span><span class="o">=</span><span class="nx">j</span><span class="p">,</span><span class="nx">b</span><span class="p">.</span><span class="nx">data</span><span class="o">=</span><span class="nx">k</span><span class="p">,</span><span class="nx">a</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">g</span><span class="o">=</span><span class="p">[</span><span class="nx">a</span><span class="p">]},</span><span class="nx">d</span><span class="p">.</span><span class="nx">always</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">a</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span><span class="o">=</span><span class="nx">i</span><span class="p">,</span><span class="nx">g</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">[</span><span class="nx">h</span><span class="p">](</span><span class="nx">g</span><span class="p">[</span><span class="mi">0</span><span class="p">])}),</span><span class="nx">b</span><span class="p">.</span><span class="nx">converters</span><span class="p">[</span><span class="s2">&quot;script json&quot;</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="nx">g</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">h</span><span class="o">+</span><span class="s2">&quot; was not called&quot;</span><span class="p">);</span><span class="k">return</span> <span class="nx">g</span><span class="p">[</span><span class="mi">0</span><span class="p">]},</span><span class="nx">b</span><span class="p">.</span><span class="nx">dataTypes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">;</span><span class="k">return</span><span class="s2">&quot;script&quot;</span><span class="p">}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">ajaxSetup</span><span class="p">({</span><span class="nx">accepts</span><span class="o">:</span><span class="p">{</span><span class="nx">script</span><span class="o">:</span><span class="s2">&quot;text/javascript, application/javascript, application/ecmascript, application/x-ecmascript&quot;</span><span class="p">},</span><span class="nx">contents</span><span class="o">:</span><span class="p">{</span><span class="nx">script</span><span class="o">:</span><span class="sr">/javascript|ecmascript/</span><span class="p">},</span><span class="nx">converters</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;text script&quot;</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">globalEval</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="k">return</span> <span class="nx">a</span><span class="p">}}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">ajaxPrefilter</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">a</span><span class="p">.</span><span class="nx">cache</span><span class="o">===</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">cache</span><span class="o">=!</span><span class="mi">1</span><span class="p">),</span><span class="nx">a</span><span class="p">.</span><span class="nx">crossDomain</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span><span class="nx">a</span><span class="p">.</span><span class="nx">global</span><span class="o">=!</span><span class="mi">1</span><span class="p">)}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">ajaxTransport</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">crossDomain</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">head</span><span class="o">||</span><span class="nx">c</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;head&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">||</span><span class="nx">c</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">;</span><span class="k">return</span><span class="p">{</span><span class="nx">send</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span><span class="nx">g</span><span class="p">){</span><span class="nx">d</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">),</span><span class="nx">d</span><span class="p">.</span><span class="nx">async</span><span class="o">=</span><span class="s2">&quot;async&quot;</span><span class="p">,</span><span class="nx">a</span><span class="p">.</span><span class="nx">scriptCharset</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">charset</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">scriptCharset</span><span class="p">),</span><span class="nx">d</span><span class="p">.</span><span class="nx">src</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">onload</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">onreadystatechange</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="o">||!</span><span class="nx">d</span><span class="p">.</span><span class="nx">readyState</span><span class="o">||</span><span class="sr">/loaded|complete/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">readyState</span><span class="p">))</span><span class="nx">d</span><span class="p">.</span><span class="nx">onload</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">onreadystatechange</span><span class="o">=</span><span class="kc">null</span><span class="p">,</span><span class="nx">e</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">parentNode</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">d</span><span class="p">),</span><span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="o">||</span><span class="nx">g</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="s2">&quot;success&quot;</span><span class="p">)},</span><span class="nx">e</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">)},</span><span class="nx">abort</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">onload</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)}}}});</span><span class="kd">var</span> <span class="nx">cf</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">ActiveXObject</span><span class="o">?</span><span class="kd">function</span><span class="p">(){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">a</span> <span class="k">in</span> <span class="nx">ch</span><span class="p">)</span><span class="nx">ch</span><span class="p">[</span><span class="nx">a</span><span class="p">](</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)}</span><span class="o">:!</span><span class="mi">1</span><span class="p">,</span><span class="nx">cg</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">ch</span><span class="p">;</span><span class="nx">f</span><span class="p">.</span><span class="nx">ajaxSettings</span><span class="p">.</span><span class="nx">xhr</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">ActiveXObject</span><span class="o">?</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isLocal</span><span class="o">&amp;&amp;</span><span class="nx">ci</span><span class="p">()</span><span class="o">||</span><span class="nx">cj</span><span class="p">()}</span><span class="o">:</span><span class="nx">ci</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">,{</span><span class="nx">ajax</span><span class="o">:!!</span><span class="nx">a</span><span class="p">,</span><span class="nx">cors</span><span class="o">:!!</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="s2">&quot;withCredentials&quot;</span><span class="k">in</span> <span class="nx">a</span><span class="p">})}(</span><span class="nx">f</span><span class="p">.</span><span class="nx">ajaxSettings</span><span class="p">.</span><span class="nx">xhr</span><span class="p">()),</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">ajax</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">ajaxTransport</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">c</span><span class="p">.</span><span class="nx">crossDomain</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">cors</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="p">;</span><span class="k">return</span><span class="p">{</span><span class="nx">send</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="p">){</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">xhr</span><span class="p">(),</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">;</span><span class="nx">c</span><span class="p">.</span><span class="nx">username</span><span class="o">?</span><span class="nx">h</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span><span class="nx">c</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span><span class="nx">c</span><span class="p">.</span><span class="nx">async</span><span class="p">,</span><span class="nx">c</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span><span class="nx">c</span><span class="p">.</span><span class="nx">password</span><span class="p">)</span><span class="o">:</span><span class="nx">h</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span><span class="nx">c</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span><span class="nx">c</span><span class="p">.</span><span class="nx">async</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">xhrFields</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="nx">j</span> <span class="k">in</span> <span class="nx">c</span><span class="p">.</span><span class="nx">xhrFields</span><span class="p">)</span><span class="nx">h</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">xhrFields</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span><span class="nx">c</span><span class="p">.</span><span class="nx">mimeType</span><span class="o">&amp;&amp;</span><span class="nx">h</span><span class="p">.</span><span class="nx">overrideMimeType</span><span class="o">&amp;&amp;</span><span class="nx">h</span><span class="p">.</span><span class="nx">overrideMimeType</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">mimeType</span><span class="p">),</span><span class="o">!</span><span class="nx">c</span><span class="p">.</span><span class="nx">crossDomain</span><span class="o">&amp;&amp;!</span><span class="nx">e</span><span class="p">[</span><span class="s2">&quot;X-Requested-With&quot;</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="p">[</span><span class="s2">&quot;X-Requested-With&quot;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;XMLHttpRequest&quot;</span><span class="p">);</span><span class="k">try</span><span class="p">{</span><span class="k">for</span><span class="p">(</span><span class="nx">j</span> <span class="k">in</span> <span class="nx">e</span><span class="p">)</span><span class="nx">h</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="nx">j</span><span class="p">,</span><span class="nx">e</span><span class="p">[</span><span class="nx">j</span><span class="p">])}</span><span class="k">catch</span><span class="p">(</span><span class="nx">k</span><span class="p">){}</span><span class="nx">h</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">hasContent</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="p">.</span><span class="nx">data</span><span class="o">||</span><span class="kc">null</span><span class="p">),</span><span class="nx">d</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">e</span><span class="p">){</span><span class="kd">var</span> <span class="nx">j</span><span class="p">,</span><span class="nx">k</span><span class="p">,</span><span class="nx">l</span><span class="p">,</span><span class="nx">m</span><span class="p">,</span><span class="nx">n</span><span class="p">;</span><span class="k">try</span><span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="o">||</span><span class="nx">h</span><span class="p">.</span><span class="nx">readyState</span><span class="o">===</span><span class="mi">4</span><span class="p">)){</span><span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="p">,</span><span class="nx">i</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">h</span><span class="p">.</span><span class="nx">onreadystatechange</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">noop</span><span class="p">,</span><span class="nx">cf</span><span class="o">&amp;&amp;</span><span class="k">delete</span> <span class="nx">ch</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="nx">h</span><span class="p">.</span><span class="nx">readyState</span><span class="o">!==</span><span class="mi">4</span><span class="o">&amp;&amp;</span><span class="nx">h</span><span class="p">.</span><span class="nx">abort</span><span class="p">();</span><span class="k">else</span><span class="p">{</span><span class="nx">j</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">status</span><span class="p">,</span><span class="nx">l</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">getAllResponseHeaders</span><span class="p">(),</span><span class="nx">m</span><span class="o">=</span><span class="p">{},</span><span class="nx">n</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">responseXML</span><span class="p">,</span><span class="nx">n</span><span class="o">&amp;&amp;</span><span class="nx">n</span><span class="p">.</span><span class="nx">documentElement</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">xml</span><span class="o">=</span><span class="nx">n</span><span class="p">),</span><span class="nx">m</span><span class="p">.</span><span class="nx">text</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span><span class="k">try</span><span class="p">{</span><span class="nx">k</span><span class="o">=</span><span class="nx">h</span><span class="p">.</span><span class="nx">statusText</span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">o</span><span class="p">){</span><span class="nx">k</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">}</span><span class="o">!</span><span class="nx">j</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="p">.</span><span class="nx">isLocal</span><span class="o">&amp;&amp;!</span><span class="nx">c</span><span class="p">.</span><span class="nx">crossDomain</span><span class="o">?</span><span class="nx">j</span><span class="o">=</span><span class="nx">m</span><span class="p">.</span><span class="nx">text</span><span class="o">?</span><span class="mi">200</span><span class="o">:</span><span class="mi">404</span><span class="o">:</span><span class="nx">j</span><span class="o">===</span><span class="mi">1223</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">j</span><span class="o">=</span><span class="mi">204</span><span class="p">)}}}</span><span class="k">catch</span><span class="p">(</span><span class="nx">p</span><span class="p">){</span><span class="nx">e</span><span class="o">||</span><span class="nx">g</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nx">p</span><span class="p">)}</span><span class="nx">m</span><span class="o">&amp;&amp;</span><span class="nx">g</span><span class="p">(</span><span class="nx">j</span><span class="p">,</span><span class="nx">k</span><span class="p">,</span><span class="nx">m</span><span class="p">,</span><span class="nx">l</span><span class="p">)},</span><span class="o">!</span><span class="nx">c</span><span class="p">.</span><span class="nx">async</span><span class="o">||</span><span class="nx">h</span><span class="p">.</span><span class="nx">readyState</span><span class="o">===</span><span class="mi">4</span><span class="o">?</span><span class="nx">d</span><span class="p">()</span><span class="o">:</span><span class="p">(</span><span class="nx">i</span><span class="o">=++</span><span class="nx">cg</span><span class="p">,</span><span class="nx">cf</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">ch</span><span class="o">||</span><span class="p">(</span><span class="nx">ch</span><span class="o">=</span><span class="p">{},</span><span class="nx">f</span><span class="p">(</span><span class="nx">a</span><span class="p">).</span><span class="nx">unload</span><span class="p">(</span><span class="nx">cf</span><span class="p">)),</span><span class="nx">ch</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">=</span><span class="nx">d</span><span class="p">),</span><span class="nx">h</span><span class="p">.</span><span class="nx">onreadystatechange</span><span class="o">=</span><span class="nx">d</span><span class="p">)},</span><span class="nx">abort</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)}}}});</span><span class="kd">var</span> <span class="nx">ck</span><span class="o">=</span><span class="p">{},</span><span class="nx">cl</span><span class="p">,</span><span class="nx">cm</span><span class="p">,</span><span class="nx">cn</span><span class="o">=</span><span class="sr">/^(?:toggle|show|hide)$/</span><span class="p">,</span><span class="nx">co</span><span class="o">=</span><span class="sr">/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i</span><span class="p">,</span><span class="nx">cp</span><span class="p">,</span><span class="nx">cq</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;height&quot;</span><span class="p">,</span><span class="s2">&quot;marginTop&quot;</span><span class="p">,</span><span class="s2">&quot;marginBottom&quot;</span><span class="p">,</span><span class="s2">&quot;paddingTop&quot;</span><span class="p">,</span><span class="s2">&quot;paddingBottom&quot;</span><span class="p">],[</span><span class="s2">&quot;width&quot;</span><span class="p">,</span><span class="s2">&quot;marginLeft&quot;</span><span class="p">,</span><span class="s2">&quot;marginRight&quot;</span><span class="p">,</span><span class="s2">&quot;paddingLeft&quot;</span><span class="p">,</span><span class="s2">&quot;paddingRight&quot;</span><span class="p">],[</span><span class="s2">&quot;opacity&quot;</span><span class="p">]],</span><span class="nx">cr</span><span class="p">;</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">show</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">||</span><span class="nx">a</span><span class="o">===</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">animate</span><span class="p">(</span><span class="nx">cu</span><span class="p">(</span><span class="s2">&quot;show&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">g</span><span class="o">&lt;</span><span class="nx">h</span><span class="p">;</span><span class="nx">g</span><span class="o">++</span><span class="p">)</span><span class="nx">d</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="nx">g</span><span class="p">],</span><span class="nx">d</span><span class="p">.</span><span class="nx">style</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="p">,</span><span class="o">!</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="s2">&quot;olddisplay&quot;</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="o">===</span><span class="s2">&quot;none&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">),</span><span class="nx">e</span><span class="o">===</span><span class="s2">&quot;&quot;</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="s2">&quot;display&quot;</span><span class="p">)</span><span class="o">===</span><span class="s2">&quot;none&quot;</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="s2">&quot;olddisplay&quot;</span><span class="p">,</span><span class="nx">cv</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">)));</span><span class="k">for</span><span class="p">(</span><span class="nx">g</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">g</span><span class="o">&lt;</span><span class="nx">h</span><span class="p">;</span><span class="nx">g</span><span class="o">++</span><span class="p">){</span><span class="nx">d</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="nx">g</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">style</span><span class="p">){</span><span class="nx">e</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="o">===</span><span class="s2">&quot;&quot;</span><span class="o">||</span><span class="nx">e</span><span class="o">===</span><span class="s2">&quot;none&quot;</span><span class="p">)</span><span class="nx">d</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="s2">&quot;olddisplay&quot;</span><span class="p">)</span><span class="o">||</span><span class="s2">&quot;&quot;</span><span class="p">}}</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">hide</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">||</span><span class="nx">a</span><span class="o">===</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">animate</span><span class="p">(</span><span class="nx">cu</span><span class="p">(</span><span class="s2">&quot;hide&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">);</span><span class="kd">var</span> <span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="k">for</span><span class="p">(;</span><span class="nx">g</span><span class="o">&lt;</span><span class="nx">h</span><span class="p">;</span><span class="nx">g</span><span class="o">++</span><span class="p">)</span><span class="nx">d</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="nx">g</span><span class="p">],</span><span class="nx">d</span><span class="p">.</span><span class="nx">style</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">e</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="s2">&quot;display&quot;</span><span class="p">),</span><span class="nx">e</span><span class="o">!==</span><span class="s2">&quot;none&quot;</span><span class="o">&amp;&amp;!</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="s2">&quot;olddisplay&quot;</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="s2">&quot;olddisplay&quot;</span><span class="p">,</span><span class="nx">e</span><span class="p">));</span><span class="k">for</span><span class="p">(</span><span class="nx">g</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">g</span><span class="o">&lt;</span><span class="nx">h</span><span class="p">;</span><span class="nx">g</span><span class="o">++</span><span class="p">)</span><span class="k">this</span><span class="p">[</span><span class="nx">g</span><span class="p">].</span><span class="nx">style</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">g</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">_toggle</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">toggle</span><span class="p">,</span><span class="nx">toggle</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">==</span><span class="s2">&quot;boolean&quot;</span><span class="p">;</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">_toggle</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">arguments</span><span class="p">)</span><span class="o">:</span><span class="nx">a</span><span class="o">==</span><span class="kc">null</span><span class="o">||</span><span class="nx">d</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">d</span><span class="o">?</span><span class="nx">a</span><span class="o">:</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">is</span><span class="p">(</span><span class="s2">&quot;:hidden&quot;</span><span class="p">);</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">)[</span><span class="nx">b</span><span class="o">?</span><span class="s2">&quot;show&quot;</span><span class="o">:</span><span class="s2">&quot;hide&quot;</span><span class="p">]()})</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">animate</span><span class="p">(</span><span class="nx">cu</span><span class="p">(</span><span class="s2">&quot;toggle&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">);</span><span class="k">return</span> <span class="k">this</span><span class="p">},</span><span class="nx">fadeTo</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="s2">&quot;:hidden&quot;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;opacity&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">).</span><span class="nx">show</span><span class="p">().</span><span class="nx">end</span><span class="p">().</span><span class="nx">animate</span><span class="p">({</span><span class="nx">opacity</span><span class="o">:</span><span class="nx">b</span><span class="p">},</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">)},</span><span class="nx">animate</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">function</span> <span class="nx">g</span><span class="p">(){</span><span class="nx">e</span><span class="p">.</span><span class="nx">queue</span><span class="o">===!</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">_mark</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span><span class="nx">e</span><span class="p">),</span><span class="nx">c</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">1</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">is</span><span class="p">(</span><span class="s2">&quot;:hidden&quot;</span><span class="p">),</span><span class="nx">g</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="nx">k</span><span class="p">,</span><span class="nx">l</span><span class="p">,</span><span class="nx">m</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">o</span><span class="p">;</span><span class="nx">b</span><span class="p">.</span><span class="nx">animatedProperties</span><span class="o">=</span><span class="p">{};</span><span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">a</span><span class="p">){</span><span class="nx">g</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">camelCase</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span><span class="nx">i</span><span class="o">!==</span><span class="nx">g</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">g</span><span class="p">]</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span><span class="k">delete</span> <span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]),</span><span class="nx">h</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">g</span><span class="p">],</span><span class="nx">f</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">h</span><span class="p">)</span><span class="o">?</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">animatedProperties</span><span class="p">[</span><span class="nx">g</span><span class="p">]</span><span class="o">=</span><span class="nx">h</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nx">h</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">g</span><span class="p">]</span><span class="o">=</span><span class="nx">h</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">:</span><span class="nx">b</span><span class="p">.</span><span class="nx">animatedProperties</span><span class="p">[</span><span class="nx">g</span><span class="p">]</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">specialEasing</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="p">.</span><span class="nx">specialEasing</span><span class="p">[</span><span class="nx">g</span><span class="p">]</span><span class="o">||</span><span class="nx">b</span><span class="p">.</span><span class="nx">easing</span><span class="o">||</span><span class="s2">&quot;swing&quot;</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">h</span><span class="o">===</span><span class="s2">&quot;hide&quot;</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="o">||</span><span class="nx">h</span><span class="o">===</span><span class="s2">&quot;show&quot;</span><span class="o">&amp;&amp;!</span><span class="nx">d</span><span class="p">)</span><span class="k">return</span> <span class="nx">b</span><span class="p">.</span><span class="nx">complete</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">g</span><span class="o">===</span><span class="s2">&quot;height&quot;</span><span class="o">||</span><span class="nx">g</span><span class="o">===</span><span class="s2">&quot;width&quot;</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">overflow</span><span class="o">=</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">overflow</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">overflowX</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">overflowY</span><span class="p">],</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;display&quot;</span><span class="p">)</span><span class="o">===</span><span class="s2">&quot;inline&quot;</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;float&quot;</span><span class="p">)</span><span class="o">===</span><span class="s2">&quot;none&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">inlineBlockNeedsLayout</span><span class="o">||</span><span class="nx">cv</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">)</span><span class="o">===</span><span class="s2">&quot;inline&quot;</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="s2">&quot;inline-block&quot;</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">zoom</span><span class="o">=</span><span class="mi">1</span><span class="p">))}</span><span class="nx">b</span><span class="p">.</span><span class="nx">overflow</span><span class="o">!=</span><span class="kc">null</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">overflow</span><span class="o">=</span><span class="s2">&quot;hidden&quot;</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">a</span><span class="p">)</span><span class="nx">j</span><span class="o">=</span><span class="k">new</span> <span class="nx">f</span><span class="p">.</span><span class="nx">fx</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">i</span><span class="p">),</span><span class="nx">h</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span><span class="nx">cn</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">h</span><span class="p">)</span><span class="o">?</span><span class="p">(</span><span class="nx">o</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;toggle&quot;</span><span class="o">+</span><span class="nx">i</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="nx">h</span><span class="o">===</span><span class="s2">&quot;toggle&quot;</span><span class="o">?</span><span class="nx">d</span><span class="o">?</span><span class="s2">&quot;show&quot;</span><span class="o">:</span><span class="s2">&quot;hide&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">),</span><span class="nx">o</span><span class="o">?</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s2">&quot;toggle&quot;</span><span class="o">+</span><span class="nx">i</span><span class="p">,</span><span class="nx">o</span><span class="o">===</span><span class="s2">&quot;show&quot;</span><span class="o">?</span><span class="s2">&quot;hide&quot;</span><span class="o">:</span><span class="s2">&quot;show&quot;</span><span class="p">),</span><span class="nx">j</span><span class="p">[</span><span class="nx">o</span><span class="p">]())</span><span class="o">:</span><span class="nx">j</span><span class="p">[</span><span class="nx">h</span><span class="p">]())</span><span class="o">:</span><span class="p">(</span><span class="nx">k</span><span class="o">=</span><span class="nx">co</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">h</span><span class="p">),</span><span class="nx">l</span><span class="o">=</span><span class="nx">j</span><span class="p">.</span><span class="nx">cur</span><span class="p">(),</span><span class="nx">k</span><span class="o">?</span><span class="p">(</span><span class="nx">m</span><span class="o">=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">k</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="nx">n</span><span class="o">=</span><span class="nx">k</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">||</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">cssNumber</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="s2">&quot;px&quot;</span><span class="p">),</span><span class="nx">n</span><span class="o">!==</span><span class="s2">&quot;px&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">i</span><span class="p">,(</span><span class="nx">m</span><span class="o">||</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="nx">n</span><span class="p">),</span><span class="nx">l</span><span class="o">=</span><span class="p">(</span><span class="nx">m</span><span class="o">||</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nx">j</span><span class="p">.</span><span class="nx">cur</span><span class="p">()</span><span class="o">*</span><span class="nx">l</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">l</span><span class="o">+</span><span class="nx">n</span><span class="p">)),</span><span class="nx">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">m</span><span class="o">=</span><span class="p">(</span><span class="nx">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">===</span><span class="s2">&quot;-=&quot;</span><span class="o">?-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nx">m</span><span class="o">+</span><span class="nx">l</span><span class="p">),</span><span class="nx">j</span><span class="p">.</span><span class="nx">custom</span><span class="p">(</span><span class="nx">l</span><span class="p">,</span><span class="nx">m</span><span class="p">,</span><span class="nx">n</span><span class="p">))</span><span class="o">:</span><span class="nx">j</span><span class="p">.</span><span class="nx">custom</span><span class="p">(</span><span class="nx">l</span><span class="p">,</span><span class="nx">h</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">));</span><span class="k">return</span><span class="o">!</span><span class="mi">0</span><span class="p">}</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">speed</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">isEmptyObject</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">complete</span><span class="p">,[</span><span class="o">!</span><span class="mi">1</span><span class="p">]);</span><span class="nx">a</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span><span class="nx">a</span><span class="p">);</span><span class="k">return</span> <span class="nx">e</span><span class="p">.</span><span class="nx">queue</span><span class="o">===!</span><span class="mi">1</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">g</span><span class="p">)</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">queue</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">queue</span><span class="p">,</span><span class="nx">g</span><span class="p">)},</span><span class="nx">stop</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">!=</span><span class="s2">&quot;string&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="nx">c</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">,</span><span class="nx">a</span><span class="o">=</span><span class="nx">b</span><span class="p">),</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="o">!==!</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">queue</span><span class="p">(</span><span class="nx">a</span><span class="o">||</span><span class="s2">&quot;fx&quot;</span><span class="p">,[]);</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">function</span> <span class="nx">h</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="nx">c</span><span class="p">];</span><span class="nx">f</span><span class="p">.</span><span class="nx">removeData</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">),</span><span class="nx">e</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="nx">d</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="o">=!</span><span class="mi">1</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">timers</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="nx">d</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">_unmark</span><span class="p">(</span><span class="o">!</span><span class="mi">0</span><span class="p">,</span><span class="k">this</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">==</span><span class="kc">null</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="nx">b</span> <span class="k">in</span> <span class="nx">g</span><span class="p">)</span><span class="nx">g</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">g</span><span class="p">[</span><span class="nx">b</span><span class="p">].</span><span class="nx">stop</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;.run&quot;</span><span class="p">)</span><span class="o">===</span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">4</span><span class="o">&amp;&amp;</span><span class="nx">h</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">b</span><span class="p">);</span><span class="k">else</span> <span class="nx">g</span><span class="p">[</span><span class="nx">b</span><span class="o">=</span><span class="nx">a</span><span class="o">+</span><span class="s2">&quot;.run&quot;</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="nx">g</span><span class="p">[</span><span class="nx">b</span><span class="p">].</span><span class="nx">stop</span><span class="o">&amp;&amp;</span><span class="nx">h</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">b</span><span class="p">);</span><span class="k">for</span><span class="p">(</span><span class="nx">b</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">b</span><span class="o">--</span><span class="p">;)</span><span class="nx">e</span><span class="p">[</span><span class="nx">b</span><span class="p">].</span><span class="nx">elem</span><span class="o">===</span><span class="k">this</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="o">==</span><span class="kc">null</span><span class="o">||</span><span class="nx">e</span><span class="p">[</span><span class="nx">b</span><span class="p">].</span><span class="nx">queue</span><span class="o">===</span><span class="nx">a</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">d</span><span class="o">?</span><span class="nx">e</span><span class="p">[</span><span class="nx">b</span><span class="p">](</span><span class="o">!</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span><span class="nx">e</span><span class="p">[</span><span class="nx">b</span><span class="p">].</span><span class="nx">saveState</span><span class="p">(),</span><span class="nx">c</span><span class="o">=!</span><span class="mi">0</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="mi">1</span><span class="p">));(</span><span class="o">!</span><span class="nx">d</span><span class="o">||!</span><span class="nx">c</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">dequeue</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">)})}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">({</span><span class="nx">slideDown</span><span class="o">:</span><span class="nx">cu</span><span class="p">(</span><span class="s2">&quot;show&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nx">slideUp</span><span class="o">:</span><span class="nx">cu</span><span class="p">(</span><span class="s2">&quot;hide&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nx">slideToggle</span><span class="o">:</span><span class="nx">cu</span><span class="p">(</span><span class="s2">&quot;toggle&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nx">fadeIn</span><span class="o">:</span><span class="p">{</span><span class="nx">opacity</span><span class="o">:</span><span class="s2">&quot;show&quot;</span><span class="p">},</span><span class="nx">fadeOut</span><span class="o">:</span><span class="p">{</span><span class="nx">opacity</span><span class="o">:</span><span class="s2">&quot;hide&quot;</span><span class="p">},</span><span class="nx">fadeToggle</span><span class="o">:</span><span class="p">{</span><span class="nx">opacity</span><span class="o">:</span><span class="s2">&quot;toggle&quot;</span><span class="p">}},</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">animate</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">)}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">speed</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">==</span><span class="s2">&quot;object&quot;</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span><span class="nx">a</span><span class="p">)</span><span class="o">:</span><span class="p">{</span><span class="nx">complete</span><span class="o">:</span><span class="nx">c</span><span class="o">||!</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">,</span><span class="nx">duration</span><span class="o">:</span><span class="nx">a</span><span class="p">,</span><span class="nx">easing</span><span class="o">:</span><span class="nx">c</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="o">||</span><span class="nx">b</span><span class="o">&amp;&amp;!</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="p">};</span><span class="nx">d</span><span class="p">.</span><span class="nx">duration</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">fx</span><span class="p">.</span><span class="nx">off</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="k">typeof</span> <span class="nx">d</span><span class="p">.</span><span class="nx">duration</span><span class="o">==</span><span class="s2">&quot;number&quot;</span><span class="o">?</span><span class="nx">d</span><span class="p">.</span><span class="nx">duration</span><span class="o">:</span><span class="nx">d</span><span class="p">.</span><span class="nx">duration</span> <span class="k">in</span> <span class="nx">f</span><span class="p">.</span><span class="nx">fx</span><span class="p">.</span><span class="nx">speeds</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">fx</span><span class="p">.</span><span class="nx">speeds</span><span class="p">[</span><span class="nx">d</span><span class="p">.</span><span class="nx">duration</span><span class="p">]</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">fx</span><span class="p">.</span><span class="nx">speeds</span><span class="p">.</span><span class="nx">_default</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">queue</span><span class="o">==</span><span class="kc">null</span><span class="o">||</span><span class="nx">d</span><span class="p">.</span><span class="nx">queue</span><span class="o">===!</span><span class="mi">0</span><span class="p">)</span><span class="nx">d</span><span class="p">.</span><span class="nx">queue</span><span class="o">=</span><span class="s2">&quot;fx&quot;</span><span class="p">;</span><span class="nx">d</span><span class="p">.</span><span class="nx">old</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">complete</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">complete</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">old</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">d</span><span class="p">.</span><span class="nx">old</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">),</span><span class="nx">d</span><span class="p">.</span><span class="nx">queue</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">dequeue</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">queue</span><span class="p">)</span><span class="o">:</span><span class="nx">a</span><span class="o">!==!</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">_unmark</span><span class="p">(</span><span class="k">this</span><span class="p">)};</span><span class="k">return</span> <span class="nx">d</span><span class="p">},</span><span class="nx">easing</span><span class="o">:</span><span class="p">{</span><span class="nx">linear</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">c</span><span class="o">+</span><span class="nx">d</span><span class="o">*</span><span class="nx">a</span><span class="p">},</span><span class="nx">swing</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="o">-</span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">a</span><span class="o">*</span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="nx">d</span><span class="o">+</span><span class="nx">c</span><span class="p">}},</span><span class="nx">timers</span><span class="o">:</span><span class="p">[],</span><span class="nx">fx</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="o">=</span><span class="nx">b</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">elem</span><span class="o">=</span><span class="nx">a</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">prop</span><span class="o">=</span><span class="nx">c</span><span class="p">,</span><span class="nx">b</span><span class="p">.</span><span class="nx">orig</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">orig</span><span class="o">||</span><span class="p">{}}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">fx</span><span class="p">.</span><span class="nx">prototype</span><span class="o">=</span><span class="p">{</span><span class="nx">update</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">step</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">step</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">elem</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">now</span><span class="p">,</span><span class="k">this</span><span class="p">),(</span><span class="nx">f</span><span class="p">.</span><span class="nx">fx</span><span class="p">.</span><span class="nx">step</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">prop</span><span class="p">]</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">fx</span><span class="p">.</span><span class="nx">step</span><span class="p">.</span><span class="nx">_default</span><span class="p">)(</span><span class="k">this</span><span class="p">)},</span><span class="nx">cur</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">elem</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">prop</span><span class="p">]</span><span class="o">!=</span><span class="kc">null</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">elem</span><span class="p">.</span><span class="nx">style</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">elem</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">prop</span><span class="p">]</span><span class="o">==</span><span class="kc">null</span><span class="p">))</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">elem</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">prop</span><span class="p">];</span><span class="kd">var</span> <span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">elem</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">prop</span><span class="p">);</span><span class="k">return</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">a</span><span class="o">=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">b</span><span class="p">))</span><span class="o">?!</span><span class="nx">b</span><span class="o">||</span><span class="nx">b</span><span class="o">===</span><span class="s2">&quot;auto&quot;</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="nx">b</span><span class="o">:</span><span class="nx">a</span><span class="p">},</span><span class="nx">custom</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="kd">function</span> <span class="nx">h</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">e</span><span class="p">.</span><span class="nx">step</span><span class="p">(</span><span class="nx">a</span><span class="p">)}</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="k">this</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">fx</span><span class="p">;</span><span class="k">this</span><span class="p">.</span><span class="nx">startTime</span><span class="o">=</span><span class="nx">cr</span><span class="o">||</span><span class="nx">cs</span><span class="p">(),</span><span class="k">this</span><span class="p">.</span><span class="nx">end</span><span class="o">=</span><span class="nx">c</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">now</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">start</span><span class="o">=</span><span class="nx">a</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">pos</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">unit</span><span class="o">=</span><span class="nx">d</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">unit</span><span class="o">||</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">cssNumber</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">prop</span><span class="p">]</span><span class="o">?</span><span class="s2">&quot;&quot;</span><span class="o">:</span><span class="s2">&quot;px&quot;</span><span class="p">),</span><span class="nx">h</span><span class="p">.</span><span class="nx">queue</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">queue</span><span class="p">,</span><span class="nx">h</span><span class="p">.</span><span class="nx">elem</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">elem</span><span class="p">,</span><span class="nx">h</span><span class="p">.</span><span class="nx">saveState</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="nx">e</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">hide</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">elem</span><span class="p">,</span><span class="s2">&quot;fxshow&quot;</span><span class="o">+</span><span class="nx">e</span><span class="p">.</span><span class="nx">prop</span><span class="p">)</span><span class="o">===</span><span class="nx">b</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">elem</span><span class="p">,</span><span class="s2">&quot;fxshow&quot;</span><span class="o">+</span><span class="nx">e</span><span class="p">.</span><span class="nx">prop</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">start</span><span class="p">)},</span><span class="nx">h</span><span class="p">()</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">timers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">h</span><span class="p">)</span><span class="o">&amp;&amp;!</span><span class="nx">cp</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">cp</span><span class="o">=</span><span class="nx">setInterval</span><span class="p">(</span><span class="nx">g</span><span class="p">.</span><span class="nx">tick</span><span class="p">,</span><span class="nx">g</span><span class="p">.</span><span class="nx">interval</span><span class="p">))},</span><span class="nx">show</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">elem</span><span class="p">,</span><span class="s2">&quot;fxshow&quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">prop</span><span class="p">);</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">orig</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">prop</span><span class="p">]</span><span class="o">=</span><span class="nx">a</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">elem</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">prop</span><span class="p">),</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">show</span><span class="o">=!</span><span class="mi">0</span><span class="p">,</span><span class="nx">a</span><span class="o">!==</span><span class="nx">b</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">custom</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cur</span><span class="p">(),</span><span class="nx">a</span><span class="p">)</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">custom</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">prop</span><span class="o">===</span><span class="s2">&quot;width&quot;</span><span class="o">||</span><span class="k">this</span><span class="p">.</span><span class="nx">prop</span><span class="o">===</span><span class="s2">&quot;height&quot;</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">cur</span><span class="p">()),</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">elem</span><span class="p">).</span><span class="nx">show</span><span class="p">()},</span><span class="nx">hide</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">orig</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">prop</span><span class="p">]</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">_data</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">elem</span><span class="p">,</span><span class="s2">&quot;fxshow&quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">prop</span><span class="p">)</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">elem</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">prop</span><span class="p">),</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">hide</span><span class="o">=!</span><span class="mi">0</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">custom</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cur</span><span class="p">(),</span><span class="mi">0</span><span class="p">)},</span><span class="nx">step</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">cr</span><span class="o">||</span><span class="nx">cs</span><span class="p">(),</span><span class="nx">g</span><span class="o">=!</span><span class="mi">0</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">elem</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">||</span><span class="nx">e</span><span class="o">&gt;=</span><span class="nx">i</span><span class="p">.</span><span class="nx">duration</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">startTime</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">now</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">end</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">pos</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">(),</span><span class="nx">i</span><span class="p">.</span><span class="nx">animatedProperties</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">prop</span><span class="p">]</span><span class="o">=!</span><span class="mi">0</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nx">b</span> <span class="k">in</span> <span class="nx">i</span><span class="p">.</span><span class="nx">animatedProperties</span><span class="p">)</span><span class="nx">i</span><span class="p">.</span><span class="nx">animatedProperties</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">!==!</span><span class="mi">0</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">g</span><span class="o">=!</span><span class="mi">1</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">g</span><span class="p">){</span><span class="nx">i</span><span class="p">.</span><span class="nx">overflow</span><span class="o">!=</span><span class="kc">null</span><span class="o">&amp;&amp;!</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">shrinkWrapBlocks</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;X&quot;</span><span class="p">,</span><span class="s2">&quot;Y&quot;</span><span class="p">],</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">h</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="s2">&quot;overflow&quot;</span><span class="o">+</span><span class="nx">b</span><span class="p">]</span><span class="o">=</span><span class="nx">i</span><span class="p">.</span><span class="nx">overflow</span><span class="p">[</span><span class="nx">a</span><span class="p">]}),</span><span class="nx">i</span><span class="p">.</span><span class="nx">hide</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">(</span><span class="nx">h</span><span class="p">).</span><span class="nx">hide</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">i</span><span class="p">.</span><span class="nx">hide</span><span class="o">||</span><span class="nx">i</span><span class="p">.</span><span class="nx">show</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="nx">b</span> <span class="k">in</span> <span class="nx">i</span><span class="p">.</span><span class="nx">animatedProperties</span><span class="p">)</span><span class="nx">f</span><span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="nx">h</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">i</span><span class="p">.</span><span class="nx">orig</span><span class="p">[</span><span class="nx">b</span><span class="p">]),</span><span class="nx">f</span><span class="p">.</span><span class="nx">removeData</span><span class="p">(</span><span class="nx">h</span><span class="p">,</span><span class="s2">&quot;fxshow&quot;</span><span class="o">+</span><span class="nx">b</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">),</span><span class="nx">f</span><span class="p">.</span><span class="nx">removeData</span><span class="p">(</span><span class="nx">h</span><span class="p">,</span><span class="s2">&quot;toggle&quot;</span><span class="o">+</span><span class="nx">b</span><span class="p">,</span><span class="o">!</span><span class="mi">0</span><span class="p">);</span><span class="nx">d</span><span class="o">=</span><span class="nx">i</span><span class="p">.</span><span class="nx">complete</span><span class="p">,</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">i</span><span class="p">.</span><span class="nx">complete</span><span class="o">=!</span><span class="mi">1</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">h</span><span class="p">))}</span><span class="k">return</span><span class="o">!</span><span class="mi">1</span><span class="p">}</span><span class="nx">i</span><span class="p">.</span><span class="nx">duration</span><span class="o">==</span><span class="kc">Infinity</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">now</span><span class="o">=</span><span class="nx">e</span><span class="o">:</span><span class="p">(</span><span class="nx">c</span><span class="o">=</span><span class="nx">e</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">startTime</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="nx">c</span><span class="o">/</span><span class="nx">i</span><span class="p">.</span><span class="nx">duration</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">pos</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">easing</span><span class="p">[</span><span class="nx">i</span><span class="p">.</span><span class="nx">animatedProperties</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">prop</span><span class="p">]](</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nx">i</span><span class="p">.</span><span class="nx">duration</span><span class="p">),</span><span class="k">this</span><span class="p">.</span><span class="nx">now</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">start</span><span class="o">+</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">end</span><span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">start</span><span class="p">)</span><span class="o">*</span><span class="k">this</span><span class="p">.</span><span class="nx">pos</span><span class="p">),</span><span class="k">this</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span><span class="k">return</span><span class="o">!</span><span class="mi">0</span><span class="p">}},</span><span class="nx">f</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">fx</span><span class="p">,{</span><span class="nx">tick</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">timers</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">for</span><span class="p">(;</span><span class="nx">c</span><span class="o">&lt;</span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">c</span><span class="o">++</span><span class="p">)</span><span class="nx">a</span><span class="o">=</span><span class="nx">b</span><span class="p">[</span><span class="nx">c</span><span class="p">],</span><span class="o">!</span><span class="nx">a</span><span class="p">()</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">===</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">c</span><span class="o">--</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">fx</span><span class="p">.</span><span class="nx">stop</span><span class="p">()},</span><span class="nx">interval</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="nx">stop</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="nx">clearInterval</span><span class="p">(</span><span class="nx">cp</span><span class="p">),</span><span class="nx">cp</span><span class="o">=</span><span class="kc">null</span><span class="p">},</span><span class="nx">speeds</span><span class="o">:</span><span class="p">{</span><span class="nx">slow</span><span class="o">:</span><span class="mi">600</span><span class="p">,</span><span class="nx">fast</span><span class="o">:</span><span class="mi">200</span><span class="p">,</span><span class="nx">_default</span><span class="o">:</span><span class="mi">400</span><span class="p">},</span><span class="nx">step</span><span class="o">:</span><span class="p">{</span><span class="nx">opacity</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">elem</span><span class="p">,</span><span class="s2">&quot;opacity&quot;</span><span class="p">,</span><span class="nx">a</span><span class="p">.</span><span class="nx">now</span><span class="p">)},</span><span class="nx">_default</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">a</span><span class="p">.</span><span class="nx">elem</span><span class="p">.</span><span class="nx">style</span><span class="o">&amp;&amp;</span><span class="nx">a</span><span class="p">.</span><span class="nx">elem</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="nx">a</span><span class="p">.</span><span class="nx">prop</span><span class="p">]</span><span class="o">!=</span><span class="kc">null</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">elem</span><span class="p">.</span><span class="nx">style</span><span class="p">[</span><span class="nx">a</span><span class="p">.</span><span class="nx">prop</span><span class="p">]</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">now</span><span class="o">+</span><span class="nx">a</span><span class="p">.</span><span class="nx">unit</span><span class="o">:</span><span class="nx">a</span><span class="p">.</span><span class="nx">elem</span><span class="p">[</span><span class="nx">a</span><span class="p">.</span><span class="nx">prop</span><span class="p">]</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">now</span><span class="p">}}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">([</span><span class="s2">&quot;width&quot;</span><span class="p">,</span><span class="s2">&quot;height&quot;</span><span class="p">],</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">fx</span><span class="p">.</span><span class="nx">step</span><span class="p">[</span><span class="nx">b</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">elem</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">a</span><span class="p">.</span><span class="nx">now</span><span class="p">)</span><span class="o">+</span><span class="nx">a</span><span class="p">.</span><span class="nx">unit</span><span class="p">)}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">expr</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">expr</span><span class="p">.</span><span class="nx">filters</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">expr</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">animated</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">grep</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">timers</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="k">return</span> <span class="nx">a</span><span class="o">===</span><span class="nx">b</span><span class="p">.</span><span class="nx">elem</span><span class="p">}).</span><span class="nx">length</span><span class="p">});</span><span class="kd">var</span> <span class="nx">cw</span><span class="o">=</span><span class="sr">/^t(?:able|d|h)$/i</span><span class="p">,</span><span class="nx">cx</span><span class="o">=</span><span class="sr">/^(?:body|html)$/i</span><span class="p">;</span><span class="s2">&quot;getBoundingClientRect&quot;</span><span class="k">in</span> <span class="nx">c</span><span class="p">.</span><span class="nx">documentElement</span><span class="o">?</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">offset</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">c</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">offset</span><span class="p">.</span><span class="nx">setOffset</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">)});</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">b</span><span class="o">||!</span><span class="nx">b</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="p">)</span><span class="k">return</span> <span class="kc">null</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="o">===</span><span class="nx">b</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">offset</span><span class="p">.</span><span class="nx">bodyOffset</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span><span class="k">try</span><span class="p">{</span><span class="nx">c</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">getBoundingClientRect</span><span class="p">()}</span><span class="k">catch</span><span class="p">(</span><span class="nx">d</span><span class="p">){}</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">c</span><span class="o">||!</span><span class="nx">f</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">g</span><span class="p">,</span><span class="nx">b</span><span class="p">))</span><span class="k">return</span> <span class="nx">c</span><span class="o">?</span><span class="p">{</span><span class="nx">top</span><span class="o">:</span><span class="nx">c</span><span class="p">.</span><span class="nx">top</span><span class="p">,</span><span class="nx">left</span><span class="o">:</span><span class="nx">c</span><span class="p">.</span><span class="nx">left</span><span class="p">}</span><span class="o">:</span><span class="p">{</span><span class="nx">top</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">left</span><span class="o">:</span><span class="mi">0</span><span class="p">};</span><span class="kd">var</span> <span class="nx">h</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">cy</span><span class="p">(</span><span class="nx">e</span><span class="p">),</span><span class="nx">j</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">clientTop</span><span class="o">||</span><span class="nx">h</span><span class="p">.</span><span class="nx">clientTop</span><span class="o">||</span><span class="mi">0</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">clientLeft</span><span class="o">||</span><span class="nx">h</span><span class="p">.</span><span class="nx">clientLeft</span><span class="o">||</span><span class="mi">0</span><span class="p">,</span><span class="nx">l</span><span class="o">=</span><span class="nx">i</span><span class="p">.</span><span class="nx">pageYOffset</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">boxModel</span><span class="o">&amp;&amp;</span><span class="nx">g</span><span class="p">.</span><span class="nx">scrollTop</span><span class="o">||</span><span class="nx">h</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">,</span><span class="nx">m</span><span class="o">=</span><span class="nx">i</span><span class="p">.</span><span class="nx">pageXOffset</span><span class="o">||</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">boxModel</span><span class="o">&amp;&amp;</span><span class="nx">g</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="o">||</span><span class="nx">h</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="p">,</span><span class="nx">n</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">top</span><span class="o">+</span><span class="nx">l</span><span class="o">-</span><span class="nx">j</span><span class="p">,</span><span class="nx">o</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">left</span><span class="o">+</span><span class="nx">m</span><span class="o">-</span><span class="nx">k</span><span class="p">;</span><span class="k">return</span><span class="p">{</span><span class="nx">top</span><span class="o">:</span><span class="nx">n</span><span class="p">,</span><span class="nx">left</span><span class="o">:</span><span class="nx">o</span><span class="p">}}</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">offset</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="nx">f</span><span class="p">.</span><span class="nx">offset</span><span class="p">.</span><span class="nx">setOffset</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">)});</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">b</span><span class="o">||!</span><span class="nx">b</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="p">)</span><span class="k">return</span> <span class="kc">null</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="o">===</span><span class="nx">b</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">offset</span><span class="p">.</span><span class="nx">bodyOffset</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span><span class="kd">var</span> <span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">offsetParent</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="nx">b</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">ownerDocument</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="nx">g</span><span class="p">.</span><span class="nx">defaultView</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="nx">j</span><span class="o">?</span><span class="nx">j</span><span class="p">.</span><span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="kc">null</span><span class="p">)</span><span class="o">:</span><span class="nx">b</span><span class="p">.</span><span class="nx">currentStyle</span><span class="p">,</span><span class="nx">l</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">offsetTop</span><span class="p">,</span><span class="nx">m</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">offsetLeft</span><span class="p">;</span><span class="k">while</span><span class="p">((</span><span class="nx">b</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="o">!==</span><span class="nx">i</span><span class="o">&amp;&amp;</span><span class="nx">b</span><span class="o">!==</span><span class="nx">h</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">fixedPosition</span><span class="o">&amp;&amp;</span><span class="nx">k</span><span class="p">.</span><span class="nx">position</span><span class="o">===</span><span class="s2">&quot;fixed&quot;</span><span class="p">)</span><span class="k">break</span><span class="p">;</span><span class="nx">c</span><span class="o">=</span><span class="nx">j</span><span class="o">?</span><span class="nx">j</span><span class="p">.</span><span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="kc">null</span><span class="p">)</span><span class="o">:</span><span class="nx">b</span><span class="p">.</span><span class="nx">currentStyle</span><span class="p">,</span><span class="nx">l</span><span class="o">-=</span><span class="nx">b</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">,</span><span class="nx">m</span><span class="o">-=</span><span class="nx">b</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="p">,</span><span class="nx">b</span><span class="o">===</span><span class="nx">d</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">l</span><span class="o">+=</span><span class="nx">b</span><span class="p">.</span><span class="nx">offsetTop</span><span class="p">,</span><span class="nx">m</span><span class="o">+=</span><span class="nx">b</span><span class="p">.</span><span class="nx">offsetLeft</span><span class="p">,</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">doesNotAddBorder</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">!</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">doesAddBorderForTableAndCells</span><span class="o">||!</span><span class="nx">cw</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">))</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">l</span><span class="o">+=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">borderTopWidth</span><span class="p">)</span><span class="o">||</span><span class="mi">0</span><span class="p">,</span><span class="nx">m</span><span class="o">+=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">borderLeftWidth</span><span class="p">)</span><span class="o">||</span><span class="mi">0</span><span class="p">),</span><span class="nx">e</span><span class="o">=</span><span class="nx">d</span><span class="p">,</span><span class="nx">d</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">offsetParent</span><span class="p">),</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">subtractsBorderForOverflowNotVisible</span><span class="o">&amp;&amp;</span><span class="nx">c</span><span class="p">.</span><span class="nx">overflow</span><span class="o">!==</span><span class="s2">&quot;visible&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">l</span><span class="o">+=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">borderTopWidth</span><span class="p">)</span><span class="o">||</span><span class="mi">0</span><span class="p">,</span><span class="nx">m</span><span class="o">+=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">borderLeftWidth</span><span class="p">)</span><span class="o">||</span><span class="mi">0</span><span class="p">),</span><span class="nx">k</span><span class="o">=</span><span class="nx">c</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">k</span><span class="p">.</span><span class="nx">position</span><span class="o">===</span><span class="s2">&quot;relative&quot;</span><span class="o">||</span><span class="nx">k</span><span class="p">.</span><span class="nx">position</span><span class="o">===</span><span class="s2">&quot;static&quot;</span><span class="p">)</span><span class="nx">l</span><span class="o">+=</span><span class="nx">i</span><span class="p">.</span><span class="nx">offsetTop</span><span class="p">,</span><span class="nx">m</span><span class="o">+=</span><span class="nx">i</span><span class="p">.</span><span class="nx">offsetLeft</span><span class="p">;</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">fixedPosition</span><span class="o">&amp;&amp;</span><span class="nx">k</span><span class="p">.</span><span class="nx">position</span><span class="o">===</span><span class="s2">&quot;fixed&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">l</span><span class="o">+=</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">h</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">,</span><span class="nx">i</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">),</span><span class="nx">m</span><span class="o">+=</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">h</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="p">,</span><span class="nx">i</span><span class="p">.</span><span class="nx">scrollLeft</span><span class="p">));</span><span class="k">return</span><span class="p">{</span><span class="nx">top</span><span class="o">:</span><span class="nx">l</span><span class="p">,</span><span class="nx">left</span><span class="o">:</span><span class="nx">m</span><span class="p">}},</span><span class="nx">f</span><span class="p">.</span><span class="nx">offset</span><span class="o">=</span><span class="p">{</span><span class="nx">bodyOffset</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">offsetTop</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">offsetLeft</span><span class="p">;</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">doesNotIncludeMarginInBodyOffset</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">b</span><span class="o">+=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;marginTop&quot;</span><span class="p">))</span><span class="o">||</span><span class="mi">0</span><span class="p">,</span><span class="nx">c</span><span class="o">+=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;marginLeft&quot;</span><span class="p">))</span><span class="o">||</span><span class="mi">0</span><span class="p">);</span><span class="k">return</span><span class="p">{</span><span class="nx">top</span><span class="o">:</span><span class="nx">b</span><span class="p">,</span><span class="nx">left</span><span class="o">:</span><span class="nx">c</span><span class="p">}},</span><span class="nx">setOffset</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;position&quot;</span><span class="p">);</span><span class="nx">d</span><span class="o">===</span><span class="s2">&quot;static&quot;</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span><span class="o">=</span><span class="s2">&quot;relative&quot;</span><span class="p">);</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="nx">f</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span><span class="nx">g</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">offset</span><span class="p">(),</span><span class="nx">h</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;top&quot;</span><span class="p">),</span><span class="nx">i</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;left&quot;</span><span class="p">),</span><span class="nx">j</span><span class="o">=</span><span class="p">(</span><span class="nx">d</span><span class="o">===</span><span class="s2">&quot;absolute&quot;</span><span class="o">||</span><span class="nx">d</span><span class="o">===</span><span class="s2">&quot;fixed&quot;</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">inArray</span><span class="p">(</span><span class="s2">&quot;auto&quot;</span><span class="p">,[</span><span class="nx">h</span><span class="p">,</span><span class="nx">i</span><span class="p">])</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="p">{},</span><span class="nx">l</span><span class="o">=</span><span class="p">{},</span><span class="nx">m</span><span class="p">,</span><span class="nx">n</span><span class="p">;</span><span class="nx">j</span><span class="o">?</span><span class="p">(</span><span class="nx">l</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">position</span><span class="p">(),</span><span class="nx">m</span><span class="o">=</span><span class="nx">l</span><span class="p">.</span><span class="nx">top</span><span class="p">,</span><span class="nx">n</span><span class="o">=</span><span class="nx">l</span><span class="p">.</span><span class="nx">left</span><span class="p">)</span><span class="o">:</span><span class="p">(</span><span class="nx">m</span><span class="o">=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">h</span><span class="p">)</span><span class="o">||</span><span class="mi">0</span><span class="p">,</span><span class="nx">n</span><span class="o">=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span><span class="o">||</span><span class="mi">0</span><span class="p">),</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">b</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">g</span><span class="p">)),</span><span class="nx">b</span><span class="p">.</span><span class="nx">top</span><span class="o">!=</span><span class="kc">null</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">k</span><span class="p">.</span><span class="nx">top</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">top</span><span class="o">-</span><span class="nx">g</span><span class="p">.</span><span class="nx">top</span><span class="o">+</span><span class="nx">m</span><span class="p">),</span><span class="nx">b</span><span class="p">.</span><span class="nx">left</span><span class="o">!=</span><span class="kc">null</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">k</span><span class="p">.</span><span class="nx">left</span><span class="o">=</span><span class="nx">b</span><span class="p">.</span><span class="nx">left</span><span class="o">-</span><span class="nx">g</span><span class="p">.</span><span class="nx">left</span><span class="o">+</span><span class="nx">n</span><span class="p">),</span><span class="s2">&quot;using&quot;</span><span class="k">in</span> <span class="nx">b</span><span class="o">?</span><span class="nx">b</span><span class="p">.</span><span class="nx">using</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">k</span><span class="p">)</span><span class="o">:</span><span class="nx">e</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">k</span><span class="p">)}},</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">position</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="k">return</span> <span class="kc">null</span><span class="p">;</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">b</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">offsetParent</span><span class="p">(),</span><span class="nx">c</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="p">(),</span><span class="nx">d</span><span class="o">=</span><span class="nx">cx</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">nodeName</span><span class="p">)</span><span class="o">?</span><span class="p">{</span><span class="nx">top</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">left</span><span class="o">:</span><span class="mi">0</span><span class="p">}</span><span class="o">:</span><span class="nx">b</span><span class="p">.</span><span class="nx">offset</span><span class="p">();</span><span class="nx">c</span><span class="p">.</span><span class="nx">top</span><span class="o">-=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;marginTop&quot;</span><span class="p">))</span><span class="o">||</span><span class="mi">0</span><span class="p">,</span><span class="nx">c</span><span class="p">.</span><span class="nx">left</span><span class="o">-=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;marginLeft&quot;</span><span class="p">))</span><span class="o">||</span><span class="mi">0</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">top</span><span class="o">+=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;borderTopWidth&quot;</span><span class="p">))</span><span class="o">||</span><span class="mi">0</span><span class="p">,</span><span class="nx">d</span><span class="p">.</span><span class="nx">left</span><span class="o">+=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;borderLeftWidth&quot;</span><span class="p">))</span><span class="o">||</span><span class="mi">0</span><span class="p">;</span><span class="k">return</span><span class="p">{</span><span class="nx">top</span><span class="o">:</span><span class="nx">c</span><span class="p">.</span><span class="nx">top</span><span class="o">-</span><span class="nx">d</span><span class="p">.</span><span class="nx">top</span><span class="p">,</span><span class="nx">left</span><span class="o">:</span><span class="nx">c</span><span class="p">.</span><span class="nx">left</span><span class="o">-</span><span class="nx">d</span><span class="p">.</span><span class="nx">left</span><span class="p">}},</span><span class="nx">offsetParent</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">offsetParent</span><span class="o">||</span><span class="nx">c</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="nx">a</span><span class="o">&amp;&amp;!</span><span class="nx">cx</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="s2">&quot;position&quot;</span><span class="p">)</span><span class="o">===</span><span class="s2">&quot;static&quot;</span><span class="p">)</span><span class="nx">a</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">offsetParent</span><span class="p">;</span><span class="k">return</span> <span class="nx">a</span><span class="p">})}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">([</span><span class="s2">&quot;Left&quot;</span><span class="p">,</span><span class="s2">&quot;Top&quot;</span><span class="p">],</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="s2">&quot;scroll&quot;</span><span class="o">+</span><span class="nx">c</span><span class="p">;</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="p">,</span><span class="nx">g</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="o">===</span><span class="nx">b</span><span class="p">){</span><span class="nx">e</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">e</span><span class="p">)</span><span class="k">return</span> <span class="kc">null</span><span class="p">;</span><span class="nx">g</span><span class="o">=</span><span class="nx">cy</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span><span class="k">return</span> <span class="nx">g</span><span class="o">?</span><span class="s2">&quot;pageXOffset&quot;</span><span class="k">in</span> <span class="nx">g</span><span class="o">?</span><span class="nx">g</span><span class="p">[</span><span class="nx">a</span><span class="o">?</span><span class="s2">&quot;pageYOffset&quot;</span><span class="o">:</span><span class="s2">&quot;pageXOffset&quot;</span><span class="p">]</span><span class="o">:</span><span class="nx">f</span><span class="p">.</span><span class="nx">support</span><span class="p">.</span><span class="nx">boxModel</span><span class="o">&amp;&amp;</span><span class="nx">g</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">||</span><span class="nx">g</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">:</span><span class="nx">e</span><span class="p">[</span><span class="nx">d</span><span class="p">]}</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">g</span><span class="o">=</span><span class="nx">cy</span><span class="p">(</span><span class="k">this</span><span class="p">),</span><span class="nx">g</span><span class="o">?</span><span class="nx">g</span><span class="p">.</span><span class="nx">scrollTo</span><span class="p">(</span><span class="nx">a</span><span class="o">?</span><span class="nx">f</span><span class="p">(</span><span class="nx">g</span><span class="p">).</span><span class="nx">scrollLeft</span><span class="p">()</span><span class="o">:</span><span class="nx">c</span><span class="p">,</span><span class="nx">a</span><span class="o">?</span><span class="nx">c</span><span class="o">:</span><span class="nx">f</span><span class="p">(</span><span class="nx">g</span><span class="p">).</span><span class="nx">scrollTop</span><span class="p">())</span><span class="o">:</span><span class="k">this</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">=</span><span class="nx">c</span><span class="p">})}}),</span><span class="nx">f</span><span class="p">.</span><span class="nx">each</span><span class="p">([</span><span class="s2">&quot;Height&quot;</span><span class="p">,</span><span class="s2">&quot;Width&quot;</span><span class="p">],</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">){</span><span class="kd">var</span> <span class="nx">d</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">[</span><span class="s2">&quot;inner&quot;</span><span class="o">+</span><span class="nx">c</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="k">return</span> <span class="nx">a</span><span class="o">?</span><span class="nx">a</span><span class="p">.</span><span class="nx">style</span><span class="o">?</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="s2">&quot;padding&quot;</span><span class="p">))</span><span class="o">:</span><span class="k">this</span><span class="p">[</span><span class="nx">d</span><span class="p">]()</span><span class="o">:</span><span class="kc">null</span><span class="p">},</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">[</span><span class="s2">&quot;outer&quot;</span><span class="o">+</span><span class="nx">c</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="k">return</span> <span class="nx">b</span><span class="o">?</span><span class="nx">b</span><span class="p">.</span><span class="nx">style</span><span class="o">?</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="o">?</span><span class="s2">&quot;margin&quot;</span><span class="o">:</span><span class="s2">&quot;border&quot;</span><span class="p">))</span><span class="o">:</span><span class="k">this</span><span class="p">[</span><span class="nx">d</span><span class="p">]()</span><span class="o">:</span><span class="kc">null</span><span class="p">},</span><span class="nx">f</span><span class="p">.</span><span class="nx">fn</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">e</span><span class="p">)</span><span class="k">return</span> <span class="nx">a</span><span class="o">==</span><span class="kc">null</span><span class="o">?</span><span class="kc">null</span><span class="o">:</span><span class="k">this</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">c</span><span class="o">=</span><span class="nx">f</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="nx">c</span><span class="p">[</span><span class="nx">d</span><span class="p">](</span><span class="nx">a</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">[</span><span class="nx">d</span><span class="p">]()))});</span><span class="k">if</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">isWindow</span><span class="p">(</span><span class="nx">e</span><span class="p">)){</span><span class="kd">var</span> <span class="nx">g</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">[</span><span class="s2">&quot;client&quot;</span><span class="o">+</span><span class="nx">c</span><span class="p">],</span><span class="nx">h</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span><span class="k">return</span> <span class="nx">e</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">compatMode</span><span class="o">===</span><span class="s2">&quot;CSS1Compat&quot;</span><span class="o">&amp;&amp;</span><span class="nx">g</span><span class="o">||</span><span class="nx">h</span><span class="o">&amp;&amp;</span><span class="nx">h</span><span class="p">[</span><span class="s2">&quot;client&quot;</span><span class="o">+</span><span class="nx">c</span><span class="p">]</span><span class="o">||</span><span class="nx">g</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">===</span><span class="mi">9</span><span class="p">)</span><span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">[</span><span class="s2">&quot;client&quot;</span><span class="o">+</span><span class="nx">c</span><span class="p">],</span><span class="nx">e</span><span class="p">.</span><span class="nx">body</span><span class="p">[</span><span class="s2">&quot;scroll&quot;</span><span class="o">+</span><span class="nx">c</span><span class="p">],</span><span class="nx">e</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">[</span><span class="s2">&quot;scroll&quot;</span><span class="o">+</span><span class="nx">c</span><span class="p">],</span><span class="nx">e</span><span class="p">.</span><span class="nx">body</span><span class="p">[</span><span class="s2">&quot;offset&quot;</span><span class="o">+</span><span class="nx">c</span><span class="p">],</span><span class="nx">e</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">[</span><span class="s2">&quot;offset&quot;</span><span class="o">+</span><span class="nx">c</span><span class="p">]);</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">===</span><span class="nx">b</span><span class="p">){</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="nx">f</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="nx">d</span><span class="p">),</span><span class="nx">j</span><span class="o">=</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span><span class="k">return</span> <span class="nx">f</span><span class="p">.</span><span class="nx">isNumeric</span><span class="p">(</span><span class="nx">j</span><span class="p">)</span><span class="o">?</span><span class="nx">j</span><span class="o">:</span><span class="nx">i</span><span class="p">}</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="k">typeof</span> <span class="nx">a</span><span class="o">==</span><span class="s2">&quot;string&quot;</span><span class="o">?</span><span class="nx">a</span><span class="o">:</span><span class="nx">a</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">)}}),</span><span class="nx">a</span><span class="p">.</span><span class="nx">jQuery</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">$</span><span class="o">=</span><span class="nx">f</span><span class="p">,</span><span class="k">typeof</span> <span class="nx">define</span><span class="o">==</span><span class="s2">&quot;function&quot;</span><span class="o">&amp;&amp;</span><span class="nx">define</span><span class="p">.</span><span class="nx">amd</span><span class="o">&amp;&amp;</span><span class="nx">define</span><span class="p">.</span><span class="nx">amd</span><span class="p">.</span><span class="nx">jQuery</span><span class="o">&amp;&amp;</span><span class="nx">define</span><span class="p">(</span><span class="s2">&quot;jquery&quot;</span><span class="p">,[],</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">f</span><span class="p">})})(</span><span class="nb">window</span><span class="p">);</span><span class="c1">// BEGIN Math.uuid.js</span>

<span class="cm">/*!</span>
<span class="cm">Math.uuid.js (v1.4)</span>
<span class="cm">http://www.broofa.com</span>
<span class="cm">mailto:robert@broofa.com</span>

<span class="cm">Copyright (c) 2010 Robert Kieffer</span>
<span class="cm">Dual licensed under the MIT and GPL licenses.</span>
<span class="cm">*/</span>

<span class="cm">/*</span>
<span class="cm"> * Generate a random uuid.</span>
<span class="cm"> *</span>
<span class="cm"> * USAGE: Math.uuid(length, radix)</span>
<span class="cm"> *   length - the desired number of characters</span>
<span class="cm"> *   radix  - the number of allowable values for each character.</span>
<span class="cm"> *</span>
<span class="cm"> * EXAMPLES:</span>
<span class="cm"> *   // No arguments  - returns RFC4122, version 4 ID</span>
<span class="cm"> *   &gt;&gt;&gt; Math.uuid()</span>
<span class="cm"> *   &quot;92329D39-6F5C-4520-ABFC-AAB64544E172&quot;</span>
<span class="cm"> *</span>
<span class="cm"> *   // One argument - returns ID of the specified length</span>
<span class="cm"> *   &gt;&gt;&gt; Math.uuid(15)     // 15 character ID (default base=62)</span>
<span class="cm"> *   &quot;VcydxgltxrVZSTV&quot;</span>
<span class="cm"> *</span>
<span class="cm"> *   // Two arguments - returns ID of the specified length, and radix. (Radix must be &lt;= 62)</span>
<span class="cm"> *   &gt;&gt;&gt; Math.uuid(8, 2)  // 8 character ID (base=2)</span>
<span class="cm"> *   &quot;01001010&quot;</span>
<span class="cm"> *   &gt;&gt;&gt; Math.uuid(8, 10) // 8 character ID (base=10)</span>
<span class="cm"> *   &quot;47473046&quot;</span>
<span class="cm"> *   &gt;&gt;&gt; Math.uuid(8, 16) // 8 character ID (base=16)</span>
<span class="cm"> *   &quot;098F4D35&quot;</span>
<span class="cm"> */</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Private array of chars to use</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">CHARS</span> <span class="o">=</span> <span class="s1">&#39;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&#39;</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>

  <span class="nb">Math</span><span class="p">.</span><span class="nx">uuid</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">len</span><span class="p">,</span> <span class="nx">radix</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">chars</span> <span class="o">=</span> <span class="nx">CHARS</span><span class="p">,</span> <span class="nx">uuid</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="nx">radix</span> <span class="o">=</span> <span class="nx">radix</span> <span class="o">||</span> <span class="nx">chars</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">len</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Compact form</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="nx">uuid</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">chars</span><span class="p">[</span><span class="mi">0</span> <span class="o">|</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="nx">radix</span><span class="p">];</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>rfc4122, version 4 form</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">r</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>rfc4122 requires these characters</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">uuid</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="nx">uuid</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="nx">uuid</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="nx">uuid</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">;</span>
      <span class="nx">uuid</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;4&#39;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Fill in random data.  At i==19 set the high bits of clock sequence as
per rfc4122, sec. 4.1.5</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">36</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">uuid</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="p">{</span>
          <span class="nx">r</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">|</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="mi">16</span><span class="p">;</span>
          <span class="nx">uuid</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">chars</span><span class="p">[(</span><span class="nx">i</span> <span class="o">==</span> <span class="mi">19</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="nx">r</span> <span class="o">&amp;</span> <span class="mh">0x3</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0x8</span> <span class="o">:</span> <span class="nx">r</span><span class="p">];</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">uuid</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>A more performant, but slightly bulkier, RFC4122v4 solution.  We boost performance
by minimizing calls to random()</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nb">Math</span><span class="p">.</span><span class="nx">uuidFast</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">chars</span> <span class="o">=</span> <span class="nx">CHARS</span><span class="p">,</span> <span class="nx">uuid</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">36</span><span class="p">),</span> <span class="nx">rnd</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">r</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">36</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">i</span><span class="o">==</span><span class="mi">8</span> <span class="o">||</span> <span class="nx">i</span><span class="o">==</span><span class="mi">13</span> <span class="o">||</span>  <span class="nx">i</span><span class="o">==</span><span class="mi">18</span> <span class="o">||</span> <span class="nx">i</span><span class="o">==</span><span class="mi">23</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">uuid</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">i</span><span class="o">==</span><span class="mi">14</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">uuid</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;4&#39;</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">rnd</span> <span class="o">&lt;=</span> <span class="mh">0x02</span><span class="p">)</span> <span class="nx">rnd</span> <span class="o">=</span> <span class="mh">0x2000000</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="mh">0x1000000</span><span class="p">)</span><span class="o">|</span><span class="mi">0</span><span class="p">;</span>
        <span class="nx">r</span> <span class="o">=</span> <span class="nx">rnd</span> <span class="o">&amp;</span> <span class="mh">0xf</span><span class="p">;</span>
        <span class="nx">rnd</span> <span class="o">=</span> <span class="nx">rnd</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">;</span>
        <span class="nx">uuid</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">chars</span><span class="p">[(</span><span class="nx">i</span> <span class="o">==</span> <span class="mi">19</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="nx">r</span> <span class="o">&amp;</span> <span class="mh">0x3</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0x8</span> <span class="o">:</span> <span class="nx">r</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">uuid</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>A more compact, but less performant, RFC4122v4 solution:</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nb">Math</span><span class="p">.</span><span class="nx">uuidCompact</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx&#39;</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[xy]/g</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="mi">16</span><span class="o">|</span><span class="mi">0</span><span class="p">,</span> <span class="nx">v</span> <span class="o">=</span> <span class="nx">c</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span> <span class="o">?</span> <span class="nx">r</span> <span class="o">:</span> <span class="p">(</span><span class="nx">r</span><span class="o">&amp;</span><span class="mh">0x3</span><span class="o">|</span><span class="mh">0x8</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">v</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>
    <span class="p">}).</span><span class="nx">toUpperCase</span><span class="p">();</span>
  <span class="p">};</span>
<span class="p">})();</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>END Math.uuid.js</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="cm">/**</span>
<span class="cm">*</span>
<span class="cm">*  MD5 (Message-Digest Algorithm)</span>
<span class="cm">*</span>
<span class="cm">*  For original source see http://www.webtoolkit.info/</span>
<span class="cm">*  Download: 15.02.2009 from http://www.webtoolkit.info/javascript-md5.html</span>
<span class="cm">*</span>
<span class="cm">*  Licensed under CC-BY 2.0 License</span>
<span class="cm">*  (http://creativecommons.org/licenses/by/2.0/uk/)</span>
<span class="cm">*</span>
<span class="cm">**/</span>

<span class="kd">var</span> <span class="nx">Crypto</span> <span class="o">=</span> <span class="p">{};</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">Crypto</span><span class="p">.</span><span class="nx">MD5</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>

    <span class="kd">function</span> <span class="nx">RotateLeft</span><span class="p">(</span><span class="nx">lValue</span><span class="p">,</span> <span class="nx">iShiftBits</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">(</span><span class="nx">lValue</span><span class="o">&lt;&lt;</span><span class="nx">iShiftBits</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="nx">lValue</span><span class="o">&gt;&gt;&gt;</span><span class="p">(</span><span class="mi">32</span><span class="o">-</span><span class="nx">iShiftBits</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">lX</span><span class="p">,</span><span class="nx">lY</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">lX4</span><span class="p">,</span><span class="nx">lY4</span><span class="p">,</span><span class="nx">lX8</span><span class="p">,</span><span class="nx">lY8</span><span class="p">,</span><span class="nx">lResult</span><span class="p">;</span>
      <span class="nx">lX8</span> <span class="o">=</span> <span class="p">(</span><span class="nx">lX</span> <span class="o">&amp;</span> <span class="mh">0x80000000</span><span class="p">);</span>
      <span class="nx">lY8</span> <span class="o">=</span> <span class="p">(</span><span class="nx">lY</span> <span class="o">&amp;</span> <span class="mh">0x80000000</span><span class="p">);</span>
      <span class="nx">lX4</span> <span class="o">=</span> <span class="p">(</span><span class="nx">lX</span> <span class="o">&amp;</span> <span class="mh">0x40000000</span><span class="p">);</span>
      <span class="nx">lY4</span> <span class="o">=</span> <span class="p">(</span><span class="nx">lY</span> <span class="o">&amp;</span> <span class="mh">0x40000000</span><span class="p">);</span>
      <span class="nx">lResult</span> <span class="o">=</span> <span class="p">(</span><span class="nx">lX</span> <span class="o">&amp;</span> <span class="mh">0x3FFFFFFF</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="nx">lY</span> <span class="o">&amp;</span> <span class="mh">0x3FFFFFFF</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">lX4</span> <span class="o">&amp;</span> <span class="nx">lY4</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="nx">lResult</span> <span class="o">^</span> <span class="mh">0x80000000</span> <span class="o">^</span> <span class="nx">lX8</span> <span class="o">^</span> <span class="nx">lY8</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">lX4</span> <span class="o">|</span> <span class="nx">lY4</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">lResult</span> <span class="o">&amp;</span> <span class="mh">0x40000000</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="p">(</span><span class="nx">lResult</span> <span class="o">^</span> <span class="mh">0xC0000000</span> <span class="o">^</span> <span class="nx">lX8</span> <span class="o">^</span> <span class="nx">lY8</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="k">return</span> <span class="p">(</span><span class="nx">lResult</span> <span class="o">^</span> <span class="mh">0x40000000</span> <span class="o">^</span> <span class="nx">lX8</span> <span class="o">^</span> <span class="nx">lY8</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="nx">lResult</span> <span class="o">^</span> <span class="nx">lX8</span> <span class="o">^</span> <span class="nx">lY8</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">F</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">,</span><span class="nx">z</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="p">(</span><span class="nx">x</span> <span class="o">&amp;</span> <span class="nx">y</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="o">~</span><span class="nx">x</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nx">z</span><span class="p">);</span> <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">G</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">,</span><span class="nx">z</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="p">(</span><span class="nx">x</span> <span class="o">&amp;</span> <span class="nx">z</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="nx">y</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="nx">z</span><span class="p">));</span> <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">H</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">,</span><span class="nx">z</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="p">(</span><span class="nx">x</span> <span class="o">^</span> <span class="nx">y</span> <span class="o">^</span> <span class="nx">z</span><span class="p">);</span> <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">I</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">,</span><span class="nx">z</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="p">(</span><span class="nx">y</span> <span class="o">^</span> <span class="p">(</span><span class="nx">x</span> <span class="o">|</span> <span class="p">(</span><span class="o">~</span><span class="nx">z</span><span class="p">)));</span> <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">FF</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">,</span><span class="nx">s</span><span class="p">,</span><span class="nx">ac</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">a</span> <span class="o">=</span> <span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">F</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">d</span><span class="p">),</span> <span class="nx">x</span><span class="p">),</span> <span class="nx">ac</span><span class="p">));</span>
      <span class="k">return</span> <span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">RotateLeft</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">s</span><span class="p">),</span> <span class="nx">b</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="kd">function</span> <span class="nx">GG</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">,</span><span class="nx">s</span><span class="p">,</span><span class="nx">ac</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">a</span> <span class="o">=</span> <span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">G</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">d</span><span class="p">),</span> <span class="nx">x</span><span class="p">),</span> <span class="nx">ac</span><span class="p">));</span>
      <span class="k">return</span> <span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">RotateLeft</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">s</span><span class="p">),</span> <span class="nx">b</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="kd">function</span> <span class="nx">HH</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">,</span><span class="nx">s</span><span class="p">,</span><span class="nx">ac</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">a</span> <span class="o">=</span> <span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">H</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">d</span><span class="p">),</span> <span class="nx">x</span><span class="p">),</span> <span class="nx">ac</span><span class="p">));</span>
      <span class="k">return</span> <span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">RotateLeft</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">s</span><span class="p">),</span> <span class="nx">b</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="kd">function</span> <span class="nx">II</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">,</span><span class="nx">s</span><span class="p">,</span><span class="nx">ac</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">a</span> <span class="o">=</span> <span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">I</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">d</span><span class="p">),</span> <span class="nx">x</span><span class="p">),</span> <span class="nx">ac</span><span class="p">));</span>
      <span class="k">return</span> <span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">RotateLeft</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">s</span><span class="p">),</span> <span class="nx">b</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="kd">function</span> <span class="nx">ConvertToWordArray</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">lWordCount</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">lMessageLength</span> <span class="o">=</span> <span class="nx">string</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">lNumberOfWords_temp1</span><span class="o">=</span><span class="nx">lMessageLength</span> <span class="o">+</span> <span class="mi">8</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">lNumberOfWords_temp2</span><span class="o">=</span><span class="p">(</span><span class="nx">lNumberOfWords_temp1</span><span class="o">-</span><span class="p">(</span><span class="nx">lNumberOfWords_temp1</span> <span class="o">%</span> <span class="mi">64</span><span class="p">))</span><span class="o">/</span><span class="mi">64</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">lNumberOfWords</span> <span class="o">=</span> <span class="p">(</span><span class="nx">lNumberOfWords_temp2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">16</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">lWordArray</span><span class="o">=</span><span class="nb">Array</span><span class="p">(</span><span class="nx">lNumberOfWords</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">lBytePosition</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">lByteCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">while</span> <span class="p">(</span> <span class="nx">lByteCount</span> <span class="o">&lt;</span> <span class="nx">lMessageLength</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">lWordCount</span> <span class="o">=</span> <span class="p">(</span><span class="nx">lByteCount</span><span class="o">-</span><span class="p">(</span><span class="nx">lByteCount</span> <span class="o">%</span> <span class="mi">4</span><span class="p">))</span><span class="o">/</span><span class="mi">4</span><span class="p">;</span>
        <span class="nx">lBytePosition</span> <span class="o">=</span> <span class="p">(</span><span class="nx">lByteCount</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="mi">8</span><span class="p">;</span>
        <span class="nx">lWordArray</span><span class="p">[</span><span class="nx">lWordCount</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nx">lWordArray</span><span class="p">[</span><span class="nx">lWordCount</span><span class="p">]</span> <span class="o">|</span> <span class="p">(</span><span class="nx">string</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">lByteCount</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="nx">lBytePosition</span><span class="p">));</span>
        <span class="nx">lByteCount</span><span class="o">++</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">lWordCount</span> <span class="o">=</span> <span class="p">(</span><span class="nx">lByteCount</span><span class="o">-</span><span class="p">(</span><span class="nx">lByteCount</span> <span class="o">%</span> <span class="mi">4</span><span class="p">))</span><span class="o">/</span><span class="mi">4</span><span class="p">;</span>
      <span class="nx">lBytePosition</span> <span class="o">=</span> <span class="p">(</span><span class="nx">lByteCount</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="mi">8</span><span class="p">;</span>
      <span class="nx">lWordArray</span><span class="p">[</span><span class="nx">lWordCount</span><span class="p">]</span> <span class="o">=</span> <span class="nx">lWordArray</span><span class="p">[</span><span class="nx">lWordCount</span><span class="p">]</span> <span class="o">|</span> <span class="p">(</span><span class="mh">0x80</span><span class="o">&lt;&lt;</span><span class="nx">lBytePosition</span><span class="p">);</span>
      <span class="nx">lWordArray</span><span class="p">[</span><span class="nx">lNumberOfWords</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nx">lMessageLength</span><span class="o">&lt;&lt;</span><span class="mi">3</span><span class="p">;</span>
      <span class="nx">lWordArray</span><span class="p">[</span><span class="nx">lNumberOfWords</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">lMessageLength</span><span class="o">&gt;&gt;&gt;</span><span class="mi">29</span><span class="p">;</span>
      <span class="k">return</span> <span class="nx">lWordArray</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="kd">function</span> <span class="nx">WordToHex</span><span class="p">(</span><span class="nx">lValue</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">WordToHexValue</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">WordToHexValue_temp</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">lByte</span><span class="p">,</span><span class="nx">lCount</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="nx">lCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="nx">lCount</span><span class="o">&lt;=</span><span class="mi">3</span><span class="p">;</span><span class="nx">lCount</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">lByte</span> <span class="o">=</span> <span class="p">(</span><span class="nx">lValue</span><span class="o">&gt;&gt;&gt;</span><span class="p">(</span><span class="nx">lCount</span><span class="o">*</span><span class="mi">8</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mi">255</span><span class="p">;</span>
        <span class="nx">WordToHexValue_temp</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span> <span class="o">+</span> <span class="nx">lByte</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>
        <span class="nx">WordToHexValue</span> <span class="o">=</span> <span class="nx">WordToHexValue</span> <span class="o">+</span> <span class="nx">WordToHexValue_temp</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">WordToHexValue_temp</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">WordToHexValue</span><span class="p">;</span>
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>**    function Utf8Encode(string) removed. Aready defined in pidcrypt_utils.js</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">x</span><span class="o">=</span><span class="nb">Array</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">k</span><span class="p">,</span><span class="nx">AA</span><span class="p">,</span><span class="nx">BB</span><span class="p">,</span><span class="nx">CC</span><span class="p">,</span><span class="nx">DD</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">S11</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="nx">S12</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="nx">S13</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="nx">S14</span><span class="o">=</span><span class="mi">22</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">S21</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="nx">S22</span><span class="o">=</span><span class="mi">9</span> <span class="p">,</span> <span class="nx">S23</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="nx">S24</span><span class="o">=</span><span class="mi">20</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">S31</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="nx">S32</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="nx">S33</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="nx">S34</span><span class="o">=</span><span class="mi">23</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">S41</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="nx">S42</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="nx">S43</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="nx">S44</span><span class="o">=</span><span class="mi">21</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>string = Utf8Encode(string); #function call removed</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">x</span> <span class="o">=</span> <span class="nx">ConvertToWordArray</span><span class="p">(</span><span class="nx">string</span><span class="p">);</span>

    <span class="nx">a</span> <span class="o">=</span> <span class="mh">0x67452301</span><span class="p">;</span> <span class="nx">b</span> <span class="o">=</span> <span class="mh">0xEFCDAB89</span><span class="p">;</span> <span class="nx">c</span> <span class="o">=</span> <span class="mh">0x98BADCFE</span><span class="p">;</span> <span class="nx">d</span> <span class="o">=</span> <span class="mh">0x10325476</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="nx">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">k</span><span class="o">&lt;</span><span class="nx">x</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">k</span><span class="o">+=</span><span class="mi">16</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">AA</span><span class="o">=</span><span class="nx">a</span><span class="p">;</span> <span class="nx">BB</span><span class="o">=</span><span class="nx">b</span><span class="p">;</span> <span class="nx">CC</span><span class="o">=</span><span class="nx">c</span><span class="p">;</span> <span class="nx">DD</span><span class="o">=</span><span class="nx">d</span><span class="p">;</span>
      <span class="nx">a</span><span class="o">=</span><span class="nx">FF</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">0</span><span class="p">],</span> <span class="nx">S11</span><span class="p">,</span><span class="mh">0xD76AA478</span><span class="p">);</span>
      <span class="nx">d</span><span class="o">=</span><span class="nx">FF</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="nx">S12</span><span class="p">,</span><span class="mh">0xE8C7B756</span><span class="p">);</span>
      <span class="nx">c</span><span class="o">=</span><span class="nx">FF</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span> <span class="nx">S13</span><span class="p">,</span><span class="mh">0x242070DB</span><span class="p">);</span>
      <span class="nx">b</span><span class="o">=</span><span class="nx">FF</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">3</span><span class="p">],</span> <span class="nx">S14</span><span class="p">,</span><span class="mh">0xC1BDCEEE</span><span class="p">);</span>
      <span class="nx">a</span><span class="o">=</span><span class="nx">FF</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">4</span><span class="p">],</span> <span class="nx">S11</span><span class="p">,</span><span class="mh">0xF57C0FAF</span><span class="p">);</span>
      <span class="nx">d</span><span class="o">=</span><span class="nx">FF</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">5</span><span class="p">],</span> <span class="nx">S12</span><span class="p">,</span><span class="mh">0x4787C62A</span><span class="p">);</span>
      <span class="nx">c</span><span class="o">=</span><span class="nx">FF</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">6</span><span class="p">],</span> <span class="nx">S13</span><span class="p">,</span><span class="mh">0xA8304613</span><span class="p">);</span>
      <span class="nx">b</span><span class="o">=</span><span class="nx">FF</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">7</span><span class="p">],</span> <span class="nx">S14</span><span class="p">,</span><span class="mh">0xFD469501</span><span class="p">);</span>
      <span class="nx">a</span><span class="o">=</span><span class="nx">FF</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">8</span><span class="p">],</span> <span class="nx">S11</span><span class="p">,</span><span class="mh">0x698098D8</span><span class="p">);</span>
      <span class="nx">d</span><span class="o">=</span><span class="nx">FF</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">9</span><span class="p">],</span> <span class="nx">S12</span><span class="p">,</span><span class="mh">0x8B44F7AF</span><span class="p">);</span>
      <span class="nx">c</span><span class="o">=</span><span class="nx">FF</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">10</span><span class="p">],</span><span class="nx">S13</span><span class="p">,</span><span class="mh">0xFFFF5BB1</span><span class="p">);</span>
      <span class="nx">b</span><span class="o">=</span><span class="nx">FF</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">11</span><span class="p">],</span><span class="nx">S14</span><span class="p">,</span><span class="mh">0x895CD7BE</span><span class="p">);</span>
      <span class="nx">a</span><span class="o">=</span><span class="nx">FF</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">12</span><span class="p">],</span><span class="nx">S11</span><span class="p">,</span><span class="mh">0x6B901122</span><span class="p">);</span>
      <span class="nx">d</span><span class="o">=</span><span class="nx">FF</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">13</span><span class="p">],</span><span class="nx">S12</span><span class="p">,</span><span class="mh">0xFD987193</span><span class="p">);</span>
      <span class="nx">c</span><span class="o">=</span><span class="nx">FF</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">14</span><span class="p">],</span><span class="nx">S13</span><span class="p">,</span><span class="mh">0xA679438E</span><span class="p">);</span>
      <span class="nx">b</span><span class="o">=</span><span class="nx">FF</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">15</span><span class="p">],</span><span class="nx">S14</span><span class="p">,</span><span class="mh">0x49B40821</span><span class="p">);</span>
      <span class="nx">a</span><span class="o">=</span><span class="nx">GG</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="nx">S21</span><span class="p">,</span><span class="mh">0xF61E2562</span><span class="p">);</span>
      <span class="nx">d</span><span class="o">=</span><span class="nx">GG</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">6</span><span class="p">],</span> <span class="nx">S22</span><span class="p">,</span><span class="mh">0xC040B340</span><span class="p">);</span>
      <span class="nx">c</span><span class="o">=</span><span class="nx">GG</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">11</span><span class="p">],</span><span class="nx">S23</span><span class="p">,</span><span class="mh">0x265E5A51</span><span class="p">);</span>
      <span class="nx">b</span><span class="o">=</span><span class="nx">GG</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">0</span><span class="p">],</span> <span class="nx">S24</span><span class="p">,</span><span class="mh">0xE9B6C7AA</span><span class="p">);</span>
      <span class="nx">a</span><span class="o">=</span><span class="nx">GG</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">5</span><span class="p">],</span> <span class="nx">S21</span><span class="p">,</span><span class="mh">0xD62F105D</span><span class="p">);</span>
      <span class="nx">d</span><span class="o">=</span><span class="nx">GG</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">10</span><span class="p">],</span><span class="nx">S22</span><span class="p">,</span><span class="mh">0x2441453</span><span class="p">);</span>
      <span class="nx">c</span><span class="o">=</span><span class="nx">GG</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">15</span><span class="p">],</span><span class="nx">S23</span><span class="p">,</span><span class="mh">0xD8A1E681</span><span class="p">);</span>
      <span class="nx">b</span><span class="o">=</span><span class="nx">GG</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">4</span><span class="p">],</span> <span class="nx">S24</span><span class="p">,</span><span class="mh">0xE7D3FBC8</span><span class="p">);</span>
      <span class="nx">a</span><span class="o">=</span><span class="nx">GG</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">9</span><span class="p">],</span> <span class="nx">S21</span><span class="p">,</span><span class="mh">0x21E1CDE6</span><span class="p">);</span>
      <span class="nx">d</span><span class="o">=</span><span class="nx">GG</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">14</span><span class="p">],</span><span class="nx">S22</span><span class="p">,</span><span class="mh">0xC33707D6</span><span class="p">);</span>
      <span class="nx">c</span><span class="o">=</span><span class="nx">GG</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">3</span><span class="p">],</span> <span class="nx">S23</span><span class="p">,</span><span class="mh">0xF4D50D87</span><span class="p">);</span>
      <span class="nx">b</span><span class="o">=</span><span class="nx">GG</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">8</span><span class="p">],</span> <span class="nx">S24</span><span class="p">,</span><span class="mh">0x455A14ED</span><span class="p">);</span>
      <span class="nx">a</span><span class="o">=</span><span class="nx">GG</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">13</span><span class="p">],</span><span class="nx">S21</span><span class="p">,</span><span class="mh">0xA9E3E905</span><span class="p">);</span>
      <span class="nx">d</span><span class="o">=</span><span class="nx">GG</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span> <span class="nx">S22</span><span class="p">,</span><span class="mh">0xFCEFA3F8</span><span class="p">);</span>
      <span class="nx">c</span><span class="o">=</span><span class="nx">GG</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">7</span><span class="p">],</span> <span class="nx">S23</span><span class="p">,</span><span class="mh">0x676F02D9</span><span class="p">);</span>
      <span class="nx">b</span><span class="o">=</span><span class="nx">GG</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">12</span><span class="p">],</span><span class="nx">S24</span><span class="p">,</span><span class="mh">0x8D2A4C8A</span><span class="p">);</span>
      <span class="nx">a</span><span class="o">=</span><span class="nx">HH</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">5</span><span class="p">],</span> <span class="nx">S31</span><span class="p">,</span><span class="mh">0xFFFA3942</span><span class="p">);</span>
      <span class="nx">d</span><span class="o">=</span><span class="nx">HH</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">8</span><span class="p">],</span> <span class="nx">S32</span><span class="p">,</span><span class="mh">0x8771F681</span><span class="p">);</span>
      <span class="nx">c</span><span class="o">=</span><span class="nx">HH</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">11</span><span class="p">],</span><span class="nx">S33</span><span class="p">,</span><span class="mh">0x6D9D6122</span><span class="p">);</span>
      <span class="nx">b</span><span class="o">=</span><span class="nx">HH</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">14</span><span class="p">],</span><span class="nx">S34</span><span class="p">,</span><span class="mh">0xFDE5380C</span><span class="p">);</span>
      <span class="nx">a</span><span class="o">=</span><span class="nx">HH</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="nx">S31</span><span class="p">,</span><span class="mh">0xA4BEEA44</span><span class="p">);</span>
      <span class="nx">d</span><span class="o">=</span><span class="nx">HH</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">4</span><span class="p">],</span> <span class="nx">S32</span><span class="p">,</span><span class="mh">0x4BDECFA9</span><span class="p">);</span>
      <span class="nx">c</span><span class="o">=</span><span class="nx">HH</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">7</span><span class="p">],</span> <span class="nx">S33</span><span class="p">,</span><span class="mh">0xF6BB4B60</span><span class="p">);</span>
      <span class="nx">b</span><span class="o">=</span><span class="nx">HH</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">10</span><span class="p">],</span><span class="nx">S34</span><span class="p">,</span><span class="mh">0xBEBFBC70</span><span class="p">);</span>
      <span class="nx">a</span><span class="o">=</span><span class="nx">HH</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">13</span><span class="p">],</span><span class="nx">S31</span><span class="p">,</span><span class="mh">0x289B7EC6</span><span class="p">);</span>
      <span class="nx">d</span><span class="o">=</span><span class="nx">HH</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">0</span><span class="p">],</span> <span class="nx">S32</span><span class="p">,</span><span class="mh">0xEAA127FA</span><span class="p">);</span>
      <span class="nx">c</span><span class="o">=</span><span class="nx">HH</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">3</span><span class="p">],</span> <span class="nx">S33</span><span class="p">,</span><span class="mh">0xD4EF3085</span><span class="p">);</span>
      <span class="nx">b</span><span class="o">=</span><span class="nx">HH</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">6</span><span class="p">],</span> <span class="nx">S34</span><span class="p">,</span><span class="mh">0x4881D05</span><span class="p">);</span>
      <span class="nx">a</span><span class="o">=</span><span class="nx">HH</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">9</span><span class="p">],</span> <span class="nx">S31</span><span class="p">,</span><span class="mh">0xD9D4D039</span><span class="p">);</span>
      <span class="nx">d</span><span class="o">=</span><span class="nx">HH</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">12</span><span class="p">],</span><span class="nx">S32</span><span class="p">,</span><span class="mh">0xE6DB99E5</span><span class="p">);</span>
      <span class="nx">c</span><span class="o">=</span><span class="nx">HH</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">15</span><span class="p">],</span><span class="nx">S33</span><span class="p">,</span><span class="mh">0x1FA27CF8</span><span class="p">);</span>
      <span class="nx">b</span><span class="o">=</span><span class="nx">HH</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span> <span class="nx">S34</span><span class="p">,</span><span class="mh">0xC4AC5665</span><span class="p">);</span>
      <span class="nx">a</span><span class="o">=</span><span class="nx">II</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">0</span><span class="p">],</span> <span class="nx">S41</span><span class="p">,</span><span class="mh">0xF4292244</span><span class="p">);</span>
      <span class="nx">d</span><span class="o">=</span><span class="nx">II</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">7</span><span class="p">],</span> <span class="nx">S42</span><span class="p">,</span><span class="mh">0x432AFF97</span><span class="p">);</span>
      <span class="nx">c</span><span class="o">=</span><span class="nx">II</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">14</span><span class="p">],</span><span class="nx">S43</span><span class="p">,</span><span class="mh">0xAB9423A7</span><span class="p">);</span>
      <span class="nx">b</span><span class="o">=</span><span class="nx">II</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">5</span><span class="p">],</span> <span class="nx">S44</span><span class="p">,</span><span class="mh">0xFC93A039</span><span class="p">);</span>
      <span class="nx">a</span><span class="o">=</span><span class="nx">II</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">12</span><span class="p">],</span><span class="nx">S41</span><span class="p">,</span><span class="mh">0x655B59C3</span><span class="p">);</span>
      <span class="nx">d</span><span class="o">=</span><span class="nx">II</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">3</span><span class="p">],</span> <span class="nx">S42</span><span class="p">,</span><span class="mh">0x8F0CCC92</span><span class="p">);</span>
      <span class="nx">c</span><span class="o">=</span><span class="nx">II</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">10</span><span class="p">],</span><span class="nx">S43</span><span class="p">,</span><span class="mh">0xFFEFF47D</span><span class="p">);</span>
      <span class="nx">b</span><span class="o">=</span><span class="nx">II</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="nx">S44</span><span class="p">,</span><span class="mh">0x85845DD1</span><span class="p">);</span>
      <span class="nx">a</span><span class="o">=</span><span class="nx">II</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">8</span><span class="p">],</span> <span class="nx">S41</span><span class="p">,</span><span class="mh">0x6FA87E4F</span><span class="p">);</span>
      <span class="nx">d</span><span class="o">=</span><span class="nx">II</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">15</span><span class="p">],</span><span class="nx">S42</span><span class="p">,</span><span class="mh">0xFE2CE6E0</span><span class="p">);</span>
      <span class="nx">c</span><span class="o">=</span><span class="nx">II</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">6</span><span class="p">],</span> <span class="nx">S43</span><span class="p">,</span><span class="mh">0xA3014314</span><span class="p">);</span>
      <span class="nx">b</span><span class="o">=</span><span class="nx">II</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">13</span><span class="p">],</span><span class="nx">S44</span><span class="p">,</span><span class="mh">0x4E0811A1</span><span class="p">);</span>
      <span class="nx">a</span><span class="o">=</span><span class="nx">II</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">4</span><span class="p">],</span> <span class="nx">S41</span><span class="p">,</span><span class="mh">0xF7537E82</span><span class="p">);</span>
      <span class="nx">d</span><span class="o">=</span><span class="nx">II</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">11</span><span class="p">],</span><span class="nx">S42</span><span class="p">,</span><span class="mh">0xBD3AF235</span><span class="p">);</span>
      <span class="nx">c</span><span class="o">=</span><span class="nx">II</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span> <span class="nx">S43</span><span class="p">,</span><span class="mh">0x2AD7D2BB</span><span class="p">);</span>
      <span class="nx">b</span><span class="o">=</span><span class="nx">II</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">x</span><span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">9</span><span class="p">],</span> <span class="nx">S44</span><span class="p">,</span><span class="mh">0xEB86D391</span><span class="p">);</span>
      <span class="nx">a</span><span class="o">=</span><span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">AA</span><span class="p">);</span>
      <span class="nx">b</span><span class="o">=</span><span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">BB</span><span class="p">);</span>
      <span class="nx">c</span><span class="o">=</span><span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span><span class="nx">CC</span><span class="p">);</span>
      <span class="nx">d</span><span class="o">=</span><span class="nx">AddUnsigned</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">DD</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">temp</span> <span class="o">=</span> <span class="nx">WordToHex</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">+</span><span class="nx">WordToHex</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="o">+</span><span class="nx">WordToHex</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span><span class="o">+</span><span class="nx">WordToHex</span><span class="p">(</span><span class="nx">d</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">temp</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">})();</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>END Crypto.md5.js</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Pouch</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">Pouch</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Pouch</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="k">this</span> <span class="k">instanceof</span> <span class="nx">Pouch</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Pouch</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span> <span class="o">||</span> <span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
    <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">backend</span> <span class="o">=</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">parseAdapter</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">name</span> <span class="o">||</span> <span class="nx">name</span><span class="p">);</span>
  <span class="nx">opts</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">backend</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
  <span class="nx">opts</span><span class="p">.</span><span class="nx">adapter</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">adapter</span> <span class="o">||</span> <span class="nx">backend</span><span class="p">.</span><span class="nx">adapter</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Pouch</span><span class="p">.</span><span class="nx">adapters</span><span class="p">[</span><span class="nx">backend</span><span class="p">.</span><span class="nx">adapter</span><span class="p">])</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="s1">&#39;Adapter is missing&#39;</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Pouch</span><span class="p">.</span><span class="nx">adapters</span><span class="p">[</span><span class="nx">backend</span><span class="p">.</span><span class="nx">adapter</span><span class="p">].</span><span class="nx">valid</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="s1">&#39;Invalid Adapter&#39;</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">adapter</span> <span class="o">=</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">adapters</span><span class="p">[</span><span class="nx">backend</span><span class="p">.</span><span class="nx">adapter</span><span class="p">](</span><span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="k">in</span> <span class="nx">adapter</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">adapter</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
  <span class="p">}</span>
<span class="p">}</span>


<span class="nx">Pouch</span><span class="p">.</span><span class="nx">parseAdapter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>

  <span class="kd">var</span> <span class="nx">match</span> <span class="o">=</span> <span class="nx">name</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/([a-z\-]*):\/\/(.*)/</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">match</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>the http adapter expects the fully qualified name</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">name</span> <span class="o">=</span> <span class="sr">/http(s?)/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">?</span> <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;://&#39;</span> <span class="o">+</span> <span class="nx">match</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">:</span> <span class="nx">match</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">adapter</span> <span class="o">=</span> <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Pouch</span><span class="p">.</span><span class="nx">adapters</span><span class="p">[</span><span class="nx">adapter</span><span class="p">].</span><span class="nx">valid</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="s1">&#39;Invalid adapter&#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">adapter</span><span class="o">:</span> <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]};</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>the name didnt specify which adapter to use, so we just pick the first
valid one, we will probably add some bias to this (ie http should be last
fallback)</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">adapters</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Pouch</span><span class="p">.</span><span class="nx">adapters</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">valid</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">adapter</span><span class="o">:</span> <span class="nx">i</span><span class="p">};</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">throw</span> <span class="s1">&#39;No Valid Adapter.&#39;</span><span class="p">;</span>
<span class="p">}</span>


<span class="nx">Pouch</span><span class="p">.</span><span class="nx">destroy</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">opts</span> <span class="o">=</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">parseAdapter</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
  <span class="nx">Pouch</span><span class="p">.</span><span class="nx">adapters</span><span class="p">[</span><span class="nx">opts</span><span class="p">.</span><span class="nx">adapter</span><span class="p">].</span><span class="nx">destroy</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
<span class="p">};</span>


<span class="nx">Pouch</span><span class="p">.</span><span class="nx">adapters</span> <span class="o">=</span> <span class="p">{};</span>

<span class="nx">Pouch</span><span class="p">.</span><span class="nx">adapter</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">Pouch</span><span class="p">.</span><span class="nx">adapters</span><span class="p">[</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Enumerate errors, add the status code so we can reflect the HTTP api
in future</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Pouch</span><span class="p">.</span><span class="nx">Errors</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">MISSING_BULK_DOCS</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">status</span><span class="o">:</span> <span class="mi">400</span><span class="p">,</span>
    <span class="nx">error</span><span class="o">:</span> <span class="s1">&#39;bad_request&#39;</span><span class="p">,</span>
    <span class="nx">reason</span><span class="o">:</span> <span class="s2">&quot;Missing JSON list of &#39;docs&#39;&quot;</span>
  <span class="p">},</span>
  <span class="nx">MISSING_DOC</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">status</span><span class="o">:</span> <span class="mi">404</span><span class="p">,</span>
    <span class="nx">error</span><span class="o">:</span> <span class="s1">&#39;not_found&#39;</span><span class="p">,</span>
    <span class="nx">reason</span><span class="o">:</span> <span class="s1">&#39;missing&#39;</span>
  <span class="p">},</span>
  <span class="nx">REV_CONFLICT</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">status</span><span class="o">:</span> <span class="mi">409</span><span class="p">,</span>
    <span class="nx">error</span><span class="o">:</span> <span class="s1">&#39;conflict&#39;</span><span class="p">,</span>
    <span class="nx">reason</span><span class="o">:</span> <span class="s1">&#39;Document update conflict&#39;</span>
  <span class="p">},</span>
  <span class="nx">INVALID_ID</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">status</span><span class="o">:</span> <span class="mi">400</span><span class="p">,</span>
    <span class="nx">error</span><span class="o">:</span> <span class="s1">&#39;invalid_id&#39;</span><span class="p">,</span>
    <span class="nx">reason</span><span class="o">:</span> <span class="s1">&#39;_id field must contain a string&#39;</span>
  <span class="p">},</span>
  <span class="nx">RESERVED_ID</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">status</span><span class="o">:</span> <span class="mi">400</span><span class="p">,</span>
    <span class="nx">error</span><span class="o">:</span> <span class="s1">&#39;bad_request&#39;</span><span class="p">,</span>
    <span class="nx">reason</span><span class="o">:</span> <span class="s1">&#39;Only reserved document ids may start with underscore.&#39;</span>
  <span class="p">},</span>
  <span class="nx">UNKNOWN_ERROR</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">status</span><span class="o">:</span> <span class="mi">500</span><span class="p">,</span>
    <span class="nx">error</span><span class="o">:</span> <span class="s1">&#39;unknown_error&#39;</span><span class="p">,</span>
    <span class="nx">reason</span><span class="o">:</span> <span class="s1">&#39;Database encountered an unknown error&#39;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">module</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">global</span><span class="p">[</span><span class="s1">&#39;Pouch&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Pouch</span><span class="p">;</span>
  <span class="nx">Pouch</span><span class="p">.</span><span class="nx">merge</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./pouch.merge.js&#39;</span><span class="p">).</span><span class="nx">merge</span><span class="p">;</span>
  <span class="nx">Pouch</span><span class="p">.</span><span class="nx">collate</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./pouch.collate.js&#39;</span><span class="p">).</span><span class="nx">collate</span><span class="p">;</span>
  <span class="nx">Pouch</span><span class="p">.</span><span class="nx">replicate</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./pouch.replicate.js&#39;</span><span class="p">).</span><span class="nx">replicate</span><span class="p">;</span>
  <span class="nx">Pouch</span><span class="p">.</span><span class="nx">utils</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./pouch.utils.js&#39;</span><span class="p">);</span>
  <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">Pouch</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>load adapters known to work under node</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">adapters</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;leveldb&#39;</span><span class="p">,</span> <span class="s1">&#39;http&#39;</span><span class="p">];</span>
  <span class="nx">adapters</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">adapter</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">adapter_path</span> <span class="o">=</span> <span class="s1">&#39;./adapters/pouch.&#39;</span><span class="o">+</span><span class="nx">adapter</span><span class="o">+</span><span class="s1">&#39;.js&#39;</span><span class="p">;</span>
    <span class="nx">require</span><span class="p">(</span><span class="nx">adapter_path</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>a few hacks to get things in the right place for node.js</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">module</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">Pouch</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">Pouch</span><span class="p">.</span><span class="nx">collate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">ai</span> <span class="o">=</span> <span class="nx">collationIndex</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">bi</span> <span class="o">=</span> <span class="nx">collationIndex</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">((</span><span class="nx">ai</span> <span class="o">-</span> <span class="nx">bi</span><span class="p">)</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">ai</span> <span class="o">-</span> <span class="nx">bi</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">a</span> <span class="o">-</span> <span class="nx">b</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span> <span class="o">===</span> <span class="s1">&#39;boolean&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">a</span> <span class="o">&lt;</span> <span class="nx">b</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">stringCollate</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">arrayCollate</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">objectCollate</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">stringCollate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>See: https://github.com/daleharvey/pouchdb/issues/40
This is incompatible with the CouchDB implementation, but its the
best we can do for now</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">return</span> <span class="p">(</span><span class="nx">a</span> <span class="o">===</span> <span class="nx">b</span><span class="p">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="p">((</span><span class="nx">a</span> <span class="o">&gt;</span> <span class="nx">b</span><span class="p">)</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">objectCollate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">ak</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span> <span class="nx">bk</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">len</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">ak</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">bk</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>First sort the keys</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">sort</span> <span class="o">=</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">collate</span><span class="p">(</span><span class="nx">ak</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">bk</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">sort</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">sort</span><span class="p">;</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>if the keys are equal sort the values</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">sort</span> <span class="o">=</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">collate</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">ak</span><span class="p">[</span><span class="nx">i</span><span class="p">]],</span> <span class="nx">b</span><span class="p">[</span><span class="nx">bk</span><span class="p">[</span><span class="nx">i</span><span class="p">]]);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">sort</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">sort</span><span class="p">;</span>
      <span class="p">}</span>

    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">ak</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="nx">bk</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span>
      <span class="p">(</span><span class="nx">ak</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="nx">bk</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">arrayCollate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">len</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">sort</span> <span class="o">=</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">collate</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">b</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">sort</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">sort</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span>
      <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>The collation is defined by erlangs ordered terms
the atoms null, true, false come first, then numbers, strings,
arrays, then objects</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">collationIndex</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;boolean&#39;</span><span class="p">,</span> <span class="s1">&#39;number&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">id</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">x</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">id</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="mf">4.5</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

<span class="p">}).</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>a few hacks to get things in the right place for node.js</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">module</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">Pouch</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">utils</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./pouch.utils.js&#39;</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">k</span> <span class="k">in</span> <span class="nx">utils</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">global</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">utils</span><span class="p">[</span><span class="nx">k</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>for a better overview of what this is doing, read:
https://github.com/apache/couchdb/blob/master/src/couchdb/couch<em>key</em>tree.erl</p>

<p>But for a quick intro, CouchDB uses a revision tree to store a documents
history, A -> B -> C, when a document has conflicts, that is a branch in the
tree, A -> (B1 | B2 -> C), We store these as a nested array in the format</p>

<p>KeyTree = [Path ... ]
Path = {pos: position<em>from</em>root, ids: Tree}
Tree = [Key, Tree]</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>Turn a path as a flat array into a tree with a single branch</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">function</span> <span class="nx">pathToTree</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">root</span> <span class="o">=</span> <span class="p">[</span><span class="nx">path</span><span class="p">.</span><span class="nx">shift</span><span class="p">(),</span> <span class="p">[]];</span>
    <span class="kd">var</span> <span class="nx">leaf</span> <span class="o">=</span> <span class="nx">root</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">nleaf</span> <span class="o">=</span> <span class="p">[</span><span class="nx">path</span><span class="p">.</span><span class="nx">shift</span><span class="p">(),</span> <span class="p">[]];</span>
      <span class="nx">leaf</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">nleaf</span><span class="p">);</span>
      <span class="nx">leaf</span> <span class="o">=</span> <span class="nx">nleaf</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">root</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>To ensure we dont grow the revision tree infinitely, we stem old revisions</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">function</span> <span class="nx">stem</span><span class="p">(</span><span class="nx">tree</span><span class="p">,</span> <span class="nx">depth</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>First we break out the tree into a complete list of root to leaf paths,
we cut off the start of the path and generate a new set of flat trees</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">stemmedPaths</span> <span class="o">=</span> <span class="nx">rootToLeaf</span><span class="p">(</span><span class="nx">tree</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">stemmed</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">ids</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="nx">depth</span><span class="p">);</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="nx">pos</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">pos</span> <span class="o">+</span> <span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">ids</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="nx">stemmed</span><span class="p">.</span><span class="nx">length</span><span class="p">),</span>
        <span class="nx">ids</span><span class="o">:</span> <span class="nx">pathToTree</span><span class="p">(</span><span class="nx">stemmed</span><span class="p">)</span>
      <span class="p">};</span>
    <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>Then we remerge all those flat trees together, ensuring that we dont
connect trees that would go beyond the depth limit</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">return</span> <span class="nx">stemmedPaths</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="nx">current</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">doMerge</span><span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="nx">current</span><span class="p">,</span> <span class="kc">true</span><span class="p">).</span><span class="nx">tree</span><span class="p">;</span>
    <span class="p">},</span> <span class="p">[</span><span class="nx">stemmedPaths</span><span class="p">.</span><span class="nx">shift</span><span class="p">()]);</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>Merge two trees together</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">function</span> <span class="nx">mergeTree</span><span class="p">(</span><span class="nx">tree1</span><span class="p">,</span> <span class="nx">tree2</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">conflicts</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">tree2</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">tree1</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
        <span class="nx">conflicts</span> <span class="o">=</span> <span class="s1">&#39;new_leaf&#39;</span><span class="p">;</span>
        <span class="nx">tree1</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">tree2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nx">i</span><span class="p">];</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">tree1</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">tree2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nx">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">conflicts</span> <span class="o">=</span> <span class="s1">&#39;new_branch&#39;</span><span class="p">;</span>
        <span class="nx">tree1</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">tree2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nx">i</span><span class="p">]);</span>
        <span class="nx">tree1</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">sort</span><span class="p">();</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">mergeTree</span><span class="p">(</span><span class="nx">tree1</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nx">tree2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nx">i</span><span class="p">]);</span>
        <span class="nx">conflicts</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">conflicts</span> <span class="o">||</span> <span class="nx">conflicts</span><span class="p">;</span>
        <span class="nx">tree1</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">tree</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">{</span><span class="nx">conflicts</span><span class="o">:</span> <span class="nx">conflicts</span><span class="p">,</span> <span class="nx">tree</span><span class="o">:</span> <span class="nx">tree1</span><span class="p">};</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">doMerge</span><span class="p">(</span><span class="nx">tree</span><span class="p">,</span> <span class="nx">path</span><span class="p">,</span> <span class="nx">dontExpand</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">restree</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">conflicts</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">merged</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">branch</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">tree</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">{</span><span class="nx">tree</span><span class="o">:</span> <span class="p">[</span><span class="nx">path</span><span class="p">],</span> <span class="nx">conflicts</span><span class="o">:</span> <span class="s1">&#39;new_leaf&#39;</span><span class="p">};</span>
    <span class="p">}</span>

    <span class="nx">tree</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">branch</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">branch</span><span class="p">.</span><span class="nx">pos</span> <span class="o">===</span> <span class="nx">path</span><span class="p">.</span><span class="nx">pos</span> <span class="o">&amp;&amp;</span> <span class="nx">branch</span><span class="p">.</span><span class="nx">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="nx">path</span><span class="p">.</span><span class="nx">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>Paths start at the same position and have the same root, so they need
merged</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">res</span> <span class="o">=</span> <span class="nx">mergeTree</span><span class="p">(</span><span class="nx">branch</span><span class="p">.</span><span class="nx">ids</span><span class="p">,</span> <span class="nx">path</span><span class="p">.</span><span class="nx">ids</span><span class="p">);</span>
        <span class="nx">restree</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="nx">pos</span><span class="o">:</span> <span class="nx">branch</span><span class="p">.</span><span class="nx">pos</span><span class="p">,</span> <span class="nx">ids</span><span class="o">:</span> <span class="nx">res</span><span class="p">.</span><span class="nx">tree</span><span class="p">});</span>
        <span class="nx">conflicts</span> <span class="o">=</span> <span class="nx">conflicts</span> <span class="o">||</span> <span class="nx">res</span><span class="p">.</span><span class="nx">conflicts</span><span class="p">;</span>
        <span class="nx">merged</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">dontExpand</span> <span class="o">!==</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>The paths start at a different position, take the earliest path and
traverse up until it as at the same point from root as the path we want to
merge if the keys match we return the longer path with the other merged
After stemming we dont want to expand the trees</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>destructive assignment plz</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">var</span> <span class="nx">t1</span> <span class="o">=</span> <span class="nx">branch</span><span class="p">.</span><span class="nx">pos</span> <span class="o">&lt;</span> <span class="nx">path</span><span class="p">.</span><span class="nx">pos</span> <span class="o">?</span> <span class="nx">branch</span> <span class="o">:</span> <span class="nx">path</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">t2</span> <span class="o">=</span> <span class="nx">branch</span><span class="p">.</span><span class="nx">pos</span> <span class="o">&lt;</span> <span class="nx">path</span><span class="p">.</span><span class="nx">pos</span> <span class="o">?</span> <span class="nx">path</span> <span class="o">:</span> <span class="nx">branch</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">diff</span> <span class="o">=</span> <span class="nx">t2</span><span class="p">.</span><span class="nx">pos</span> <span class="o">-</span> <span class="nx">t1</span><span class="p">.</span><span class="nx">pos</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">parent</span><span class="p">,</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">t1</span><span class="p">.</span><span class="nx">ids</span><span class="p">;</span>

        <span class="k">while</span><span class="p">(</span><span class="nx">diff</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">parent</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
          <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!==</span> <span class="nx">t2</span><span class="p">.</span><span class="nx">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
          <span class="nx">restree</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">branch</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">res</span> <span class="o">=</span> <span class="nx">mergeTree</span><span class="p">(</span><span class="nx">tmp</span><span class="p">,</span> <span class="nx">t2</span><span class="p">.</span><span class="nx">ids</span><span class="p">);</span>
          <span class="nx">parent</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">tree</span><span class="p">;</span>
          <span class="nx">restree</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="nx">pos</span><span class="o">:</span> <span class="nx">t1</span><span class="p">.</span><span class="nx">pos</span><span class="p">,</span> <span class="nx">ids</span><span class="o">:</span> <span class="nx">t1</span><span class="p">.</span><span class="nx">ids</span><span class="p">});</span>
          <span class="nx">conflicts</span> <span class="o">=</span> <span class="nx">conflicts</span> <span class="o">||</span> <span class="nx">res</span><span class="p">.</span><span class="nx">conflicts</span><span class="p">;</span>
          <span class="nx">merged</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">restree</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">branch</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>We didnt find</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">merged</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">restree</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">path</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">restree</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">pos</span> <span class="o">-</span> <span class="nx">b</span><span class="p">.</span><span class="nx">pos</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">tree</span><span class="o">:</span> <span class="nx">restree</span><span class="p">,</span>
      <span class="nx">conflicts</span><span class="o">:</span> <span class="nx">conflicts</span> <span class="o">||</span> <span class="s1">&#39;internal_node&#39;</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="nx">Pouch</span><span class="p">.</span><span class="nx">merge</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">tree</span><span class="p">,</span> <span class="nx">path</span><span class="p">,</span> <span class="nx">depth</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>Ugh, nicer way to not modify arguments in place?</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">tree</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">tree</span><span class="p">));</span>
    <span class="nx">path</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">path</span><span class="p">));</span>
    <span class="kd">var</span> <span class="nx">newTree</span> <span class="o">=</span> <span class="nx">doMerge</span><span class="p">(</span><span class="nx">tree</span><span class="p">,</span> <span class="nx">path</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">tree</span><span class="o">:</span> <span class="nx">stem</span><span class="p">(</span><span class="nx">newTree</span><span class="p">.</span><span class="nx">tree</span><span class="p">,</span> <span class="nx">depth</span><span class="p">),</span>
      <span class="nx">conflicts</span><span class="o">:</span> <span class="nx">newTree</span><span class="p">.</span><span class="nx">conflicts</span>
    <span class="p">};</span>
  <span class="p">};</span>

<span class="p">}).</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">module</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">Pouch</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

  <span class="kd">function</span> <span class="nx">replicate</span><span class="p">(</span><span class="nx">src</span><span class="p">,</span> <span class="nx">target</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">replicateRet</span><span class="p">)</span> <span class="p">{</span>

    <span class="nx">fetchCheckpoint</span><span class="p">(</span><span class="nx">src</span><span class="p">,</span> <span class="nx">target</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">checkpoint</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">results</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="kd">var</span> <span class="nx">completed</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">pending</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">last_seq</span> <span class="o">=</span> <span class="nx">checkpoint</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">continuous</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">continuous</span> <span class="o">||</span> <span class="kc">false</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">ok</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">start_time</span><span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span>
        <span class="nx">docs_read</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nx">docs_written</span><span class="o">:</span> <span class="mi">0</span>
      <span class="p">};</span>

      <span class="kd">function</span> <span class="nx">isCompleted</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">completed</span> <span class="o">&amp;&amp;</span> <span class="nx">pending</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">result</span><span class="p">.</span><span class="nx">end_time</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
          <span class="nx">writeCheckpoint</span><span class="p">(</span><span class="nx">src</span><span class="p">,</span> <span class="nx">target</span><span class="p">,</span> <span class="nx">last_seq</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">result</span><span class="p">);</span>
          <span class="p">});</span>
        <span class="p">}</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">replicateRet</span><span class="p">.</span><span class="nx">cancelled</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="kd">var</span> <span class="nx">repOpts</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">continuous</span><span class="o">:</span> <span class="nx">continuous</span><span class="p">,</span>
        <span class="nx">since</span><span class="o">:</span> <span class="nx">checkpoint</span><span class="p">,</span>
        <span class="nx">onChange</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">change</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">last_seq</span> <span class="o">=</span> <span class="nx">change</span><span class="p">.</span><span class="nx">seq</span><span class="p">;</span>
          <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">change</span><span class="p">);</span>
          <span class="nx">result</span><span class="p">.</span><span class="nx">docs_read</span><span class="o">++</span><span class="p">;</span>
          <span class="nx">pending</span><span class="o">++</span><span class="p">;</span>
          <span class="kd">var</span> <span class="nx">diff</span> <span class="o">=</span> <span class="p">{};</span>
          <span class="nx">diff</span><span class="p">[</span><span class="nx">change</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="nx">change</span><span class="p">.</span><span class="nx">changes</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">x</span><span class="p">.</span><span class="nx">rev</span><span class="p">;</span> <span class="p">});</span>
          <span class="nx">target</span><span class="p">.</span><span class="nx">revsDiff</span><span class="p">(</span><span class="nx">diff</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">diffs</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">diffs</span><span class="p">).</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">pending</span><span class="o">--</span><span class="p">;</span>
              <span class="nx">isCompleted</span><span class="p">();</span>
              <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">id</span> <span class="k">in</span> <span class="nx">diffs</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">diffs</span><span class="p">[</span><span class="nx">id</span><span class="p">].</span><span class="nx">missing</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">rev</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">src</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="p">{</span><span class="nx">revs</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">rev</span><span class="o">:</span> <span class="nx">rev</span><span class="p">,</span> <span class="nx">attachments</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">doc</span><span class="p">)</span> <span class="p">{</span>
                  <span class="nx">target</span><span class="p">.</span><span class="nx">bulkDocs</span><span class="p">({</span><span class="nx">docs</span><span class="o">:</span> <span class="p">[</span><span class="nx">doc</span><span class="p">]},</span> <span class="p">{</span><span class="nx">new_edits</span><span class="o">:</span> <span class="kc">false</span><span class="p">},</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">onChange</span><span class="p">)</span> <span class="p">{</span>
                      <span class="nx">opts</span><span class="p">.</span><span class="nx">onChange</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">[</span><span class="nx">result</span><span class="p">]);</span>
                    <span class="p">}</span>
                    <span class="nx">result</span><span class="p">.</span><span class="nx">docs_written</span><span class="o">++</span><span class="p">;</span>
                    <span class="nx">pending</span><span class="o">--</span><span class="p">;</span>
                    <span class="nx">isCompleted</span><span class="p">();</span>
                  <span class="p">});</span>
                <span class="p">});</span>
              <span class="p">});</span>
            <span class="p">}</span>
          <span class="p">});</span>
        <span class="p">},</span>
        <span class="nx">complete</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">completed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
          <span class="nx">isCompleted</span><span class="p">();</span>
        <span class="p">}</span>
      <span class="p">};</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">filter</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">repOpts</span><span class="p">.</span><span class="nx">filter</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">filter</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="kd">var</span> <span class="nx">changes</span> <span class="o">=</span> <span class="nx">src</span><span class="p">.</span><span class="nx">changes</span><span class="p">(</span><span class="nx">repOpts</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">continuous</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">replicateRet</span><span class="p">.</span><span class="nx">cancel</span> <span class="o">=</span> <span class="nx">changes</span><span class="p">.</span><span class="nx">cancel</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">toPouch</span><span class="p">(</span><span class="nx">db</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">db</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nx">Pouch</span><span class="p">(</span><span class="nx">db</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">db</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">Pouch</span><span class="p">.</span><span class="nx">replicate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">src</span><span class="p">,</span> <span class="nx">target</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p>TODO: This needs some cleaning up, from the replicate call I want
to return a promise in which I can cancel continuous replications
this will just proxy requests to cancel the changes feed but only
after we start actually running the changes feed</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span> <span class="k">instanceof</span> <span class="nb">Function</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">cancelled</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">cancel</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">cancelled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">replicateRet</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ret</span><span class="p">();</span>
    <span class="nx">toPouch</span><span class="p">(</span><span class="nx">src</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">src</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="nx">toPouch</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">replicate</span><span class="p">(</span><span class="nx">src</span><span class="p">,</span> <span class="nx">target</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">replicateRet</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="nx">replicateRet</span><span class="p">;</span>
  <span class="p">};</span>

<span class="p">}).</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>Pretty dumb name for a function, just wraps callback calls so we dont
to if (callback) callback() everywhere</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">call</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fun</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">fun</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nb">Function</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fun</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>Wrapper for functions that call the bulkdocs api with a single doc,
if the first result is an error, return an error</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">yankError</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">results</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span> <span class="o">||</span> <span class="nx">results</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">err</span> <span class="o">||</span> <span class="nx">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">};</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">isAttachmentId</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span><span class="sr">/\//</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
      <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="sr">/^_local/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
      <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="sr">/^_design/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">id</span><span class="p">));</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>Parse document ids: docid[/attachid]
  - /attachid is optional, and can have slashes in it too
  - int ids and strings beginning with _design or _local are not split
returns an object: { docId: docid, attachmentId: attachid }</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">parseDocId</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">ids</span> <span class="o">=</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">id</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="sr">/^_(design|local)\//</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">id</span><span class="p">))</span>
    <span class="o">?</span> <span class="nx">id</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
    <span class="o">:</span> <span class="p">[</span><span class="nx">id</span><span class="p">]</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">docId</span><span class="o">:</span> <span class="nx">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="nx">attachmentId</span><span class="o">:</span> <span class="nx">ids</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^\/+/</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <p>Determine id an ID is valid
  - invalid IDs begin with an underescore that does not begin '<em>design' or '</em>local'
  - any other string value is a valid id</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">isValidId</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="sr">/^_/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">id</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="sr">/^_(design|local)/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>Preprocess documents, parse their revisions, assign an id and a
revision for new writes that are missing them, etc</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">parseDoc</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span> <span class="nx">newEdits</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">error</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p>check for an attachment id and add attachments as needed</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_id</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">parseDocId</span><span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_id</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">id</span><span class="p">.</span><span class="nx">attachmentId</span> <span class="o">!==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">attachment</span> <span class="o">=</span> <span class="nx">btoa</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">doc</span><span class="p">));</span>
      <span class="nx">doc</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">_id</span><span class="o">:</span> <span class="nx">id</span><span class="p">.</span><span class="nx">docId</span><span class="p">,</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">doc</span><span class="p">.</span><span class="nx">_attachments</span> <span class="o">=</span> <span class="p">{};</span>
      <span class="p">}</span>
      <span class="nx">doc</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">[</span><span class="nx">id</span><span class="p">.</span><span class="nx">attachmentId</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">content_type</span><span class="o">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
        <span class="nx">data</span><span class="o">:</span> <span class="nx">attachment</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">newEdits</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_id</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">doc</span><span class="p">.</span><span class="nx">_id</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">uuid</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">newRevId</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">uuid</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">nRevNum</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_rev</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">revInfo</span> <span class="o">=</span> <span class="sr">/^(\d+)-(.+)$/</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_rev</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">revInfo</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="s2">&quot;invalid value for property &#39;_rev&#39;&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">doc</span><span class="p">.</span><span class="nx">_rev_tree</span> <span class="o">=</span> <span class="p">[{</span>
        <span class="nx">pos</span><span class="o">:</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">revInfo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">10</span><span class="p">),</span>
        <span class="nx">ids</span><span class="o">:</span> <span class="p">[</span><span class="nx">revInfo</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[[</span><span class="nx">newRevId</span><span class="p">,</span> <span class="p">[]]]]</span>
      <span class="p">}];</span>
      <span class="nx">nRevNum</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">revInfo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">doc</span><span class="p">.</span><span class="nx">_rev_tree</span> <span class="o">=</span> <span class="p">[{</span>
        <span class="nx">pos</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">ids</span> <span class="o">:</span> <span class="p">[</span><span class="nx">newRevId</span><span class="p">,</span> <span class="p">[]]</span>
      <span class="p">}];</span>
      <span class="nx">nRevNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_revisions</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">doc</span><span class="p">.</span><span class="nx">_rev_tree</span> <span class="o">=</span> <span class="p">[{</span>
        <span class="nx">pos</span><span class="o">:</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_revisions</span><span class="p">.</span><span class="nx">start</span> <span class="o">-</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_revisions</span><span class="p">.</span><span class="nx">ids</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">ids</span><span class="o">:</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_revisions</span><span class="p">.</span><span class="nx">ids</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">acc</span><span class="p">,</span> <span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">acc</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="p">[</span><span class="nx">x</span><span class="p">,</span> <span class="p">[]];</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="p">[</span><span class="nx">x</span><span class="p">,</span> <span class="p">[</span><span class="nx">acc</span><span class="p">]];</span>
          <span class="p">}</span>
        <span class="p">},</span> <span class="kc">null</span><span class="p">)</span>
      <span class="p">}];</span>
      <span class="nx">nRevNum</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_revisions</span><span class="p">.</span><span class="nx">start</span><span class="p">;</span>
      <span class="nx">newRevId</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_revisions</span><span class="p">.</span><span class="nx">ids</span><span class="p">[</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_revisions</span><span class="p">.</span><span class="nx">ids</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_rev_tree</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">revInfo</span> <span class="o">=</span> <span class="sr">/^(\d+)-(.+)$/</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_rev</span><span class="p">);</span>
      <span class="nx">nRevNum</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">revInfo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">10</span><span class="p">);</span>
      <span class="nx">newRevId</span> <span class="o">=</span> <span class="nx">revInfo</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
      <span class="nx">doc</span><span class="p">.</span><span class="nx">_rev_tree</span> <span class="o">=</span> <span class="p">[{</span>
        <span class="nx">pos</span><span class="o">:</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">revInfo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">10</span><span class="p">),</span>
        <span class="nx">ids</span><span class="o">:</span> <span class="p">[</span><span class="nx">revInfo</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[]]</span>
      <span class="p">}];</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_id</span> <span class="o">!==</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">error</span> <span class="o">=</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">Errors</span><span class="p">.</span><span class="nx">INVALID_ID</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isValidId</span><span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_id</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">error</span> <span class="o">=</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">Errors</span><span class="p">.</span><span class="nx">RESERVED_ID</span><span class="p">;</span>
  <span class="p">}</span>


  <span class="nx">doc</span><span class="p">.</span><span class="nx">_id</span> <span class="o">=</span> <span class="nb">decodeURIComponent</span><span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_id</span><span class="p">);</span>
  <span class="nx">doc</span><span class="p">.</span><span class="nx">_rev</span> <span class="o">=</span> <span class="p">[</span><span class="nx">nRevNum</span><span class="p">,</span> <span class="nx">newRevId</span><span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">error</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">doc</span><span class="p">).</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">acc</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="sr">/^_/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">key</span> <span class="o">!==</span> <span class="s1">&#39;_attachments&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">acc</span><span class="p">.</span><span class="nx">metadata</span><span class="p">[</span><span class="nx">key</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">acc</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">acc</span><span class="p">;</span>
  <span class="p">},</span> <span class="p">{</span><span class="nx">metadata</span> <span class="o">:</span> <span class="p">{},</span> <span class="nx">data</span> <span class="o">:</span> <span class="p">{}});</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">compareRevs</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <p>Sort by id</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">id</span> <span class="o">!==</span> <span class="nx">b</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">id</span> <span class="o">&lt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">id</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <p>Then by deleted</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">deleted</span> <span class="o">^</span> <span class="nx">b</span><span class="p">.</span><span class="nx">deleted</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">deleted</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <p>Then by rev id</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">rev_tree</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">pos</span> <span class="o">===</span> <span class="nx">b</span><span class="p">.</span><span class="nx">rev_tree</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">pos</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">rev_tree</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">ids</span> <span class="o">&lt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">rev_tree</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">ids</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <p>Then by depth of edits</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">return</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">rev_tree</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">start</span> <span class="o">&lt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">rev_tree</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">start</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <p>Pretty much all below can be combined into a higher order function to
traverse revisions
Turn a tree into a list of rootToLeaf paths</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">expandTree</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">all</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">tree</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">all</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="nx">rev</span><span class="o">:</span> <span class="nx">i</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nx">tree</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">status</span><span class="o">:</span> <span class="s1">&#39;available&#39;</span><span class="p">});</span>
  <span class="nx">tree</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">child</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">expandTree</span><span class="p">(</span><span class="nx">all</span><span class="p">,</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">child</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">collectRevs</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">revs</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="nx">expandTree</span><span class="p">(</span><span class="nx">revs</span><span class="p">,</span> <span class="nx">path</span><span class="p">.</span><span class="nx">pos</span><span class="p">,</span> <span class="nx">path</span><span class="p">.</span><span class="nx">ids</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">revs</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">collectLeavesInner</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">all</span><span class="p">,</span> <span class="nx">pos</span><span class="p">,</span> <span class="nx">tree</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">tree</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">all</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="nx">rev</span><span class="o">:</span> <span class="nx">pos</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nx">tree</span><span class="p">[</span><span class="mi">0</span><span class="p">]});</span>
  <span class="p">}</span>
  <span class="nx">tree</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">child</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">collectLeavesInner</span><span class="p">(</span><span class="nx">all</span><span class="p">,</span> <span class="nx">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nx">child</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">collectLeaves</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">revs</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">leaves</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="nx">revs</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">tree</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">collectLeavesInner</span><span class="p">(</span><span class="nx">leaves</span><span class="p">,</span> <span class="nx">tree</span><span class="p">.</span><span class="nx">pos</span><span class="p">,</span> <span class="nx">tree</span><span class="p">.</span><span class="nx">ids</span><span class="p">);</span>
  <span class="p">});</span>
  <span class="k">return</span> <span class="nx">leaves</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">collectConflicts</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">revs</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">leaves</span> <span class="o">=</span> <span class="nx">collectLeaves</span><span class="p">(</span><span class="nx">revs</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-46">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-46">&#182;</a>               </div>               <p>First is current rev</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">leaves</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
  <span class="k">return</span> <span class="nx">leaves</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">x</span><span class="p">.</span><span class="nx">rev</span><span class="p">;</span> <span class="p">});</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">fetchCheckpoint</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">src</span><span class="p">,</span> <span class="nx">target</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">Crypto</span><span class="p">.</span><span class="nx">MD5</span><span class="p">(</span><span class="nx">src</span><span class="p">.</span><span class="nx">id</span><span class="p">()</span> <span class="o">+</span> <span class="nx">target</span><span class="p">.</span><span class="nx">id</span><span class="p">());</span>
  <span class="nx">src</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;_local/&#39;</span> <span class="o">+</span> <span class="nx">id</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">doc</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span> <span class="o">&amp;&amp;</span> <span class="nx">err</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">404</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">callback</span><span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">last_seq</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">writeCheckpoint</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">src</span><span class="p">,</span> <span class="nx">target</span><span class="p">,</span> <span class="nx">checkpoint</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">check</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">_id</span><span class="o">:</span> <span class="s1">&#39;_local/&#39;</span> <span class="o">+</span> <span class="nx">Crypto</span><span class="p">.</span><span class="nx">MD5</span><span class="p">(</span><span class="nx">src</span><span class="p">.</span><span class="nx">id</span><span class="p">()</span> <span class="o">+</span> <span class="nx">target</span><span class="p">.</span><span class="nx">id</span><span class="p">()),</span>
    <span class="nx">last_seq</span><span class="o">:</span> <span class="nx">checkpoint</span>
  <span class="p">};</span>
  <span class="nx">src</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">check</span><span class="p">.</span><span class="nx">_id</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">doc</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">doc</span> <span class="o">&amp;&amp;</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_rev</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">check</span><span class="p">.</span><span class="nx">_rev</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_rev</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">src</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="nx">check</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">doc</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-47">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-47">&#182;</a>               </div>               <p>Turn a tree into a list of rootToLeaf paths</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">function</span> <span class="nx">expandTree2</span><span class="p">(</span><span class="nx">all</span><span class="p">,</span> <span class="nx">current</span><span class="p">,</span> <span class="nx">pos</span><span class="p">,</span> <span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">current</span> <span class="o">=</span> <span class="nx">current</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="nx">current</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">all</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="nx">pos</span><span class="o">:</span> <span class="nx">pos</span><span class="p">,</span> <span class="nx">ids</span><span class="o">:</span> <span class="nx">current</span><span class="p">});</span>
  <span class="p">}</span>
  <span class="nx">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">child</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">expandTree2</span><span class="p">(</span><span class="nx">all</span><span class="p">,</span> <span class="nx">current</span><span class="p">,</span> <span class="nx">pos</span><span class="p">,</span> <span class="nx">child</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-48">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-48">&#182;</a>               </div>               <p>We fetch all leafs of the revision tree, and sort them based on tree length
and whether they were deleted, undeleted documents with the longest revision
tree (most edits) win</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">winningRev</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">metadata</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">deletions</span> <span class="o">=</span> <span class="nx">metadata</span><span class="p">.</span><span class="nx">deletions</span> <span class="o">||</span> <span class="p">{};</span>
  <span class="kd">var</span> <span class="nx">leafs</span> <span class="o">=</span> <span class="nx">metadata</span><span class="p">.</span><span class="nx">rev_tree</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">tree</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">leaf</span> <span class="o">=</span> <span class="nx">treeLeaf</span><span class="p">(</span><span class="nx">tree</span><span class="p">.</span><span class="nx">pos</span><span class="p">,</span> <span class="nx">tree</span><span class="p">.</span><span class="nx">ids</span><span class="p">);</span>
    <span class="nx">leaf</span><span class="p">.</span><span class="nx">deleted</span> <span class="o">=</span> <span class="nx">leaf</span><span class="p">.</span><span class="nx">id</span> <span class="k">in</span> <span class="nx">deletions</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">leaf</span><span class="p">;</span>
  <span class="p">});</span>

  <span class="nx">leafs</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">deleted</span> <span class="o">!==</span> <span class="nx">b</span><span class="p">.</span><span class="nx">deleted</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">deleted</span> <span class="o">&gt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">deleted</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">pos</span> <span class="o">&gt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">pos</span><span class="p">;</span>
  <span class="p">});</span>
  <span class="k">return</span> <span class="nx">leafs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">pos</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nx">leafs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">id</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">treeLeaf</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">pos</span><span class="p">,</span> <span class="nx">tree</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">tree</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span><span class="nx">pos</span><span class="o">:</span> <span class="nx">pos</span><span class="p">,</span> <span class="nx">id</span><span class="o">:</span> <span class="nx">tree</span><span class="p">[</span><span class="mi">0</span><span class="p">]};</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">treeLeaf</span><span class="p">(</span><span class="nx">pos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">tree</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">rootToLeaf</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">tree</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">all</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="nx">tree</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">expandTree2</span><span class="p">(</span><span class="nx">all</span><span class="p">,</span> <span class="p">[],</span> <span class="nx">path</span><span class="p">.</span><span class="nx">pos</span><span class="p">,</span> <span class="nx">path</span><span class="p">.</span><span class="nx">ids</span><span class="p">);</span>
  <span class="p">});</span>
  <span class="k">return</span> <span class="nx">all</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">arrayFirst</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">arr</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">i</span><span class="p">)</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">filterChange</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">change</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">filter</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">opts</span><span class="p">.</span><span class="nx">filter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">change</span><span class="p">.</span><span class="nx">doc</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">opts</span><span class="p">.</span><span class="nx">include_docs</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">delete</span> <span class="nx">change</span><span class="p">.</span><span class="nx">doc</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">call</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">onChange</span><span class="p">,</span> <span class="nx">change</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">ajax</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">ajax</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">success</span> <span class="o">&amp;&amp;</span> <span class="nx">callback</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">callback</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">success</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">success</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">sucess</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-49">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-49">&#182;</a>               </div>               <p>Chrome will parse some attachments that are JSON. We don't want that.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">dataType</span> <span class="o">===</span> <span class="kc">false</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">obj</span> <span class="o">!==</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">obj</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">obj</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">);</span>
  <span class="p">};</span>
  <span class="kd">var</span> <span class="nx">error</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">errObj</span> <span class="o">=</span> <span class="nx">err</span><span class="p">.</span><span class="nx">responseText</span>
        <span class="o">?</span> <span class="p">{</span><span class="nx">status</span><span class="o">:</span> <span class="nx">err</span><span class="p">.</span><span class="nx">status</span><span class="p">}</span>
        <span class="o">:</span> <span class="nx">err</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="nx">errObj</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="nx">errObj</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">responseText</span><span class="p">));</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{}</span>
      <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">errObj</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="kd">var</span> <span class="nx">defaults</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">success</span><span class="o">:</span> <span class="nx">success</span><span class="p">,</span>
    <span class="nx">error</span><span class="o">:</span> <span class="nx">error</span><span class="p">,</span>
    <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">Accept</span><span class="o">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
      <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="nx">dataType</span><span class="o">:</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span>
    <span class="nx">timeout</span><span class="o">:</span> <span class="mi">10000</span>
  <span class="p">};</span>
  <span class="nx">options</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="nx">defaults</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">options</span><span class="p">.</span><span class="nx">data</span> <span class="o">!==</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">options</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">auth</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">options</span><span class="p">.</span><span class="nx">beforeSend</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">btoa</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">username</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">password</span><span class="p">);</span>
      <span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="s2">&quot;Authorization&quot;</span><span class="p">,</span> <span class="s2">&quot;Basic &quot;</span> <span class="o">+</span> <span class="nx">token</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-50">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-50">&#182;</a>               </div>               <p>convert options from xhr api to request api</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">options</span><span class="p">.</span><span class="nx">body</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
      <span class="k">delete</span> <span class="nx">options</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">options</span><span class="p">.</span><span class="nx">method</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">type</span><span class="p">;</span>
      <span class="k">delete</span> <span class="nx">options</span><span class="p">.</span><span class="nx">type</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">auth</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">btoa</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">username</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">password</span><span class="p">);</span>
      <span class="nx">options</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="s1">&#39;Authorization&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Basic &#39;</span> <span class="o">+</span> <span class="nx">token</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">request</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">err</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="nx">response</span> <span class="o">?</span> <span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">:</span> <span class="mi">400</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">call</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">error</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="kd">var</span> <span class="nx">content_type</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="s1">&#39;content-type&#39;</span><span class="p">]</span>
        <span class="p">,</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">(</span><span class="nx">body</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-51">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-51">&#182;</a>               </div>               <p>CouchDB doesn't always return the right content-type for JSON data, so
we check for ^{ and }$ (ignoring leading/trailing whitespace)</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">dataType</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="sr">/json/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">content_type</span><span class="p">)</span>
          <span class="o">||</span> <span class="p">(</span><span class="sr">/^[\s]*{/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="sr">/}[\s]*$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">data</span><span class="p">))))</span> <span class="p">{</span>
        <span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">data</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">;</span>
        <span class="nx">call</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">error</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nx">call</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">success</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="s1">&#39;OK&#39;</span><span class="p">,</span> <span class="nx">response</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-52">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-52">&#182;</a>               </div>               <p>Basic wrapper for localStorage</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">win</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">localJSON</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">win</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">prop</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="nx">prop</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">val</span><span class="p">));</span>
    <span class="p">},</span>
    <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">prop</span><span class="p">,</span> <span class="nx">def</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="nx">prop</span><span class="p">)</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">def</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">((</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="nx">prop</span><span class="p">)</span> <span class="o">||</span> <span class="s1">&#39;false&#39;</span><span class="p">));</span>
      <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">def</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">remove</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">prop</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">localStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="nx">prop</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span>
<span class="p">})();</span></pre></div>             </td>           </tr>                               <tr id="section-53">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-53">&#182;</a>               </div>               <p>btoa and atob don't exist in node. see https://developer.mozilla.org/en-US/docs/DOM/window.btoa</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">btoa</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">btoa</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Buffer</span><span class="p">(</span><span class="nx">unescape</span><span class="p">(</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">str</span><span class="p">)),</span> <span class="s1">&#39;binary&#39;</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="s1">&#39;base64&#39;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">atob</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">atob</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">decodeURIComponent</span><span class="p">(</span><span class="nx">escape</span><span class="p">(</span><span class="k">new</span> <span class="nx">Buffer</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="s1">&#39;base64&#39;</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="s1">&#39;binary&#39;</span><span class="p">)));</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">module</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-54">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-54">&#182;</a>               </div>               <p>use node.js's crypto library instead of the Crypto object created by deps/uuid.js</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;crypto&#39;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">Crypto</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">MD5</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createHash</span><span class="p">(</span><span class="s1">&#39;md5&#39;</span><span class="p">).</span><span class="nx">update</span><span class="p">(</span><span class="nx">str</span><span class="p">).</span><span class="nx">digest</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">);</span>
  <span class="nx">_</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;underscore&#39;</span><span class="p">);</span>
  <span class="nx">$</span> <span class="o">=</span> <span class="nx">_</span><span class="p">;</span>

  <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">Crypto</span><span class="o">:</span> <span class="nx">Crypto</span><span class="p">,</span>
    <span class="nx">call</span><span class="o">:</span> <span class="nx">call</span><span class="p">,</span>
    <span class="nx">yankError</span><span class="o">:</span> <span class="nx">yankError</span><span class="p">,</span>
    <span class="nx">isAttachmentId</span><span class="o">:</span> <span class="nx">isAttachmentId</span><span class="p">,</span>
    <span class="nx">parseDocId</span><span class="o">:</span> <span class="nx">parseDocId</span><span class="p">,</span>
    <span class="nx">parseDoc</span><span class="o">:</span> <span class="nx">parseDoc</span><span class="p">,</span>
    <span class="nx">compareRevs</span><span class="o">:</span> <span class="nx">compareRevs</span><span class="p">,</span>
    <span class="nx">expandTree</span><span class="o">:</span> <span class="nx">expandTree</span><span class="p">,</span>
    <span class="nx">collectRevs</span><span class="o">:</span> <span class="nx">collectRevs</span><span class="p">,</span>
    <span class="nx">collectLeavesInner</span><span class="o">:</span> <span class="nx">collectLeavesInner</span><span class="p">,</span>
    <span class="nx">collectLeaves</span><span class="o">:</span> <span class="nx">collectLeaves</span><span class="p">,</span>
    <span class="nx">collectConflicts</span><span class="o">:</span> <span class="nx">collectConflicts</span><span class="p">,</span>
    <span class="nx">fetchCheckpoint</span><span class="o">:</span> <span class="nx">fetchCheckpoint</span><span class="p">,</span>
    <span class="nx">writeCheckpoint</span><span class="o">:</span> <span class="nx">writeCheckpoint</span><span class="p">,</span>
    <span class="nx">winningRev</span><span class="o">:</span> <span class="nx">winningRev</span><span class="p">,</span>
    <span class="nx">rootToLeaf</span><span class="o">:</span> <span class="nx">rootToLeaf</span><span class="p">,</span>
    <span class="nx">arrayFirst</span><span class="o">:</span> <span class="nx">arrayFirst</span><span class="p">,</span>
    <span class="nx">filterChange</span><span class="o">:</span> <span class="nx">filterChange</span><span class="p">,</span>
    <span class="nx">ajax</span><span class="o">:</span> <span class="nx">ajax</span><span class="p">,</span>
    <span class="nx">atob</span><span class="o">:</span> <span class="nx">atob</span><span class="p">,</span>
    <span class="nx">btoa</span><span class="o">:</span> <span class="nx">btoa</span><span class="p">,</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="nx">HTTP_TIMEOUT</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-55">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-55">&#182;</a>               </div>               <p>parseUri 1.2.2
(c) Steven Levithan <stevenlevithan.com>
MIT License</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">function</span> <span class="nx">parseUri</span> <span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">o</span> <span class="o">=</span> <span class="nx">parseUri</span><span class="p">.</span><span class="nx">options</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">m</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">parser</span><span class="p">[</span><span class="nx">o</span><span class="p">.</span><span class="nx">strictMode</span> <span class="o">?</span> <span class="s2">&quot;strict&quot;</span> <span class="o">:</span> <span class="s2">&quot;loose&quot;</span><span class="p">].</span><span class="nx">exec</span><span class="p">(</span><span class="nx">str</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">uri</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">14</span><span class="p">;</span>

  <span class="k">while</span> <span class="p">(</span><span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="nx">uri</span><span class="p">[</span><span class="nx">o</span><span class="p">.</span><span class="nx">key</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">m</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">||</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>

  <span class="nx">uri</span><span class="p">[</span><span class="nx">o</span><span class="p">.</span><span class="nx">q</span><span class="p">.</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="nx">uri</span><span class="p">[</span><span class="nx">o</span><span class="p">.</span><span class="nx">key</span><span class="p">[</span><span class="mi">12</span><span class="p">]].</span><span class="nx">replace</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">q</span><span class="p">.</span><span class="nx">parser</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$0</span><span class="p">,</span> <span class="nx">$1</span><span class="p">,</span> <span class="nx">$2</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">$1</span><span class="p">)</span> <span class="nx">uri</span><span class="p">[</span><span class="nx">o</span><span class="p">.</span><span class="nx">q</span><span class="p">.</span><span class="nx">name</span><span class="p">][</span><span class="nx">$1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">$2</span><span class="p">;</span>
  <span class="p">});</span>

  <span class="k">return</span> <span class="nx">uri</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">parseUri</span><span class="p">.</span><span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">strictMode</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="nx">key</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">,</span><span class="s2">&quot;protocol&quot;</span><span class="p">,</span><span class="s2">&quot;authority&quot;</span><span class="p">,</span><span class="s2">&quot;userInfo&quot;</span><span class="p">,</span><span class="s2">&quot;user&quot;</span><span class="p">,</span><span class="s2">&quot;password&quot;</span><span class="p">,</span><span class="s2">&quot;host&quot;</span><span class="p">,</span>
        <span class="s2">&quot;port&quot;</span><span class="p">,</span><span class="s2">&quot;relative&quot;</span><span class="p">,</span><span class="s2">&quot;path&quot;</span><span class="p">,</span><span class="s2">&quot;directory&quot;</span><span class="p">,</span><span class="s2">&quot;file&quot;</span><span class="p">,</span><span class="s2">&quot;query&quot;</span><span class="p">,</span><span class="s2">&quot;anchor&quot;</span><span class="p">],</span>
  <span class="nx">q</span><span class="o">:</span>   <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span>   <span class="s2">&quot;queryKey&quot;</span><span class="p">,</span>
    <span class="nx">parser</span><span class="o">:</span> <span class="sr">/(?:^|&amp;)([^&amp;=]*)=?([^&amp;]*)/g</span>
  <span class="p">},</span>
  <span class="nx">parser</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">strict</span><span class="o">:</span> <span class="sr">/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/</span><span class="p">,</span>
    <span class="nx">loose</span><span class="o">:</span>  <span class="sr">/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/</span>
  <span class="p">}</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-56">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-56">&#182;</a>               </div>               <p>Get all the information you possibly can about the URI given by name and
return it as a suitable object.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">function</span> <span class="nx">getHost</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-57">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-57">&#182;</a>               </div>               <p>If the given name contains "http:"</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="sr">/http(s?):/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">name</span><span class="p">))</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-58">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-58">&#182;</a>               </div>               <p>Prase the URI into all its little bits</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">uri</span> <span class="o">=</span> <span class="nx">parseUri</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-59">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-59">&#182;</a>               </div>               <p>Store the fact that it is a remote URI</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">uri</span><span class="p">.</span><span class="nx">remote</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-60">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-60">&#182;</a>               </div>               <p>Store the user and password as a separate auth object</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">uri</span><span class="p">.</span><span class="nx">user</span> <span class="o">||</span> <span class="nx">uri</span><span class="p">.</span><span class="nx">password</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">uri</span><span class="p">.</span><span class="nx">auth</span> <span class="o">=</span> <span class="p">{</span><span class="nx">username</span><span class="o">:</span> <span class="nx">uri</span><span class="p">.</span><span class="nx">user</span><span class="p">,</span> <span class="nx">password</span><span class="o">:</span> <span class="nx">uri</span><span class="p">.</span><span class="nx">password</span><span class="p">};</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-61">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-61">&#182;</a>               </div>               <p>Split the path part of the URI into parts using '/' as the delimiter
after removing any leading '/' and any trailing '/'</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">parts</span> <span class="o">=</span> <span class="nx">uri</span><span class="p">.</span><span class="nx">path</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/(^\/|\/$)/g</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-62">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-62">&#182;</a>               </div>               <p>Store the first part as the database name and remove it from the parts
array</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">uri</span><span class="p">.</span><span class="nx">db</span> <span class="o">=</span> <span class="nx">parts</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span></pre></div>             </td>           </tr>                               <tr id="section-63">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-63">&#182;</a>               </div>               <p>Restore the path by joining all the remaining parts (all the parts
except for the database name) with '/'s</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">uri</span><span class="p">.</span><span class="nx">path</span> <span class="o">=</span> <span class="nx">parts</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">uri</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-64">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-64">&#182;</a>               </div>               <p>If the given name does not contain 'http:' then return a very basic object
with no host, the current path, the given name as the database name and no
username/password</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">return</span> <span class="p">{</span><span class="nx">host</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">path</span><span class="o">:</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="nx">db</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">auth</span><span class="o">:</span> <span class="kc">false</span><span class="p">};</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-65">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-65">&#182;</a>               </div>               <p>Generate a URL with the host data given by opts and the given path</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">function</span> <span class="nx">genUrl</span><span class="p">(</span><span class="nx">opts</span><span class="p">,</span> <span class="nx">path</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-66">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-66">&#182;</a>               </div>               <p>If the host is remote</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">remote</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-67">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-67">&#182;</a>               </div>               <p>If the host already has a path, then we need to have a path delimiter
Otherwise, the path delimiter is the empty string</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">pathDel</span> <span class="o">=</span> <span class="o">!</span><span class="nx">opts</span><span class="p">.</span><span class="nx">path</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="s1">&#39;/&#39;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-68">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-68">&#182;</a>               </div>               <p>Return the URL made up of all the host's information and the given path</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">return</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">protocol</span> <span class="o">+</span> <span class="s1">&#39;://&#39;</span> <span class="o">+</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">host</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">port</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">path</span>
      <span class="o">+</span> <span class="nx">pathDel</span> <span class="o">+</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">db</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nx">path</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-69">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-69">&#182;</a>               </div>               <p>If the host is not remote, then return the URL made up of just the
database name and the given path</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">return</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">db</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nx">path</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-70">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-70">&#182;</a>               </div>               <p>Implements the PouchDB API for dealing with CouchDB instances over HTTP</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">HttpPouch</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-71">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-71">&#182;</a>               </div>               <p>Parse the URI given by opts.name into an easy-to-use object</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">host</span> <span class="o">=</span> <span class="nx">getHost</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-72">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-72">&#182;</a>               </div>               <p>Generate the database URL based on the host</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">db_url</span> <span class="o">=</span> <span class="nx">genUrl</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-73">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-73">&#182;</a>               </div>               <p>The functions that will be publically available for HttpPouch</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">api</span> <span class="o">=</span> <span class="p">{};</span></pre></div>             </td>           </tr>                               <tr id="section-74">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-74">&#182;</a>               </div>               <p>Create a new CouchDB database based on the given opts</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">createDB</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">ajax</span><span class="p">({</span><span class="nx">auth</span><span class="o">:</span> <span class="nx">host</span><span class="p">.</span><span class="nx">auth</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;PUT&#39;</span><span class="p">,</span> <span class="nx">url</span><span class="o">:</span> <span class="nx">db_url</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">ret</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-75">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-75">&#182;</a>               </div>               <p>If we get an "Unauthorized" error</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">err</span> <span class="o">&amp;&amp;</span> <span class="nx">err</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">401</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-76">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-76">&#182;</a>               </div>               <p>Test if the database already exists</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">ajax</span><span class="p">({</span><span class="nx">auth</span><span class="o">:</span> <span class="nx">host</span><span class="p">.</span><span class="nx">auth</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;HEAD&#39;</span><span class="p">,</span> <span class="nx">url</span><span class="o">:</span> <span class="nx">db_url</span><span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">ret</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-77">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-77">&#182;</a>               </div>               <p>If there is still an error</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-78">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-78">&#182;</a>               </div>               <p>Give the error to the callback to deal with</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-79">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-79">&#182;</a>               </div>               <p>Continue as if there had been no errors</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">api</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-80">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-80">&#182;</a>               </div>               <p>If there were no errros or if the only error is "Precondition Failed"
(note: "Precondition Failed" occurs when we try to create a database
that already exists)</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">err</span> <span class="o">||</span> <span class="nx">err</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">412</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-81">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-81">&#182;</a>               </div>               <p>Continue as if there had been no errors</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">api</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">Errors</span><span class="p">.</span><span class="nx">UNKNOWN_ERROR</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">};</span>
  <span class="nx">ajax</span><span class="p">({</span><span class="nx">auth</span><span class="o">:</span> <span class="nx">host</span><span class="p">.</span><span class="nx">auth</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="nx">url</span><span class="o">:</span> <span class="nx">db_url</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">ret</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-82">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-82">&#182;</a>               </div>               <p>check if the db exists</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">404</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-83">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-83">&#182;</a>               </div>               <p>if it doesn't, create it</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">createDB</span><span class="p">();</span>  
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-84">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-84">&#182;</a>               </div>               <p>go do stuff with the db</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">api</span><span class="p">);</span>
      <span class="p">}</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-85">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-85">&#182;</a>               </div>               <p>The HttpPouch's ID is its URL</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">api</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">genUrl</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-86">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-86">&#182;</a>               </div>               <p>Calls GET on the host, which gets back a JSON string containing
   couchdb: A welcome string
   version: The version of CouchDB it is running</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">api</span><span class="p">.</span><span class="nx">info</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">ajax</span><span class="p">({</span>
      <span class="nx">auth</span><span class="o">:</span> <span class="nx">host</span><span class="p">.</span><span class="nx">auth</span><span class="p">,</span>
      <span class="nx">type</span><span class="o">:</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span>
      <span class="nx">url</span><span class="o">:</span> <span class="nx">genUrl</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
    <span class="p">},</span> <span class="nx">callback</span><span class="p">);</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-87">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-87">&#182;</a>               </div>               <p>Get the document with the given id from the database given by host.
The id could be solely the _id in the database, or it may be a
_design/ID or _local/ID path</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">api</span><span class="p">.</span><span class="nx">get</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-88">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-88">&#182;</a>               </div>               <p>If no options were given, set the callback to the second parameter</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-89">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-89">&#182;</a>               </div>               <p>List of parameters to add to the GET request</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">[];</span></pre></div>             </td>           </tr>                               <tr id="section-90">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-90">&#182;</a>               </div>               <p>If it exists, add the opts.revs value to the list of parameters.
If revs=true then the resulting JSON will include a field
_revisions containing an array of the revision IDs.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">revs</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;revs=true&#39;</span><span class="p">);</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-91">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-91">&#182;</a>               </div>               <p>If it exists, add the opts.revs<em>info value to the list of parameters.
If revs</em>info=true then the resulting JSON will include the field
<em>revs</em>info containing an array of objects in which each object
representing an available revision.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">revs_info</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;revs_info=true&#39;</span><span class="p">);</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-92">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-92">&#182;</a>               </div>               <p>If it exists, add the opts.attachments value to the list of parameters.
If attachments=true the resulting JSON will include the base64-encoded
contents in the "data" property of each attachment.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">attachments</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;attachments=true&#39;</span><span class="p">);</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-93">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-93">&#182;</a>               </div>               <p>If it exists, add the opts.rev value to the list of parameters.
If rev is given a revision number then get the specified revision.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">rev</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;rev=&#39;</span> <span class="o">+</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">rev</span><span class="p">);</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-94">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-94">&#182;</a>               </div>               <p>If it exists, add the opts.conflicts value to the list of parameters.
If conflicts=true then the resulting JSON will include the field
_conflicts containing all the conflicting revisions.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">conflicts</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;conflicts=&#39;</span> <span class="o">+</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">conflicts</span><span class="p">);</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-95">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-95">&#182;</a>               </div>               <p>Format the list of parameters into a valid URI query string</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">params</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">);</span>
    <span class="nx">params</span> <span class="o">=</span> <span class="nx">params</span> <span class="o">===</span> <span class="s1">&#39;&#39;</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="s1">&#39;?&#39;</span> <span class="o">+</span> <span class="nx">params</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-96">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-96">&#182;</a>               </div>               <p>Set the options for the ajax call</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">auth</span><span class="o">:</span> <span class="nx">host</span><span class="p">.</span><span class="nx">auth</span><span class="p">,</span>
      <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;GET&#39;</span><span class="p">,</span>
      <span class="nx">url</span><span class="o">:</span> <span class="nx">genUrl</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="nx">id</span> <span class="o">+</span> <span class="nx">params</span><span class="p">)</span>
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-97">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-97">&#182;</a>               </div>               <p>If the given id contains at least one '/' and the part before the '/'
is NOT "<em>design" and is NOT "</em>local"
OR
If the given id contains at least two '/' and the part before the first
'/' is "<em>design".
TODO This second condition seems strange since if parts[0] === '</em>design'
then we already know that parts[0] !== '_local'.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">parts</span> <span class="o">=</span> <span class="nx">id</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">((</span><span class="nx">parts</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!==</span> <span class="s1">&#39;_design&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!==</span> <span class="s1">&#39;_local&#39;</span><span class="p">)</span> <span class="o">||</span>
        <span class="p">(</span><span class="nx">parts</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;_design&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!==</span> <span class="s1">&#39;_local&#39;</span><span class="p">))</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-98">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-98">&#182;</a>               </div>               <p>Nothing is expected back from the server</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">options</span><span class="p">.</span><span class="nx">dataType</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-99">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-99">&#182;</a>               </div>               <p>Get the document</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">ajax</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">doc</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-100">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-100">&#182;</a>               </div>               <p>If the document does not exist, send an error to the callback</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">Errors</span><span class="p">.</span><span class="nx">MISSING_DOC</span><span class="p">);</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-101">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-101">&#182;</a>               </div>               <p>Send the document to the callback</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">doc</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-102">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-102">&#182;</a>               </div>               <p>Get the view given by fun of the database given by host.
fun is formatted in two parts separated by a '/'; the first
part is the design and the second is the view.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">api</span><span class="p">.</span><span class="nx">query</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fun</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-103">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-103">&#182;</a>               </div>               <p>If no options were given, set the callback to be the second parameter</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-104">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-104">&#182;</a>               </div>               <p>List of parameters to add to the PUT request</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">[];</span></pre></div>             </td>           </tr>                               <tr id="section-105">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-105">&#182;</a>               </div>               <p>If opts.reduce exists and is defined, then add it to the list
of parameters.
If reduce=false then the results are that of only the map function
not the final result of map and reduce.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">reduce</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;reduce=&#39;</span> <span class="o">+</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">reduce</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">include_docs</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;include_docs=&#39;</span> <span class="o">+</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">include_docs</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">limit</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;limit=&#39;</span> <span class="o">+</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">limit</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">descending</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;descending=&#39;</span> <span class="o">+</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">descending</span><span class="p">);</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-106">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-106">&#182;</a>               </div>               <p>Format the list of parameters into a valid URI query string</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">params</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">);</span>
    <span class="nx">params</span> <span class="o">=</span> <span class="nx">params</span> <span class="o">===</span> <span class="s1">&#39;&#39;</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="s1">&#39;?&#39;</span> <span class="o">+</span> <span class="nx">params</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-107">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-107">&#182;</a>               </div>               <p>We are referencing a query defined in the design doc</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">fun</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">parts</span> <span class="o">=</span> <span class="nx">fun</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
      <span class="nx">ajax</span><span class="p">({</span>
        <span class="nx">auth</span><span class="o">:</span> <span class="nx">host</span><span class="p">.</span><span class="nx">auth</span><span class="p">,</span>
        <span class="nx">type</span><span class="o">:</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span>
        <span class="nx">url</span><span class="o">:</span> <span class="nx">genUrl</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="s1">&#39;_design/&#39;</span> <span class="o">+</span> <span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/_view/&#39;</span> <span class="o">+</span> <span class="nx">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nx">params</span><span class="p">),</span>
      <span class="p">},</span> <span class="nx">callback</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-108">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-108">&#182;</a>               </div>               <p>We are using a temporary view, terrible for performance but good for testing</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">queryObject</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">fun</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">val</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">val</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">;</span> <span class="c1">// implicitly `toString` it</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">val</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="nx">ajax</span><span class="p">({</span>
      <span class="nx">auth</span><span class="o">:</span> <span class="nx">host</span><span class="p">.</span><span class="nx">auth</span><span class="p">,</span>
      <span class="nx">type</span><span class="o">:</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
      <span class="nx">url</span><span class="o">:</span> <span class="nx">genUrl</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="s1">&#39;_temp_view&#39;</span> <span class="o">+</span> <span class="nx">params</span><span class="p">),</span>
      <span class="nx">data</span><span class="o">:</span> <span class="nx">queryObject</span>
    <span class="p">},</span> <span class="nx">callback</span><span class="p">);</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-109">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-109">&#182;</a>               </div>               <p>Delete the document given by doc from the database given by host.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">api</span><span class="p">.</span><span class="nx">remove</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-110">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-110">&#182;</a>               </div>               <p>If no options were given, set the callback to be the second parameter</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-111">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-111">&#182;</a>               </div>               <p>Delete the document</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">ajax</span><span class="p">({</span>
      <span class="nx">auth</span><span class="o">:</span> <span class="nx">host</span><span class="p">.</span><span class="nx">auth</span><span class="p">,</span>
      <span class="nx">type</span><span class="o">:</span><span class="s1">&#39;DELETE&#39;</span><span class="p">,</span>
      <span class="nx">url</span><span class="o">:</span> <span class="nx">genUrl</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_id</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;?rev=&#39;</span> <span class="o">+</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_rev</span>
    <span class="p">},</span> <span class="nx">callback</span><span class="p">);</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-112">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-112">&#182;</a>               </div>               <p>Remove the attachment given by the id and rev</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">api</span><span class="p">.</span><span class="nx">removeAttachment</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">idb_removeAttachment</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">rev</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">ajax</span><span class="p">({</span>
      <span class="nx">auth</span><span class="o">:</span> <span class="nx">host</span><span class="p">.</span><span class="nx">auth</span><span class="p">,</span>
      <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">,</span>
      <span class="nx">url</span><span class="o">:</span> <span class="nx">genUrl</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;?rev=&#39;</span> <span class="o">+</span> <span class="nx">rev</span><span class="p">,</span>
    <span class="p">},</span> <span class="nx">callback</span><span class="p">);</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-113">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-113">&#182;</a>               </div>               <p>Add the attachment given by doc and the content type given by type
to the document with the given id, the revision given by rev, and
add it to the database given by host.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">api</span><span class="p">.</span><span class="nx">putAttachment</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">rev</span><span class="p">,</span> <span class="nx">doc</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-114">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-114">&#182;</a>               </div>               <p>Add the attachment</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">ajax</span><span class="p">({</span>
      <span class="nx">auth</span><span class="o">:</span> <span class="nx">host</span><span class="p">.</span><span class="nx">auth</span><span class="p">,</span>
      <span class="nx">type</span><span class="o">:</span><span class="s1">&#39;PUT&#39;</span><span class="p">,</span>
      <span class="nx">url</span><span class="o">:</span> <span class="nx">genUrl</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;?rev=&#39;</span> <span class="o">+</span> <span class="nx">rev</span><span class="p">,</span>
      <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="nx">type</span><span class="p">},</span>
      <span class="nx">data</span><span class="o">:</span> <span class="nx">doc</span>
    <span class="p">},</span> <span class="nx">callback</span><span class="p">);</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-115">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-115">&#182;</a>               </div>               <p>Add the document given by doc (in JSON string format) to the database
given by host. This assumes that doc has a _id field.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">api</span><span class="p">.</span><span class="nx">put</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-116">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-116">&#182;</a>               </div>               <p>If no options were given, set the callback to be the second parameter</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-117">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-117">&#182;</a>               </div>               <p>List of parameter to add to the PUT request</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">[];</span></pre></div>             </td>           </tr>                               <tr id="section-118">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-118">&#182;</a>               </div>               <p>If it exists, add the opts.new<em>edits value to the list of parameters.
If new</em>edits = false then the database will NOT assign this document a
new revision number</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">new_edits</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;new_edits=&#39;</span> <span class="o">+</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">new_edits</span><span class="p">);</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-119">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-119">&#182;</a>               </div>               <p>Format the list of parameters into a valid URI query string</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">params</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">params</span> <span class="o">!==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span> <span class="o">+</span> <span class="nx">params</span><span class="p">;</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-120">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-120">&#182;</a>               </div>               <p>Add the document</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">ajax</span><span class="p">({</span>
      <span class="nx">auth</span><span class="o">:</span> <span class="nx">host</span><span class="p">.</span><span class="nx">auth</span><span class="p">,</span>
      <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;PUT&#39;</span><span class="p">,</span>
      <span class="nx">url</span><span class="o">:</span> <span class="nx">genUrl</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_id</span><span class="p">)</span> <span class="o">+</span> <span class="nx">params</span><span class="p">,</span>
      <span class="nx">data</span><span class="o">:</span> <span class="nx">doc</span>
    <span class="p">},</span> <span class="nx">callback</span><span class="p">);</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-121">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-121">&#182;</a>               </div>               <p>Add the document given by doc (in JSON string format) to the database
given by host. This assumes that doc is a new document (i.e. does not
have a _id or a _rev field.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">api</span><span class="p">.</span><span class="nx">post</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-122">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-122">&#182;</a>               </div>               <p>If no options were given, set the callback to be the second parameter</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-123">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-123">&#182;</a>               </div>               <p>Add the document</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">ajax</span><span class="p">({</span>
      <span class="nx">auth</span><span class="o">:</span> <span class="nx">host</span><span class="p">.</span><span class="nx">auth</span><span class="p">,</span>
      <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
      <span class="nx">url</span><span class="o">:</span> <span class="nx">genUrl</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
      <span class="nx">data</span><span class="o">:</span> <span class="nx">doc</span>
    <span class="p">},</span> <span class="nx">callback</span><span class="p">);</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-124">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-124">&#182;</a>               </div>               <p>Update/create multiple documents given by req in the database
given by host.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">api</span><span class="p">.</span><span class="nx">bulkDocs</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-125">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-125">&#182;</a>               </div>               <p>If no options were given, set the callback to be the second parameter</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-126">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-126">&#182;</a>               </div>               <p>If opts.new<em>edits exists add it to the document data to be
send to the database.
If new</em>edits=false then it prevents the database from creating
new revision numbers for the documents. Instead it just uses
the old ones. This is used in database replication.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">new_edits</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">req</span><span class="p">.</span><span class="nx">new_edits</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">new_edits</span><span class="p">;</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-127">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-127">&#182;</a>               </div>               <p>Update/create the documents</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">ajax</span><span class="p">({</span>
      <span class="nx">auth</span><span class="o">:</span> <span class="nx">host</span><span class="p">.</span><span class="nx">auth</span><span class="p">,</span>
      <span class="nx">type</span><span class="o">:</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
      <span class="nx">url</span><span class="o">:</span> <span class="nx">genUrl</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="s1">&#39;_bulk_docs&#39;</span><span class="p">),</span>
      <span class="nx">data</span><span class="o">:</span> <span class="nx">req</span>
    <span class="p">},</span> <span class="nx">callback</span><span class="p">);</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-128">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-128">&#182;</a>               </div>               <p>Get a listing of the documents in the database given
by host and ordered by increasing id.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">api</span><span class="p">.</span><span class="nx">allDocs</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-129">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-129">&#182;</a>               </div>               <p>If no options were given, set the callback to be the second parameter</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-130">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-130">&#182;</a>               </div>               <p>List of parameters to add to the GET request</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">[];</span></pre></div>             </td>           </tr>                               <tr id="section-131">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-131">&#182;</a>               </div>               <p>TODO I don't see conflicts as a valid parameter for a
<em>all</em>docs request (see http://wiki.apache.org/couchdb/HTTP<em>Document</em>API#all_docs)</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">conflicts</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;conflicts=true&#39;</span><span class="p">);</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-132">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-132">&#182;</a>               </div>               <p>If opts.include<em>docs exists, add the include</em>docs value to the
list of parameters.
If include_docs=true then include the associated document with each
result.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">include_docs</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;include_docs=true&#39;</span><span class="p">);</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-133">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-133">&#182;</a>               </div>               <p>If opts.startkey exists, add the startkey value to the list of
parameters.
If startkey is given then the returned list of documents will
start with the document whose id is startkey.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">startkey</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;startkey=&#39;</span> <span class="o">+</span>
                  <span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">startkey</span><span class="p">)));</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-134">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-134">&#182;</a>               </div>               <p>If opts.endkey exists, add the endkey value to the list of parameters.
If endkey is given then the returned list of docuemnts will
end with the document whose id is endkey.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">endkey</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;endkey=&#39;</span> <span class="o">+</span> <span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">endkey</span><span class="p">)));</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-135">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-135">&#182;</a>               </div>               <p>Format the list of parameters into a valid URI query string</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">params</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">params</span> <span class="o">!==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span> <span class="o">+</span> <span class="nx">params</span><span class="p">;</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-136">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-136">&#182;</a>               </div>               <p>Get the document listing</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">ajax</span><span class="p">({</span>
      <span class="nx">auth</span><span class="o">:</span> <span class="nx">host</span><span class="p">.</span><span class="nx">auth</span><span class="p">,</span>
      <span class="nx">type</span><span class="o">:</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span>
      <span class="nx">url</span><span class="o">:</span> <span class="nx">genUrl</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="s1">&#39;_all_docs&#39;</span> <span class="o">+</span> <span class="nx">params</span><span class="p">)</span>
    <span class="p">},</span> <span class="nx">callback</span><span class="p">);</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-137">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-137">&#182;</a>               </div>               <p>Get a list of changes made to documents in the database given by host.
TODO According to the README, there should be two other methods here,
api.changes.addListener and api.changes.removeListener.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">api</span><span class="p">.</span><span class="nx">changes</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-138">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-138">&#182;</a>               </div>               <p>If no options were given, set the callback to the first parameter</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{</span><span class="nx">complete</span><span class="o">:</span> <span class="nx">opts</span><span class="p">};</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-139">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-139">&#182;</a>               </div>               <p>If a callback was provided outside of opts, then it is the one that
will be called upon completion</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">opts</span><span class="p">.</span><span class="nx">complete</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="nx">db_url</span> <span class="o">+</span> <span class="s1">&#39;: Start Changes Feed: continuous=&#39;</span> <span class="o">+</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">continuous</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-140">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-140">&#182;</a>               </div>               <p>Query string of all the parameters to add to the GET request</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="s1">&#39;?style=all_docs&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-141">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-141">&#182;</a>               </div>               <p>If opts.include<em>docs exists, opts.filter exists, and opts.filter is a
function, add the include</em>docs value to the query string.
If include_docs=true then include the associated document with each
result.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">include_docs</span> <span class="o">||</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">filter</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">filter</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span> <span class="o">+=</span> <span class="s1">&#39;&amp;include_docs=true&#39;</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-142">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-142">&#182;</a>               </div>               <p>If opts.continuous exists, add the feed value to the query string.
If feed=longpoll then it waits for either a timeout or a change to
occur before returning.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">continuous</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span> <span class="o">+=</span> <span class="s1">&#39;&amp;feed=longpoll&#39;</span><span class="p">;</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-143">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-143">&#182;</a>               </div>               <p>If opts.conflicts exists, add the conflicts value to the query string.
TODO I can't find documentation of what conflicts=true does. See
http://wiki.apache.org/couchdb/HTTP<em>database</em>API#Changes</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">conflicts</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span> <span class="o">+=</span> <span class="s1">&#39;&amp;conflicts=true&#39;</span><span class="p">;</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-144">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-144">&#182;</a>               </div>               <p>If opts.descending exists, add the descending value to the query string.
if descending=true then the change results are returned in
descending order (most recent change first).</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">descending</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span> <span class="o">+=</span> <span class="s1">&#39;&amp;descending=true&#39;</span><span class="p">;</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-145">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-145">&#182;</a>               </div>               <p>If opts.filter exists and is a string then add the filter value
to the query string.
If filter is given a string containing the name of a filter in
the design, then only documents passing through the filter will
be returned.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">filter</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">filter</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">params</span> <span class="o">+=</span> <span class="s1">&#39;&amp;filter=&#39;</span> <span class="o">+</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">filter</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">xhr</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">last_seq</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-146">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-146">&#182;</a>               </div>               <p>Get all the changes starting wtih the one immediately after the
sequence number given by since.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">fetch</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">since</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-147">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-147">&#182;</a>               </div>               <p>Set the options for the ajax call</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">xhrOpts</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">auth</span><span class="o">:</span> <span class="nx">host</span><span class="p">.</span><span class="nx">auth</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span>
        <span class="nx">url</span><span class="o">:</span> <span class="nx">genUrl</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="s1">&#39;_changes&#39;</span> <span class="o">+</span> <span class="nx">params</span> <span class="o">+</span> <span class="s1">&#39;&amp;since=&#39;</span> <span class="o">+</span> <span class="nx">since</span><span class="p">)</span>
      <span class="p">};</span>
      <span class="nx">last_seq</span> <span class="o">=</span> <span class="nx">since</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">aborted</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-148">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-148">&#182;</a>               </div>               <p>Get the changes</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">xhr</span> <span class="o">=</span> <span class="nx">ajax</span><span class="p">(</span><span class="nx">xhrOpts</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">callback</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-149">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-149">&#182;</a>               </div>               <p>If opts.since exists, get all the changes from the sequence
number given by opts.since. Otherwise, get all the changes
from the sequence number 0.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">fetched</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-150">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-150">&#182;</a>               </div>               <p>If the result of the ajax call (res) contains changes (res.results)</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">res</span> <span class="o">&amp;&amp;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">results</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-151">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-151">&#182;</a>               </div>               <p>For each change</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">res</span><span class="p">.</span><span class="nx">results</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">hasFilter</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">filter</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">filter</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">aborted</span> <span class="o">||</span> <span class="nx">hasFilter</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">opts</span><span class="p">.</span><span class="nx">filter</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">[</span><span class="nx">c</span><span class="p">.</span><span class="nx">doc</span><span class="p">]))</span> <span class="p">{</span>
            <span class="k">return</span><span class="p">;</span>
          <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-152">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-152">&#182;</a>               </div>               <p>Process the change</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="nx">call</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">onChange</span><span class="p">,</span> <span class="nx">c</span><span class="p">);</span>
        <span class="p">});</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-153">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-153">&#182;</a>               </div>               <p>The changes feed may have timed out with no results
if so reuse last update sequence</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">res</span> <span class="o">&amp;&amp;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">last_seq</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">last_seq</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">last_seq</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">continuous</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-154">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-154">&#182;</a>               </div>               <p>Call fetch again with the newest sequence number</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">fetch</span><span class="p">(</span><span class="nx">last_seq</span><span class="p">,</span> <span class="nx">fetched</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-155">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-155">&#182;</a>               </div>               <p>We're done, call the callback</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">call</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">complete</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">res</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">};</span>

    <span class="nx">fetch</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">since</span> <span class="o">||</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">fetched</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-156">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-156">&#182;</a>               </div>               <p>Return a method to cancel this method from processing any more</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">cancel</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="nx">db_url</span> <span class="o">+</span> <span class="s1">&#39;: Cancel Changes Feed&#39;</span><span class="p">);</span>
        <span class="nx">opts</span><span class="p">.</span><span class="nx">aborted</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">abort</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">};</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-157">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-157">&#182;</a>               </div>               <p>Given a set of document/revision IDs (given by req), tets the subset of
those that do NOT correspond to revisions stored in the database.
See http://wiki.apache.org/couchdb/HttpPostRevsDiff</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">api</span><span class="p">.</span><span class="nx">revsDiff</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-158">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-158">&#182;</a>               </div>               <p>If no options were given, set the callback to be the second parameter</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-159">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-159">&#182;</a>               </div>               <p>Get the missing document/revision IDs</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">ajax</span><span class="p">({</span>
      <span class="nx">auth</span><span class="o">:</span> <span class="nx">host</span><span class="p">.</span><span class="nx">auth</span><span class="p">,</span>
      <span class="nx">type</span><span class="o">:</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
      <span class="nx">url</span><span class="o">:</span> <span class="nx">genUrl</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="s1">&#39;_revs_diff&#39;</span><span class="p">),</span>
      <span class="nx">data</span><span class="o">:</span> <span class="nx">req</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">res</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">};</span>

  <span class="nx">api</span><span class="p">.</span><span class="nx">replicate</span> <span class="o">=</span> <span class="p">{};</span></pre></div>             </td>           </tr>                               <tr id="section-160">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-160">&#182;</a>               </div>               <p>Replicate from the database given by url to this HttpPouch</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">api</span><span class="p">.</span><span class="nx">replicate</span><span class="p">.</span><span class="nx">from</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-161">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-161">&#182;</a>               </div>               <p>If no options were given, set the callback to be the second parameter</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">replicate</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">api</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-162">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-162">&#182;</a>               </div>               <p>Replicate to the database given by dbName from this HttpPouch</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">api</span><span class="p">.</span><span class="nx">replicate</span><span class="p">.</span><span class="nx">to</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">dbName</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-163">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-163">&#182;</a>               </div>               <p>If no options were given, set the callback to be the second parameter</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">replicate</span><span class="p">(</span><span class="nx">api</span><span class="p">,</span> <span class="nx">dbName</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
  <span class="p">};</span>


  <span class="k">return</span> <span class="nx">api</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-164">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-164">&#182;</a>               </div>               <p>Delete the HttpPouch specified by the given name.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">HttpPouch</span><span class="p">.</span><span class="nx">destroy</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">host</span> <span class="o">=</span> <span class="nx">getHost</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
  <span class="nx">ajax</span><span class="p">({</span><span class="nx">auth</span><span class="o">:</span> <span class="nx">host</span><span class="p">.</span><span class="nx">auth</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">,</span> <span class="nx">url</span><span class="o">:</span> <span class="nx">genUrl</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)},</span> <span class="nx">callback</span><span class="p">);</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-165">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-165">&#182;</a>               </div>               <p>HttpPouch is a valid adapter.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">HttpPouch</span><span class="p">.</span><span class="nx">valid</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">module</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-166">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-166">&#182;</a>               </div>               <p>running in node</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">pouchdir</span> <span class="o">=</span> <span class="s1">&#39;../&#39;</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">Pouch</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="nx">pouchdir</span> <span class="o">+</span> <span class="s1">&#39;pouch.js&#39;</span><span class="p">)</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">ajax</span> <span class="o">=</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">ajax</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-167">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-167">&#182;</a>               </div>               <p>Set HttpPouch to be the adapter used with the http scheme.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Pouch</span><span class="p">.</span><span class="nx">adapter</span><span class="p">(</span><span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="nx">HttpPouch</span><span class="p">);</span>
<span class="nx">Pouch</span><span class="p">.</span><span class="nx">adapter</span><span class="p">(</span><span class="s1">&#39;https&#39;</span><span class="p">,</span> <span class="nx">HttpPouch</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-168">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-168">&#182;</a>               </div>               <p>While most of the IDB behaviors match between implementations a
lot of the names still differ. This section tries to normalize the
different objects &amp; methods.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">window</span><span class="p">.</span><span class="nx">indexedDB</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">indexedDB</span> <span class="o">||</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">mozIndexedDB</span> <span class="o">||</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">webkitIndexedDB</span><span class="p">;</span>

<span class="nb">window</span><span class="p">.</span><span class="nx">IDBKeyRange</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">IDBKeyRange</span> <span class="o">||</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">webkitIDBKeyRange</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">idbError</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">status</span><span class="o">:</span> <span class="mi">500</span><span class="p">,</span>
      <span class="nx">error</span><span class="o">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span>
      <span class="nx">reason</span><span class="o">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">IdbPouch</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-169">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-169">&#182;</a>               </div>               <p>IndexedDB requires a versioned database structure, this is going to make
it hard to dynamically create object stores if we needed to for things
like views</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">POUCH_VERSION</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-170">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-170">&#182;</a>               </div>               <p>The object stores created for each database
DOC_STORE stores the document meta data, its revision history and state</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">DOC_STORE</span> <span class="o">=</span> <span class="s1">&#39;document-store&#39;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-171">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-171">&#182;</a>               </div>               <p>BY<em>SEQ</em>STORE stores a particular version of a document, keyed by its
sequence id</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">BY_SEQ_STORE</span> <span class="o">=</span> <span class="s1">&#39;by-sequence&#39;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-172">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-172">&#182;</a>               </div>               <p>Where we store attachments</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">ATTACH_STORE</span> <span class="o">=</span> <span class="s1">&#39;attach-store&#39;</span><span class="p">;</span>

  <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">req</span> <span class="o">=</span> <span class="nx">indexedDB</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">POUCH_VERSION</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">update_seq</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-173">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-173">&#182;</a>               </div>               <p>Get the webkit file system objects in a way that is forward compatible</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">storageInfo</span> <span class="o">=</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">webkitStorageInfo</span> <span class="o">?</span> <span class="nb">window</span><span class="p">.</span><span class="nx">webkitStorageInfo</span> <span class="o">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">storageInfo</span><span class="p">)</span>
  <span class="kd">var</span> <span class="nx">requestFileSystem</span> <span class="o">=</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">webkitRequestFileSystem</span> <span class="o">?</span> <span class="nb">window</span><span class="p">.</span><span class="nx">webkitRequestFileSystem</span> <span class="o">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">requestFileSystem</span><span class="p">)</span>
  <span class="kd">var</span> <span class="nx">storeAttachmentsInIDB</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">storageInfo</span> <span class="o">||</span> <span class="o">!</span><span class="nx">requestFileSystem</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-174">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-174">&#182;</a>               </div>               <p>This browser does not support the file system API, use idb to store attachments insead</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">storeAttachmentsInIDB</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">api</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="kd">var</span> <span class="nx">idb</span><span class="p">;</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;: Open Database&#39;</span><span class="p">);</span>

  <span class="nx">req</span><span class="p">.</span><span class="nx">onupgradeneeded</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">db</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">;</span>
    <span class="nx">db</span><span class="p">.</span><span class="nx">createObjectStore</span><span class="p">(</span><span class="nx">DOC_STORE</span><span class="p">,</span> <span class="p">{</span><span class="nx">keyPath</span> <span class="o">:</span> <span class="s1">&#39;id&#39;</span><span class="p">})</span>
      <span class="p">.</span><span class="nx">createIndex</span><span class="p">(</span><span class="s1">&#39;seq&#39;</span><span class="p">,</span> <span class="s1">&#39;seq&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">unique</span><span class="o">:</span> <span class="kc">true</span><span class="p">});</span>
    <span class="nx">db</span><span class="p">.</span><span class="nx">createObjectStore</span><span class="p">(</span><span class="nx">BY_SEQ_STORE</span><span class="p">,</span> <span class="p">{</span><span class="nx">autoIncrement</span> <span class="o">:</span> <span class="kc">true</span><span class="p">})</span>
      <span class="p">.</span><span class="nx">createIndex</span><span class="p">(</span><span class="s1">&#39;_rev&#39;</span><span class="p">,</span> <span class="s1">&#39;_rev&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">unique</span><span class="o">:</span> <span class="kc">true</span><span class="p">});;</span>
    <span class="nx">db</span><span class="p">.</span><span class="nx">createObjectStore</span><span class="p">(</span><span class="nx">ATTACH_STORE</span><span class="p">,</span> <span class="p">{</span><span class="nx">keyPath</span><span class="o">:</span> <span class="s1">&#39;digest&#39;</span><span class="p">});</span>
  <span class="p">};</span>

  <span class="nx">req</span><span class="p">.</span><span class="nx">onsuccess</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>

    <span class="nx">idb</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">;</span>

    <span class="nx">idb</span><span class="p">.</span><span class="nx">onversionchange</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">idb</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-175">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-175">&#182;</a>               </div>               <p>polyfill the new onupgradeneeded api for chrome. can get rid of when
http://code.google.com/p/chromium/issues/detail?id=108223 lands</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">idb</span><span class="p">.</span><span class="nx">setVersion</span> <span class="o">&amp;&amp;</span> <span class="nb">Number</span><span class="p">(</span><span class="nx">idb</span><span class="p">.</span><span class="nx">version</span><span class="p">)</span> <span class="o">!==</span> <span class="nx">POUCH_VERSION</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">versionReq</span> <span class="o">=</span> <span class="nx">idb</span><span class="p">.</span><span class="nx">setVersion</span><span class="p">(</span><span class="nx">POUCH_VERSION</span><span class="p">);</span>
      <span class="nx">versionReq</span><span class="p">.</span><span class="nx">onsuccess</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">function</span> <span class="nx">setVersionComplete</span><span class="p">()</span> <span class="p">{</span>
          <span class="nx">req</span><span class="p">.</span><span class="nx">onsuccess</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">evt</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">oncomplete</span> <span class="o">=</span> <span class="nx">setVersionComplete</span><span class="p">;</span>
        <span class="nx">req</span><span class="p">.</span><span class="nx">onupgradeneeded</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
      <span class="p">};</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-176">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-176">&#182;</a>               </div>               <p>TODO: This is a really inneficient way of finding the last
update sequence, cant think of an alterative right now</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">api</span><span class="p">.</span><span class="nx">changes</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">changes</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">changes</span><span class="p">.</span><span class="nx">results</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">update_seq</span> <span class="o">=</span> <span class="nx">changes</span><span class="p">.</span><span class="nx">results</span><span class="p">[</span><span class="nx">changes</span><span class="p">.</span><span class="nx">results</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">seq</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">api</span><span class="p">);</span>
    <span class="p">});</span>

  <span class="p">};</span>

  <span class="nx">req</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="nx">idbError</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-177">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-177">&#182;</a>               </div>               <p>Each database needs a unique id so that we can store the sequence
checkpoint without having other databases confuse itself, since
localstorage is per host this shouldnt conflict, if localstorage
gets wiped it isnt fatal, replications will just start from scratch</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">api</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">idb_id</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">localJSON</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;_id&#39;</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">id</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">id</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">uuid</span><span class="p">();</span>
      <span class="nx">localJSON</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;_id&#39;</span><span class="p">,</span> <span class="nx">id</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">id</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="nx">api</span><span class="p">.</span><span class="nx">bulkDocs</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">idb_bulkDocs</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">req</span><span class="p">.</span><span class="nx">docs</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">Errors</span><span class="p">.</span><span class="nx">MISSING_BULK_DOCS</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">newEdits</span> <span class="o">=</span> <span class="s1">&#39;new_edits&#39;</span> <span class="k">in</span> <span class="nx">opts</span> <span class="o">?</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">new_edits</span> <span class="o">:</span> <span class="kc">true</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">userDocs</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">docs</span><span class="p">));</span></pre></div>             </td>           </tr>                               <tr id="section-178">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-178">&#182;</a>               </div>               <p>Parse the docs, give them a sequence number for the result</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">docInfos</span> <span class="o">=</span> <span class="nx">userDocs</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">newDoc</span> <span class="o">=</span> <span class="nx">parseDoc</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span> <span class="nx">newEdits</span><span class="p">);</span>
      <span class="nx">newDoc</span><span class="p">.</span><span class="nx">_bulk_seq</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
      <span class="k">return</span> <span class="nx">newDoc</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="kd">var</span> <span class="nx">results</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">docs</span> <span class="o">=</span> <span class="p">[];</span></pre></div>             </td>           </tr>                               <tr id="section-179">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-179">&#182;</a>               </div>               <p>Group multiple edits to the same document</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">docInfos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">docInfo</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">docInfo</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">docInfo</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">docs</span><span class="p">.</span><span class="nx">length</span> <span class="o">||</span> <span class="nx">docInfo</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">id</span> <span class="o">!==</span> <span class="nx">docs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">docs</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">docInfo</span><span class="p">);</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-180">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-180">&#182;</a>               </div>               <p>We mark subsequent bulk docs with a duplicate id as conflicts</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">makeErr</span><span class="p">(</span><span class="nx">Pouch</span><span class="p">.</span><span class="nx">Errors</span><span class="p">.</span><span class="nx">REV_CONFLICT</span><span class="p">,</span> <span class="nx">docInfo</span><span class="p">.</span><span class="nx">_bulk_seq</span><span class="p">));</span>
    <span class="p">});</span>

    <span class="kd">var</span> <span class="nx">txn</span> <span class="o">=</span> <span class="nx">idb</span><span class="p">.</span><span class="nx">transaction</span><span class="p">([</span><span class="nx">DOC_STORE</span><span class="p">,</span> <span class="nx">BY_SEQ_STORE</span><span class="p">,</span> <span class="nx">ATTACH_STORE</span><span class="p">],</span> <span class="s1">&#39;readwrite&#39;</span><span class="p">);</span>
    <span class="nx">txn</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="nx">idbError</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
    <span class="nx">txn</span><span class="p">.</span><span class="nx">ontimeout</span> <span class="o">=</span> <span class="nx">idbError</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>

    <span class="nx">processDocs</span><span class="p">();</span>

    <span class="kd">function</span> <span class="nx">processDocs</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">docs</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">complete</span><span class="p">();</span>
      <span class="p">}</span>
      <span class="kd">var</span> <span class="nx">currentDoc</span> <span class="o">=</span> <span class="nx">docs</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
      <span class="kd">var</span> <span class="nx">req</span> <span class="o">=</span> <span class="nx">txn</span><span class="p">.</span><span class="nx">objectStore</span><span class="p">(</span><span class="nx">DOC_STORE</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="nx">currentDoc</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
      <span class="nx">req</span><span class="p">.</span><span class="nx">onsuccess</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">process_docRead</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">oldDoc</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">oldDoc</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">insertDoc</span><span class="p">(</span><span class="nx">currentDoc</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">updateDoc</span><span class="p">(</span><span class="nx">oldDoc</span><span class="p">,</span> <span class="nx">currentDoc</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">complete</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">aresults</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="nx">results</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="nx">sortByBulkSeq</span><span class="p">);</span>
      <span class="nx">results</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">delete</span> <span class="nx">result</span><span class="p">.</span><span class="nx">_bulk_seq</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">aresults</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
          <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">metadata</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">metadata</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">rev</span> <span class="o">=</span> <span class="nx">winningRev</span><span class="p">(</span><span class="nx">metadata</span><span class="p">);</span>

        <span class="nx">aresults</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
          <span class="nx">ok</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
          <span class="nx">id</span><span class="o">:</span> <span class="nx">metadata</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
          <span class="nx">rev</span><span class="o">:</span> <span class="nx">rev</span><span class="p">,</span>
        <span class="p">});</span>

        <span class="k">if</span> <span class="p">(</span><span class="sr">/_local/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">id</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kd">var</span> <span class="nx">change</span> <span class="o">=</span> <span class="p">{</span>
          <span class="nx">id</span><span class="o">:</span> <span class="nx">metadata</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
          <span class="nx">seq</span><span class="o">:</span> <span class="nx">metadata</span><span class="p">.</span><span class="nx">seq</span><span class="p">,</span>
          <span class="nx">changes</span><span class="o">:</span> <span class="nx">collectLeaves</span><span class="p">(</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">rev_tree</span><span class="p">),</span>
          <span class="nx">doc</span><span class="o">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">data</span>
        <span class="p">};</span>
        <span class="nx">change</span><span class="p">.</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_rev</span> <span class="o">=</span> <span class="nx">rev</span><span class="p">;</span>
        <span class="nx">update_seq</span><span class="o">++</span><span class="p">;</span>
        <span class="nx">IdbPouch</span><span class="p">.</span><span class="nx">Changes</span><span class="p">.</span><span class="nx">emitChange</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">change</span><span class="p">);</span>
      <span class="p">});</span>
      <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">aresults</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">writeDoc</span><span class="p">(</span><span class="nx">docInfo</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">err</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">recv</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

      <span class="nx">docInfo</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">_id</span> <span class="o">=</span> <span class="nx">docInfo</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
      <span class="nx">docInfo</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">_rev</span> <span class="o">=</span> <span class="nx">docInfo</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">rev</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">docInfo</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">deleted</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">docInfo</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">_deleted</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="kd">var</span> <span class="nx">attachments</span> <span class="o">=</span> <span class="nx">docInfo</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">_attachments</span>
        <span class="o">?</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">docInfo</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">)</span>
        <span class="o">:</span> <span class="p">[];</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">docInfo</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">docInfo</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">[</span><span class="nx">key</span><span class="p">].</span><span class="nx">stub</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">docInfo</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">[</span><span class="nx">key</span><span class="p">].</span><span class="nx">data</span><span class="p">;</span>
          <span class="kd">var</span> <span class="nx">digest</span> <span class="o">=</span> <span class="s1">&#39;md5-&#39;</span> <span class="o">+</span> <span class="nx">Crypto</span><span class="p">.</span><span class="nx">MD5</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
          <span class="k">delete</span> <span class="nx">docInfo</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">[</span><span class="nx">key</span><span class="p">].</span><span class="nx">data</span><span class="p">;</span>
          <span class="nx">docInfo</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">[</span><span class="nx">key</span><span class="p">].</span><span class="nx">digest</span> <span class="o">=</span> <span class="nx">digest</span><span class="p">;</span>
          <span class="nx">saveAttachment</span><span class="p">(</span><span class="nx">docInfo</span><span class="p">,</span> <span class="nx">digest</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">recv</span><span class="o">++</span><span class="p">;</span>
            <span class="nx">collectResults</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
          <span class="p">});</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">recv</span><span class="o">++</span><span class="p">;</span>
          <span class="nx">collectResults</span><span class="p">();</span>
        <span class="p">}</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">attachments</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">finish</span><span class="p">();</span>
      <span class="p">}</span>

      <span class="kd">function</span> <span class="nx">collectResults</span><span class="p">(</span><span class="nx">attachmentErr</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">attachmentErr</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">err</span> <span class="o">=</span> <span class="nx">attachmentErr</span><span class="p">;</span>
            <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
          <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">recv</span> <span class="o">==</span> <span class="nx">attachments</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">finish</span><span class="p">();</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>

      <span class="kd">function</span> <span class="nx">finish</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">dataReq</span> <span class="o">=</span> <span class="nx">txn</span><span class="p">.</span><span class="nx">objectStore</span><span class="p">(</span><span class="nx">BY_SEQ_STORE</span><span class="p">).</span><span class="nx">put</span><span class="p">(</span><span class="nx">docInfo</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
        <span class="nx">dataReq</span><span class="p">.</span><span class="nx">onsuccess</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;: Wrote Document &#39;</span><span class="p">,</span> <span class="nx">docInfo</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
          <span class="nx">docInfo</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">seq</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-181">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-181">&#182;</a>               </div>               <p>Current <em>rev is calculated from _rev</em>tree on read</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="k">delete</span> <span class="nx">docInfo</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">rev</span><span class="p">;</span>
          <span class="kd">var</span> <span class="nx">metaDataReq</span> <span class="o">=</span> <span class="nx">txn</span><span class="p">.</span><span class="nx">objectStore</span><span class="p">(</span><span class="nx">DOC_STORE</span><span class="p">).</span><span class="nx">put</span><span class="p">(</span><span class="nx">docInfo</span><span class="p">.</span><span class="nx">metadata</span><span class="p">);</span>
          <span class="nx">metaDataReq</span><span class="p">.</span><span class="nx">onsuccess</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">docInfo</span><span class="p">);</span>
            <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
          <span class="p">};</span>
        <span class="p">};</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">updateDoc</span><span class="p">(</span><span class="nx">oldDoc</span><span class="p">,</span> <span class="nx">docInfo</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">merged</span> <span class="o">=</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">oldDoc</span><span class="p">.</span><span class="nx">rev_tree</span><span class="p">,</span>
                               <span class="nx">docInfo</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">rev_tree</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1000</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">inConflict</span> <span class="o">=</span> <span class="p">(</span><span class="nx">oldDoc</span><span class="p">.</span><span class="nx">deleted</span> <span class="o">&amp;&amp;</span> <span class="nx">docInfo</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">deleted</span><span class="p">)</span> <span class="o">||</span>
        <span class="p">(</span><span class="o">!</span><span class="nx">oldDoc</span><span class="p">.</span><span class="nx">deleted</span> <span class="o">&amp;&amp;</span> <span class="nx">newEdits</span> <span class="o">&amp;&amp;</span> <span class="nx">merged</span><span class="p">.</span><span class="nx">conflicts</span> <span class="o">!==</span> <span class="s1">&#39;new_leaf&#39;</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">inConflict</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">makeErr</span><span class="p">(</span><span class="nx">Pouch</span><span class="p">.</span><span class="nx">Errors</span><span class="p">.</span><span class="nx">REV_CONFLICT</span><span class="p">,</span> <span class="nx">docInfo</span><span class="p">.</span><span class="nx">_bulk_seq</span><span class="p">));</span>
        <span class="k">return</span> <span class="nx">processDocs</span><span class="p">();</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">docInfo</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">deleted</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="s1">&#39;deletions&#39;</span> <span class="k">in</span> <span class="nx">docInfo</span><span class="p">.</span><span class="nx">metadata</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">docInfo</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">deletions</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="p">}</span>
        <span class="nx">docInfo</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">deletions</span><span class="p">[</span><span class="nx">docInfo</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">rev</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="nx">docInfo</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">rev_tree</span> <span class="o">=</span> <span class="nx">merged</span><span class="p">.</span><span class="nx">tree</span><span class="p">;</span>
      <span class="nx">writeDoc</span><span class="p">(</span><span class="nx">docInfo</span><span class="p">,</span> <span class="nx">processDocs</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">insertDoc</span><span class="p">(</span><span class="nx">docInfo</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-182">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-182">&#182;</a>               </div>               <p>Cant insert new deleted documents</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;was_delete&#39;</span> <span class="k">in</span> <span class="nx">opts</span> <span class="o">&amp;&amp;</span> <span class="nx">docInfo</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">deleted</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">Pouch</span><span class="p">.</span><span class="nx">Errors</span><span class="p">.</span><span class="nx">MISSING_DOC</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">processDocs</span><span class="p">();</span>
      <span class="p">}</span>
      <span class="nx">writeDoc</span><span class="p">(</span><span class="nx">docInfo</span><span class="p">,</span> <span class="nx">processDocs</span><span class="p">);</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-183">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-183">&#182;</a>               </div>               <p>Insert sequence number into the error so we can sort later</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">makeErr</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">seq</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">err</span><span class="p">.</span><span class="nx">_bulk_seq</span> <span class="o">=</span> <span class="nx">seq</span><span class="p">;</span>
      <span class="k">return</span> <span class="nx">err</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">saveAttachment</span><span class="p">(</span><span class="nx">docInfo</span><span class="p">,</span> <span class="nx">digest</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">storeAttachmentsInIDB</span><span class="p">){</span>
        <span class="kd">var</span> <span class="nx">objectStore</span> <span class="o">=</span> <span class="nx">txn</span><span class="p">.</span><span class="nx">objectStore</span><span class="p">(</span><span class="nx">ATTACH_STORE</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">getReq</span> <span class="o">=</span> <span class="nx">objectStore</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">digest</span><span class="p">).</span><span class="nx">onsuccess</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">ref</span> <span class="o">=</span> <span class="p">[</span><span class="nx">docInfo</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">docInfo</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">rev</span><span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">);</span>
          <span class="kd">var</span> <span class="nx">newAtt</span> <span class="o">=</span> <span class="p">{</span><span class="nx">digest</span><span class="o">:</span> <span class="nx">digest</span><span class="p">,</span> <span class="nx">body</span><span class="o">:</span> <span class="nx">data</span><span class="p">};</span>

          <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">refs</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-184">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-184">&#182;</a>               </div>               <p>only update references if this attachment already has them
since we cannot migrate old style attachments here without
doing a full db scan for references</p>             </td>             <td class="code">               <div class="highlight"><pre>              <span class="nx">newAtt</span><span class="p">.</span><span class="nx">refs</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">refs</span><span class="p">;</span>
              <span class="nx">newAtt</span><span class="p">.</span><span class="nx">refs</span><span class="p">[</span><span class="nx">ref</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">newAtt</span><span class="p">.</span><span class="nx">refs</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="nx">newAtt</span><span class="p">.</span><span class="nx">refs</span><span class="p">[</span><span class="nx">ref</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
          <span class="p">}</span>

          <span class="kd">var</span> <span class="nx">putReq</span> <span class="o">=</span> <span class="nx">objectStore</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="nx">newAtt</span><span class="p">).</span><span class="nx">onsuccess</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
          <span class="p">};</span>
          <span class="nx">putReq</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="nx">putReq</span><span class="p">.</span><span class="nx">ontimeout</span> <span class="o">=</span> <span class="nx">idbError</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
        <span class="p">};</span>
        <span class="nx">getReq</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="nx">getReq</span><span class="p">.</span><span class="nx">ontimeout</span> <span class="o">=</span> <span class="nx">idbError</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
      <span class="p">}</span><span class="k">else</span><span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-185">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-185">&#182;</a>               </div>               <p>right now fire and forget, needs cleaned</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">writeAttachmentToFile</span><span class="p">(</span><span class="nx">digest</span><span class="p">,</span><span class="nx">data</span><span class="p">);</span>
        <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="kd">function</span> <span class="nx">sortByBulkSeq</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">_bulk_seq</span> <span class="o">-</span> <span class="nx">b</span><span class="p">.</span><span class="nx">_bulk_seq</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-186">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-186">&#182;</a>               </div>               <p>First we look up the metadata in the ids database, then we fetch the
current revision(s) from the by sequence store</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">api</span><span class="p">.</span><span class="nx">get</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">idb_get</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span>

    <span class="nx">id</span> <span class="o">=</span> <span class="nx">parseDocId</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">id</span><span class="p">.</span><span class="nx">attachmentId</span> <span class="o">!==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">api</span><span class="p">.</span><span class="nx">getAttachment</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="p">{</span><span class="nx">decode</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span> <span class="nx">callback</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">txn</span> <span class="o">=</span> <span class="nx">idb</span><span class="p">.</span><span class="nx">transaction</span><span class="p">([</span><span class="nx">DOC_STORE</span><span class="p">,</span> <span class="nx">BY_SEQ_STORE</span><span class="p">,</span> <span class="nx">ATTACH_STORE</span><span class="p">],</span> <span class="s1">&#39;readonly&#39;</span><span class="p">);</span>

    <span class="nx">txn</span><span class="p">.</span><span class="nx">objectStore</span><span class="p">(</span><span class="nx">DOC_STORE</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="nx">id</span><span class="p">.</span><span class="nx">docId</span><span class="p">).</span><span class="nx">onsuccess</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">metadata</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span> <span class="o">||</span> <span class="p">(</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">deleted</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">opts</span><span class="p">.</span><span class="nx">rev</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">Errors</span><span class="p">.</span><span class="nx">MISSING_DOC</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="kd">var</span> <span class="nx">rev</span> <span class="o">=</span> <span class="nx">winningRev</span><span class="p">(</span><span class="nx">metadata</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">rev</span> <span class="o">?</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">rev</span> <span class="o">:</span> <span class="nx">rev</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">txn</span><span class="p">.</span><span class="nx">objectStore</span><span class="p">(</span><span class="nx">BY_SEQ_STORE</span><span class="p">).</span><span class="nx">index</span><span class="p">(</span><span class="s1">&#39;_rev&#39;</span><span class="p">);</span>

      <span class="nx">index</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">key</span><span class="p">).</span><span class="nx">onsuccess</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">doc</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">revs</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">arrayFirst</span><span class="p">(</span><span class="nx">rootToLeaf</span><span class="p">(</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">rev_tree</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">ids</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_rev</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
          <span class="p">});</span>
          <span class="nx">path</span><span class="p">.</span><span class="nx">ids</span><span class="p">.</span><span class="nx">reverse</span><span class="p">();</span>
          <span class="nx">doc</span><span class="p">.</span><span class="nx">_revisions</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">start</span><span class="o">:</span> <span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">pos</span> <span class="o">+</span> <span class="nx">path</span><span class="p">.</span><span class="nx">ids</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nx">ids</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">ids</span>
          <span class="p">};</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">revs_info</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">doc</span><span class="p">.</span><span class="nx">_revs_info</span> <span class="o">=</span> <span class="nx">metadata</span><span class="p">.</span><span class="nx">rev_tree</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="nx">current</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">prev</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">collectRevs</span><span class="p">(</span><span class="nx">current</span><span class="p">));</span>
          <span class="p">},</span> <span class="p">[]);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">conflicts</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">conflicts</span> <span class="o">=</span> <span class="nx">collectConflicts</span><span class="p">(</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">rev_tree</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">conflicts</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">doc</span><span class="p">.</span><span class="nx">_conflicts</span> <span class="o">=</span> <span class="nx">conflicts</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">attachments</span> <span class="o">&amp;&amp;</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">attachments</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">);</span>
          <span class="kd">var</span> <span class="nx">recv</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

          <span class="nx">attachments</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">api</span><span class="p">.</span><span class="nx">getAttachment</span><span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_id</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nx">key</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">doc</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">[</span><span class="nx">key</span><span class="p">].</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>

              <span class="k">if</span> <span class="p">(</span><span class="o">++</span><span class="nx">recv</span> <span class="o">===</span> <span class="nx">attachments</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">doc</span><span class="p">);</span>
              <span class="p">}</span>
            <span class="p">});</span>
          <span class="p">});</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">){</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">doc</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">[</span><span class="nx">key</span><span class="p">].</span><span class="nx">stub</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">doc</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">};</span>
    <span class="p">};</span>
  <span class="p">};</span>

  <span class="nx">api</span><span class="p">.</span><span class="nx">getAttachment</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span> <span class="k">instanceof</span> <span class="nb">Function</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">id</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">id</span> <span class="o">=</span> <span class="nx">parseDocId</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">txn</span> <span class="o">=</span> <span class="nx">idb</span><span class="p">.</span><span class="nx">transaction</span><span class="p">([</span><span class="nx">DOC_STORE</span><span class="p">,</span> <span class="nx">BY_SEQ_STORE</span><span class="p">,</span> <span class="nx">ATTACH_STORE</span><span class="p">],</span> <span class="s1">&#39;readonly&#39;</span><span class="p">);</span>
    <span class="nx">txn</span><span class="p">.</span><span class="nx">objectStore</span><span class="p">(</span><span class="nx">DOC_STORE</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="nx">id</span><span class="p">.</span><span class="nx">docId</span><span class="p">).</span><span class="nx">onsuccess</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">metadata</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">bySeq</span> <span class="o">=</span> <span class="nx">txn</span><span class="p">.</span><span class="nx">objectStore</span><span class="p">(</span><span class="nx">BY_SEQ_STORE</span><span class="p">);</span>
      <span class="nx">bySeq</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">seq</span><span class="p">).</span><span class="nx">onsuccess</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">attachment</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">[</span><span class="nx">id</span><span class="p">.</span><span class="nx">attachmentId</span><span class="p">]</span>
          <span class="p">,</span> <span class="nx">digest</span> <span class="o">=</span> <span class="nx">attachment</span><span class="p">.</span><span class="nx">digest</span>
          <span class="p">,</span> <span class="nx">type</span> <span class="o">=</span> <span class="nx">attachment</span><span class="p">.</span><span class="nx">content_type</span>

        <span class="kd">function</span> <span class="nx">postProcessDoc</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">decode</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">data</span> <span class="o">=</span> <span class="nx">atob</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">return</span> <span class="nx">data</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">storeAttachmentsInIDB</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">txn</span><span class="p">.</span><span class="nx">objectStore</span><span class="p">(</span><span class="nx">ATTACH_STORE</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="nx">digest</span><span class="p">).</span><span class="nx">onsuccess</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
            <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">postProcessDoc</span><span class="p">(</span><span class="nx">data</span><span class="p">));</span>
          <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="nx">readAttachmentFromFile</span><span class="p">(</span><span class="nx">digest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">postProcessDoc</span><span class="p">(</span><span class="nx">data</span><span class="p">));</span>
          <span class="p">});</span>
        <span class="p">}</span>
      <span class="p">};</span>
    <span class="p">}</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">api</span><span class="p">.</span><span class="nx">put</span> <span class="o">=</span> <span class="nx">api</span><span class="p">.</span><span class="nx">post</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">idb_put</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">api</span><span class="p">.</span><span class="nx">bulkDocs</span><span class="p">({</span><span class="nx">docs</span><span class="o">:</span> <span class="p">[</span><span class="nx">doc</span><span class="p">]},</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">yankError</span><span class="p">(</span><span class="nx">callback</span><span class="p">));</span>
  <span class="p">};</span>

  <span class="nx">api</span><span class="p">.</span><span class="nx">putAttachment</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">idb_putAttachment</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">rev</span><span class="p">,</span> <span class="nx">doc</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">id</span> <span class="o">=</span> <span class="nx">parseDocId</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
    <span class="nx">api</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">id</span><span class="p">.</span><span class="nx">docId</span><span class="p">,</span> <span class="p">{</span><span class="nx">attachments</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">obj</span><span class="p">.</span><span class="nx">_attachments</span> <span class="o">||</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">_attachments</span> <span class="o">=</span> <span class="p">{});</span>
      <span class="nx">obj</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">[</span><span class="nx">id</span><span class="p">.</span><span class="nx">attachmentId</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">content_type</span><span class="o">:</span> <span class="nx">type</span><span class="p">,</span>
        <span class="nx">data</span><span class="o">:</span> <span class="nx">btoa</span><span class="p">(</span><span class="nx">doc</span><span class="p">)</span>
      <span class="p">}</span>
      <span class="nx">api</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">};</span>

  <span class="nx">api</span><span class="p">.</span><span class="nx">remove</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">idb_remove</span><span class="p">(</span><span class="nx">doc</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span>
    <span class="nx">opts</span><span class="p">.</span><span class="nx">was_delete</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">newDoc</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">doc</span><span class="p">));</span>
    <span class="nx">newDoc</span><span class="p">.</span><span class="nx">_deleted</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">api</span><span class="p">.</span><span class="nx">bulkDocs</span><span class="p">({</span><span class="nx">docs</span><span class="o">:</span> <span class="p">[</span><span class="nx">newDoc</span><span class="p">]},</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">yankError</span><span class="p">(</span><span class="nx">callback</span><span class="p">));</span>
  <span class="p">};</span>

  <span class="nx">api</span><span class="p">.</span><span class="nx">removeAttachment</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">idb_removeAttachment</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">rev</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">id</span> <span class="o">=</span> <span class="nx">parseDocId</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
    <span class="nx">api</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">id</span><span class="p">.</span><span class="nx">docId</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">_rev</span> <span class="o">!=</span> <span class="nx">rev</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">Errors</span><span class="p">.</span><span class="nx">REV_CONFLICT</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="nx">obj</span><span class="p">.</span><span class="nx">_attachments</span> <span class="o">||</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">_attachments</span> <span class="o">=</span> <span class="p">{});</span>
      <span class="k">delete</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">[</span><span class="nx">id</span><span class="p">.</span><span class="nx">attachmentId</span><span class="p">];</span>
      <span class="nx">api</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">};</span>

  <span class="nx">api</span><span class="p">.</span><span class="nx">allDocs</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">idb_allDocs</span><span class="p">(</span><span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">start</span> <span class="o">=</span> <span class="s1">&#39;startkey&#39;</span> <span class="k">in</span> <span class="nx">opts</span> <span class="o">?</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">startkey</span> <span class="o">:</span> <span class="kc">false</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">end</span> <span class="o">=</span> <span class="s1">&#39;endkey&#39;</span> <span class="k">in</span> <span class="nx">opts</span> <span class="o">?</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">endkey</span> <span class="o">:</span> <span class="kc">false</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">descending</span> <span class="o">=</span> <span class="s1">&#39;descending&#39;</span> <span class="k">in</span> <span class="nx">opts</span> <span class="o">?</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">descending</span> <span class="o">:</span> <span class="kc">false</span><span class="p">;</span>
    <span class="nx">descending</span> <span class="o">=</span> <span class="nx">descending</span> <span class="o">?</span> <span class="s1">&#39;prev&#39;</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">keyRange</span> <span class="o">=</span> <span class="nx">start</span> <span class="o">&amp;&amp;</span> <span class="nx">end</span> <span class="o">?</span> <span class="nx">IDBKeyRange</span><span class="p">.</span><span class="nx">bound</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">end</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span>
      <span class="o">:</span> <span class="nx">start</span> <span class="o">?</span> <span class="nx">IDBKeyRange</span><span class="p">.</span><span class="nx">lowerBound</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
      <span class="o">:</span> <span class="nx">end</span> <span class="o">?</span> <span class="nx">IDBKeyRange</span><span class="p">.</span><span class="nx">upperBound</span><span class="p">(</span><span class="nx">end</span><span class="p">)</span> <span class="o">:</span> <span class="kc">false</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">transaction</span> <span class="o">=</span> <span class="nx">idb</span><span class="p">.</span><span class="nx">transaction</span><span class="p">([</span><span class="nx">DOC_STORE</span><span class="p">,</span> <span class="nx">BY_SEQ_STORE</span><span class="p">],</span> <span class="s1">&#39;readonly&#39;</span><span class="p">);</span>
    <span class="nx">keyRange</span> <span class="o">=</span> <span class="nx">keyRange</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">oStore</span> <span class="o">=</span> <span class="nx">transaction</span><span class="p">.</span><span class="nx">objectStore</span><span class="p">(</span><span class="nx">DOC_STORE</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">oCursor</span> <span class="o">=</span> <span class="nx">descending</span> <span class="o">?</span> <span class="nx">oStore</span><span class="p">.</span><span class="nx">openCursor</span><span class="p">(</span><span class="nx">keyRange</span><span class="p">,</span> <span class="nx">descending</span><span class="p">)</span>
      <span class="o">:</span> <span class="nx">oStore</span><span class="p">.</span><span class="nx">openCursor</span><span class="p">(</span><span class="nx">keyRange</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">results</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="nx">oCursor</span><span class="p">.</span><span class="nx">onsuccess</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">{</span>
          <span class="nx">total_rows</span><span class="o">:</span> <span class="nx">results</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
          <span class="nx">rows</span><span class="o">:</span> <span class="nx">results</span>
        <span class="p">});</span>
      <span class="p">}</span>
      <span class="kd">var</span> <span class="nx">cursor</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">;</span>
      <span class="kd">function</span> <span class="nx">allDocsInner</span><span class="p">(</span><span class="nx">metadata</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="sr">/_local/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">id</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">cursor</span><span class="p">[</span><span class="s1">&#39;continue&#39;</span><span class="p">]();</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">deleted</span> <span class="o">!==</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">doc</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">id</span><span class="o">:</span> <span class="nx">metadata</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
            <span class="nx">key</span><span class="o">:</span> <span class="nx">metadata</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
            <span class="nx">value</span><span class="o">:</span> <span class="p">{</span>
              <span class="nx">rev</span><span class="o">:</span> <span class="nx">winningRev</span><span class="p">(</span><span class="nx">metadata</span><span class="p">)</span>
            <span class="p">}</span>
          <span class="p">};</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">include_docs</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">doc</span><span class="p">.</span><span class="nx">doc</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
            <span class="nx">doc</span><span class="p">.</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_rev</span> <span class="o">=</span> <span class="nx">winningRev</span><span class="p">(</span><span class="nx">metadata</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">conflicts</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">doc</span><span class="p">.</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_conflicts</span> <span class="o">=</span> <span class="nx">collectConflicts</span><span class="p">(</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">rev_tree</span><span class="p">);</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">doc</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">cursor</span><span class="p">[</span><span class="s1">&#39;continue&#39;</span><span class="p">]();</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">opts</span><span class="p">.</span><span class="nx">include_docs</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">allDocsInner</span><span class="p">(</span><span class="nx">cursor</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">transaction</span><span class="p">.</span><span class="nx">objectStore</span><span class="p">(</span><span class="nx">BY_SEQ_STORE</span><span class="p">);</span>
        <span class="nx">index</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">cursor</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">seq</span><span class="p">).</span><span class="nx">onsuccess</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">allDocsInner</span><span class="p">(</span><span class="nx">cursor</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">);</span>
        <span class="p">};</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-187">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-187">&#182;</a>               </div>               <p>Looping through all the documents in the database is a terrible idea
easiest to implement though, should probably keep a counter</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">api</span><span class="p">.</span><span class="nx">info</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">idb_info</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">idb</span><span class="p">.</span><span class="nx">transaction</span><span class="p">([</span><span class="nx">DOC_STORE</span><span class="p">],</span> <span class="s1">&#39;readonly&#39;</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">objectStore</span><span class="p">(</span><span class="nx">DOC_STORE</span><span class="p">).</span><span class="nx">openCursor</span><span class="p">().</span><span class="nx">onsuccess</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">cursor</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">cursor</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">{</span>
            <span class="nx">db_name</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span>
            <span class="nx">doc_count</span><span class="o">:</span> <span class="nx">count</span><span class="p">,</span>
            <span class="nx">update_seq</span><span class="o">:</span> <span class="nx">update_seq</span>
          <span class="p">});</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">cursor</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">deleted</span> <span class="o">!==</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">count</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">cursor</span><span class="p">[</span><span class="s1">&#39;continue&#39;</span><span class="p">]();</span>
      <span class="p">};</span>
  <span class="p">};</span>

  <span class="nx">api</span><span class="p">.</span><span class="nx">revsDiff</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">idb_revsDiff</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">ids</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">req</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">missing</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="kd">function</span> <span class="nx">readDoc</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">doc</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">req</span><span class="p">[</span><span class="nx">id</span><span class="p">].</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">revId</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">matches</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">x</span><span class="p">.</span><span class="nx">rev</span> <span class="o">!==</span> <span class="nx">revId</span><span class="p">;</span> <span class="p">};</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">doc</span> <span class="o">||</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">_revs_info</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="nx">matches</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">missing</span><span class="p">[</span><span class="nx">id</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">missing</span><span class="p">[</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="nx">missing</span><span class="o">:</span> <span class="p">[]};</span>
          <span class="p">}</span>
          <span class="nx">missing</span><span class="p">[</span><span class="nx">id</span><span class="p">].</span><span class="nx">missing</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">revId</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">});</span>

      <span class="k">if</span> <span class="p">(</span><span class="o">++</span><span class="nx">count</span> <span class="o">===</span> <span class="nx">ids</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">missing</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">ids</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">api</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="p">{</span><span class="nx">revs_info</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">doc</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">readDoc</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">doc</span><span class="p">,</span> <span class="nx">id</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">});</span>
  <span class="p">};</span>

  <span class="nx">api</span><span class="p">.</span><span class="nx">changes</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">idb_changes</span><span class="p">(</span><span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{</span><span class="nx">complete</span><span class="o">:</span> <span class="nx">opts</span><span class="p">};</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">opts</span><span class="p">.</span><span class="nx">complete</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">opts</span><span class="p">.</span><span class="nx">seq</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">opts</span><span class="p">.</span><span class="nx">seq</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">since</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">opts</span><span class="p">.</span><span class="nx">seq</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">since</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;: Start Changes Feed: continuous=&#39;</span> <span class="o">+</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">continuous</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">descending</span> <span class="o">=</span> <span class="s1">&#39;descending&#39;</span> <span class="k">in</span> <span class="nx">opts</span> <span class="o">?</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">descending</span> <span class="o">:</span> <span class="kc">false</span><span class="p">;</span>
    <span class="nx">descending</span> <span class="o">=</span> <span class="nx">descending</span> <span class="o">?</span> <span class="s1">&#39;prev&#39;</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">results</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">resultIndices</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">dedupResults</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">uuid</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">txn</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">filter</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">filter</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">filterName</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">filter</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
      <span class="nx">api</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;_design/&#39;</span> <span class="o">+</span> <span class="nx">filterName</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">ddoc</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">filter</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;(function() { return &#39;</span> <span class="o">+</span>
                          <span class="nx">ddoc</span><span class="p">.</span><span class="nx">filters</span><span class="p">[</span><span class="nx">filterName</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39; })()&#39;</span><span class="p">);</span>
        <span class="nx">opts</span><span class="p">.</span><span class="nx">filter</span> <span class="o">=</span> <span class="nx">filter</span><span class="p">;</span>
        <span class="nx">fetchChanges</span><span class="p">();</span>
      <span class="p">});</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">fetchChanges</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">fetchChanges</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">txn</span> <span class="o">=</span> <span class="nx">idb</span><span class="p">.</span><span class="nx">transaction</span><span class="p">([</span><span class="nx">DOC_STORE</span><span class="p">,</span> <span class="nx">BY_SEQ_STORE</span><span class="p">]);</span>
      <span class="nx">txn</span><span class="p">.</span><span class="nx">oncomplete</span> <span class="o">=</span> <span class="nx">onTxnComplete</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">req</span> <span class="o">=</span> <span class="nx">descending</span>
        <span class="o">?</span> <span class="nx">txn</span><span class="p">.</span><span class="nx">objectStore</span><span class="p">(</span><span class="nx">BY_SEQ_STORE</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">openCursor</span><span class="p">(</span><span class="nx">IDBKeyRange</span><span class="p">.</span><span class="nx">lowerBound</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">seq</span><span class="p">,</span> <span class="kc">true</span><span class="p">),</span> <span class="nx">descending</span><span class="p">)</span>
        <span class="o">:</span> <span class="nx">txn</span><span class="p">.</span><span class="nx">objectStore</span><span class="p">(</span><span class="nx">BY_SEQ_STORE</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">openCursor</span><span class="p">(</span><span class="nx">IDBKeyRange</span><span class="p">.</span><span class="nx">lowerBound</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">seq</span><span class="p">,</span> <span class="kc">true</span><span class="p">));</span>
      <span class="nx">req</span><span class="p">.</span><span class="nx">onsuccess</span> <span class="o">=</span> <span class="nx">onsuccess</span><span class="p">;</span>
      <span class="nx">req</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="nx">onerror</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">onsuccess</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">continuous</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">opts</span><span class="p">.</span><span class="nx">cancelled</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">IdbPouch</span><span class="p">.</span><span class="nx">Changes</span><span class="p">.</span><span class="nx">addListener</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">opts</span><span class="p">);</span>
        <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-188">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-188">&#182;</a>               </div>               <p>Filter out null results casued by deduping</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">results</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">results</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="nx">dedupResults</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">dedupResults</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">filter</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">opts</span><span class="p">.</span><span class="nx">filter</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">[</span><span class="nx">c</span><span class="p">.</span><span class="nx">doc</span><span class="p">]))</span> <span class="p">{</span>
            <span class="k">return</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">opts</span><span class="p">.</span><span class="nx">include_docs</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">delete</span> <span class="nx">c</span><span class="p">.</span><span class="nx">doc</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="nx">call</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">onChange</span><span class="p">,</span> <span class="nx">c</span><span class="p">);</span>
        <span class="p">});</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="kd">var</span> <span class="nx">cursor</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">txn</span><span class="p">.</span><span class="nx">objectStore</span><span class="p">(</span><span class="nx">DOC_STORE</span><span class="p">);</span>
      <span class="nx">index</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">cursor</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">_id</span><span class="p">).</span><span class="nx">onsuccess</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">metadata</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="sr">/_local/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">id</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">cursor</span><span class="p">[</span><span class="s1">&#39;continue&#39;</span><span class="p">]();</span>
        <span class="p">}</span>

        <span class="kd">var</span> <span class="nx">change</span> <span class="o">=</span> <span class="p">{</span>
          <span class="nx">id</span><span class="o">:</span> <span class="nx">metadata</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
          <span class="nx">seq</span><span class="o">:</span> <span class="nx">cursor</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span>
          <span class="nx">changes</span><span class="o">:</span> <span class="nx">collectLeaves</span><span class="p">(</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">rev_tree</span><span class="p">),</span>
          <span class="nx">doc</span><span class="o">:</span> <span class="nx">cursor</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
        <span class="p">};</span>

        <span class="nx">change</span><span class="p">.</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_rev</span> <span class="o">=</span> <span class="nx">winningRev</span><span class="p">(</span><span class="nx">metadata</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">deleted</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">change</span><span class="p">.</span><span class="nx">deleted</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">conflicts</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">change</span><span class="p">.</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_conflicts</span> <span class="o">=</span> <span class="nx">collectConflicts</span><span class="p">(</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">rev_tree</span><span class="p">);</span>
        <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-189">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-189">&#182;</a>               </div>               <p>Dedupe the changes feed</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">var</span> <span class="nx">changeId</span> <span class="o">=</span> <span class="nx">change</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">changeIdIndex</span> <span class="o">=</span> <span class="nx">resultIndices</span><span class="p">[</span><span class="nx">changeId</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">changeIdIndex</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">results</span><span class="p">[</span><span class="nx">changeIdIndex</span><span class="p">]</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">change</span><span class="p">);</span>
        <span class="nx">resultIndices</span><span class="p">[</span><span class="nx">changeId</span><span class="p">]</span> <span class="o">=</span> <span class="nx">results</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
        <span class="nx">cursor</span><span class="p">[</span><span class="s1">&#39;continue&#39;</span><span class="p">]();</span>
      <span class="p">};</span>
    <span class="p">};</span>

    <span class="kd">function</span> <span class="nx">onTxnComplete</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">call</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">complete</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="p">{</span><span class="nx">results</span><span class="o">:</span> <span class="nx">dedupResults</span><span class="p">});</span>
    <span class="p">};</span>

    <span class="kd">function</span> <span class="nx">onerror</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">continuous</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">IdbPouch</span><span class="p">.</span><span class="nx">Changes</span><span class="p">.</span><span class="nx">addListener</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">opts</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="nx">call</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">complete</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">continuous</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="nx">cancel</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;: Cancel Changes Feed&#39;</span><span class="p">);</span>
          <span class="nx">opts</span><span class="p">.</span><span class="nx">cancelled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
          <span class="nx">IdbPouch</span><span class="p">.</span><span class="nx">Changes</span><span class="p">.</span><span class="nx">removeListener</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">id</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="nx">api</span><span class="p">.</span><span class="nx">replicate</span> <span class="o">=</span> <span class="p">{};</span>

  <span class="nx">api</span><span class="p">.</span><span class="nx">replicate</span><span class="p">.</span><span class="nx">from</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">idb_replicate_from</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">replicate</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">api</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="nx">api</span><span class="p">.</span><span class="nx">replicate</span><span class="p">.</span><span class="nx">to</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">idb_replicate_to</span><span class="p">(</span><span class="nx">dbName</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">replicate</span><span class="p">(</span><span class="nx">api</span><span class="p">,</span> <span class="nx">dbName</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="nx">api</span><span class="p">.</span><span class="nx">query</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">idb_query</span><span class="p">(</span><span class="nx">fun</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">opts</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
      <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">opts</span><span class="p">.</span><span class="nx">complete</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">fun</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">parts</span> <span class="o">=</span> <span class="nx">fun</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
      <span class="nx">api</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;_design/&#39;</span> <span class="o">+</span> <span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">doc</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">new</span> <span class="nx">viewQuery</span><span class="p">({</span>
          <span class="nx">map</span><span class="o">:</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">views</span><span class="p">[</span><span class="nx">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]].</span><span class="nx">map</span><span class="p">,</span>
          <span class="nx">reduce</span><span class="o">:</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">views</span><span class="p">[</span><span class="nx">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]].</span><span class="nx">reduce</span>
        <span class="p">},</span> <span class="nx">idb</span><span class="p">,</span> <span class="nx">opts</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">new</span> <span class="nx">viewQuery</span><span class="p">(</span><span class="nx">fun</span><span class="p">,</span> <span class="nx">idb</span><span class="p">,</span> <span class="nx">opts</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">viewQuery</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fun</span><span class="p">,</span> <span class="nx">idb</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">complete</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">sum</span><span class="p">(</span><span class="nx">values</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">values</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span> <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">txn</span> <span class="o">=</span> <span class="nx">idb</span><span class="p">.</span><span class="nx">transaction</span><span class="p">([</span><span class="nx">DOC_STORE</span><span class="p">,</span> <span class="nx">BY_SEQ_STORE</span><span class="p">],</span> <span class="s1">&#39;readonly&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">objectStore</span> <span class="o">=</span> <span class="nx">txn</span><span class="p">.</span><span class="nx">objectStore</span><span class="p">(</span><span class="nx">DOC_STORE</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">results</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">current</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">emit</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">viewRow</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">id</span><span class="o">:</span> <span class="nx">current</span><span class="p">.</span><span class="nx">_id</span><span class="p">,</span>
        <span class="nx">key</span><span class="o">:</span> <span class="nx">key</span><span class="p">,</span>
        <span class="nx">value</span><span class="o">:</span> <span class="nx">val</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">include_docs</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">viewRow</span><span class="p">.</span><span class="nx">doc</span> <span class="o">=</span> <span class="nx">current</span><span class="p">.</span><span class="nx">doc</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">viewRow</span><span class="p">);</span>
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-190">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-190">&#182;</a>               </div>               <p>We may have passed in an anonymous function that used emit in
the global scope, this is an ugly way to rescope it</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;fun.map = &#39;</span> <span class="o">+</span> <span class="nx">fun</span><span class="p">.</span><span class="nx">map</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;;&#39;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">fun</span><span class="p">.</span><span class="nx">reduce</span><span class="p">)</span> <span class="p">{</span>
      <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;fun.reduce = &#39;</span> <span class="o">+</span> <span class="nx">fun</span><span class="p">.</span><span class="nx">reduce</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;;&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">objectStore</span><span class="p">.</span><span class="nx">openCursor</span><span class="p">();</span>
    <span class="nx">request</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="nx">idbError</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
    <span class="nx">request</span><span class="p">.</span><span class="nx">onsuccess</span> <span class="o">=</span> <span class="nx">fetchMetadata</span><span class="p">;</span>

    <span class="kd">function</span> <span class="nx">viewComplete</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">results</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">collate</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span> <span class="nx">b</span><span class="p">.</span><span class="nx">key</span><span class="p">);</span>
      <span class="p">});</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">descending</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">results</span><span class="p">.</span><span class="nx">reverse</span><span class="p">();</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">reduce</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">options</span><span class="p">.</span><span class="nx">complete</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">{</span><span class="nx">rows</span><span class="o">:</span> <span class="nx">results</span><span class="p">});</span>
      <span class="p">}</span>

      <span class="kd">var</span> <span class="nx">groups</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="nx">results</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">last</span> <span class="o">=</span> <span class="nx">groups</span><span class="p">[</span><span class="nx">groups</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">last</span> <span class="o">&amp;&amp;</span> <span class="nx">Pouch</span><span class="p">.</span><span class="nx">collate</span><span class="p">(</span><span class="nx">last</span><span class="p">.</span><span class="nx">key</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nx">e</span><span class="p">.</span><span class="nx">key</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">last</span><span class="p">.</span><span class="nx">key</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">e</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">id</span><span class="p">]);</span>
          <span class="nx">last</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
          <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">groups</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="nx">key</span><span class="o">:</span> <span class="p">[</span> <span class="p">[</span><span class="nx">e</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="p">],</span> <span class="nx">value</span><span class="o">:</span> <span class="p">[</span> <span class="nx">e</span><span class="p">.</span><span class="nx">value</span> <span class="p">]});</span>
      <span class="p">});</span>

      <span class="nx">groups</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">fun</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">key</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">key</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
      <span class="p">});</span>
      <span class="nx">options</span><span class="p">.</span><span class="nx">complete</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">{</span><span class="nx">rows</span><span class="o">:</span> <span class="nx">groups</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">fetchDocData</span><span class="p">(</span><span class="nx">cursor</span><span class="p">,</span> <span class="nx">metadata</span><span class="p">,</span> <span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">current</span> <span class="o">=</span> <span class="p">{</span><span class="nx">doc</span><span class="o">:</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">,</span> <span class="nx">metadata</span><span class="o">:</span> <span class="nx">metadata</span><span class="p">};</span>
      <span class="nx">current</span><span class="p">.</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_rev</span> <span class="o">=</span> <span class="nx">winningRev</span><span class="p">(</span><span class="nx">metadata</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">deleted</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">deletions</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">deleted</span> <span class="o">=</span> <span class="nx">current</span><span class="p">.</span><span class="nx">doc</span><span class="p">.</span><span class="nx">_rev</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">in</span> <span class="nx">metadata</span><span class="p">.</span><span class="nx">deletions</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">complete</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">deleted</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">fun</span><span class="p">.</span><span class="nx">map</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">[</span><span class="nx">current</span><span class="p">.</span><span class="nx">doc</span><span class="p">]);</span>
      <span class="p">}</span>
      <span class="nx">cursor</span><span class="p">[</span><span class="s1">&#39;continue&#39;</span><span class="p">]();</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">fetchMetadata</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">cursor</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">cursor</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">viewComplete</span><span class="p">();</span>
      <span class="p">}</span>
      <span class="kd">var</span> <span class="nx">metadata</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">rev</span> <span class="o">=</span> <span class="nx">winningRev</span><span class="p">(</span><span class="nx">metadata</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">dataReq</span> <span class="o">=</span> <span class="nx">txn</span><span class="p">.</span><span class="nx">objectStore</span><span class="p">(</span><span class="nx">BY_SEQ_STORE</span><span class="p">).</span><span class="nx">index</span><span class="p">(</span><span class="s1">&#39;_rev&#39;</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="nx">rev</span><span class="p">);</span>
      <span class="nx">dataReq</span><span class="p">.</span><span class="nx">onsuccess</span> <span class="o">=</span> <span class="nx">fetchDocData</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">cursor</span><span class="p">,</span> <span class="nx">metadata</span><span class="p">);</span>
      <span class="nx">dataReq</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="nx">idbError</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">complete</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-191">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-191">&#182;</a>               </div>               <p>Functions for reading and writing an attachment in the html5 file system instead of idb</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">function</span> <span class="nx">toArray</span><span class="p">(</span><span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">list</span> <span class="o">||</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">fileErrorHandler</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;File system error&#39;</span><span class="p">,</span><span class="nx">e</span><span class="p">);</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-192">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-192">&#182;</a>               </div>               <p>Delete attachments that are no longer referenced by any existing documents</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">function</span> <span class="nx">deleteOrphanedFiles</span><span class="p">(</span><span class="nx">currentQuota</span><span class="p">){</span>
    <span class="nx">api</span><span class="p">.</span><span class="nx">allDocs</span><span class="p">({</span><span class="nx">include_docs</span><span class="o">:</span><span class="kc">true</span><span class="p">},</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">requestFileSystem</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">PERSISTENT</span><span class="p">,</span> <span class="nx">currentQuota</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fs</span><span class="p">){</span>
      <span class="kd">var</span> <span class="nx">dirReader</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">root</span><span class="p">.</span><span class="nx">createReader</span><span class="p">();</span>
      <span class="kd">var</span> <span class="nx">entries</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="kd">var</span> <span class="nx">docRows</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">rows</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-193">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-193">&#182;</a>               </div>               <p>Call the reader.readEntries() until no more results are returned.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">readEntries</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">dirReader</span><span class="p">.</span><span class="nx">readEntries</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">results</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">results</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">entries</span><span class="p">){</span>
              <span class="kd">var</span> <span class="nx">entryIsReferenced</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span>
              <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">k</span> <span class="k">in</span> <span class="nx">docRows</span><span class="p">){</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">docRows</span><span class="p">[</span><span class="nx">k</span><span class="p">].</span><span class="nx">doc</span><span class="p">){</span>
                  <span class="kd">var</span> <span class="nx">aDoc</span> <span class="o">=</span> <span class="nx">docRows</span><span class="p">[</span><span class="nx">k</span><span class="p">].</span><span class="nx">doc</span><span class="p">;</span>
                  <span class="k">if</span> <span class="p">(</span><span class="nx">aDoc</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">){</span>
                    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="k">in</span> <span class="nx">aDoc</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">){</span>
                      <span class="k">if</span> <span class="p">(</span><span class="nx">aDoc</span><span class="p">.</span><span class="nx">_attachments</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">digest</span><span class="o">==</span><span class="nx">entries</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">name</span><span class="p">)</span> <span class="nx">entryIsReferenced</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
                    <span class="p">};</span>
                  <span class="p">}</span>
                  <span class="k">if</span> <span class="p">(</span><span class="nx">entryIsReferenced</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
              <span class="p">};</span>
              <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">entryIsReferenced</span><span class="p">){</span>
                <span class="nx">entries</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">remove</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                  <span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;Removed orphaned attachment: &quot;</span><span class="o">+</span><span class="nx">entries</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">name</span><span class="p">);</span>
                <span class="p">},</span> <span class="nx">fileErrorHandler</span><span class="p">);</span>
              <span class="p">}</span>
            <span class="p">};</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">entries</span> <span class="o">=</span> <span class="nx">entries</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">toArray</span><span class="p">(</span><span class="nx">results</span><span class="p">));</span>
            <span class="nx">readEntries</span><span class="p">();</span>
          <span class="p">}</span>
        <span class="p">},</span> <span class="nx">fileErrorHandler</span><span class="p">);</span>
      <span class="p">};</span>

      <span class="nx">readEntries</span><span class="p">();</span> <span class="c1">// Start reading dirs.</span>

      <span class="p">},</span> <span class="nx">fileErrorHandler</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">writeAttachmentToFile</span><span class="p">(</span><span class="nx">digest</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">type</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-194">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-194">&#182;</a>               </div>               <p>Check the current file quota and increase it if necessary</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">storageInfo</span><span class="p">.</span><span class="nx">queryUsageAndQuota</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">PERSISTENT</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">currentUsage</span><span class="p">,</span> <span class="nx">currentQuota</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">newQuota</span> <span class="o">=</span> <span class="nx">currentQuota</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">currentQuota</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
        <span class="nx">newQuota</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="p">;</span> <span class="c1">//start with 1GB</span>
      <span class="p">}</span><span class="k">else</span> <span class="k">if</span> <span class="p">((</span><span class="nx">currentUsage</span><span class="o">/</span><span class="nx">currentQuota</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">){</span>
        <span class="nx">deleteOrphanedFiles</span><span class="p">(</span><span class="nx">currentQuota</span><span class="p">);</span> <span class="c1">//delete old attachments when we hit 80% usage</span>
      <span class="p">}</span><span class="k">else</span> <span class="k">if</span> <span class="p">((</span><span class="nx">currentUsage</span><span class="o">/</span><span class="nx">currentQuota</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.9</span><span class="p">){</span>
        <span class="nx">newQuota</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="nx">currentQuota</span><span class="p">;</span> <span class="c1">//double the quota when we hit 90% usage</span>
      <span class="p">}</span>

      <span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;Current file quota: &quot;</span><span class="o">+</span><span class="nx">currentQuota</span><span class="o">+</span><span class="s2">&quot;, current usage:&quot;</span><span class="o">+</span><span class="nx">currentUsage</span><span class="o">+</span><span class="s2">&quot;, new quota will be: &quot;</span><span class="o">+</span><span class="nx">newQuota</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-195">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-195">&#182;</a>               </div>               <p>Ask for file quota. This does nothing if the proper quota size has already been granted.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">storageInfo</span><span class="p">.</span><span class="nx">requestQuota</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">PERSISTENT</span><span class="p">,</span> <span class="nx">newQuota</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">grantedBytes</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">storageInfo</span><span class="p">.</span><span class="nx">queryUsageAndQuota</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">PERSISTENT</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">currentUsage</span><span class="p">,</span> <span class="nx">currentQuota</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">requestFileSystem</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">PERSISTENT</span><span class="p">,</span> <span class="nx">currentQuota</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fs</span><span class="p">){</span>
            <span class="nx">fs</span><span class="p">.</span><span class="nx">root</span><span class="p">.</span><span class="nx">getFile</span><span class="p">(</span><span class="nx">digest</span><span class="p">,</span> <span class="p">{</span><span class="nx">create</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fileEntry</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">fileEntry</span><span class="p">.</span><span class="nx">createWriter</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">fileWriter</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">fileWriter</span><span class="p">.</span><span class="nx">onwriteend</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                  <span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s1">&#39;Wrote attachment&#39;</span><span class="p">);</span>
                <span class="p">};</span>
                <span class="nx">fileWriter</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                  <span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s1">&#39;File write failed: &#39;</span> <span class="o">+</span> <span class="nx">e</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
                <span class="p">};</span>
                <span class="kd">var</span> <span class="nx">blob</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Blob</span><span class="p">([</span><span class="nx">data</span><span class="p">],</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="nx">type</span><span class="p">});</span>
                <span class="nx">fileWriter</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">blob</span><span class="p">);</span>
              <span class="p">},</span> <span class="nx">fileErrorHandler</span><span class="p">);</span>
            <span class="p">},</span> <span class="nx">fileErrorHandler</span><span class="p">);</span>
          <span class="p">},</span> <span class="nx">fileErrorHandler</span><span class="p">);</span>
        <span class="p">},</span> <span class="nx">fileErrorHandler</span><span class="p">);</span>
      <span class="p">},</span> <span class="nx">fileErrorHandler</span><span class="p">);</span>
    <span class="p">},</span><span class="nx">fileErrorHandler</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">readAttachmentFromFile</span><span class="p">(</span><span class="nx">digest</span><span class="p">,</span> <span class="nx">callback</span><span class="p">){</span>
    <span class="nx">storageInfo</span><span class="p">.</span><span class="nx">queryUsageAndQuota</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">PERSISTENT</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">currentUsage</span><span class="p">,</span> <span class="nx">currentQuota</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">requestFileSystem</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">PERSISTENT</span><span class="p">,</span> <span class="nx">currentQuota</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fs</span><span class="p">){</span>
        <span class="nx">fs</span><span class="p">.</span><span class="nx">root</span><span class="p">.</span><span class="nx">getFile</span><span class="p">(</span><span class="nx">digest</span><span class="p">,</span> <span class="p">{},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fileEntry</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">fileEntry</span><span class="p">.</span><span class="nx">file</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">file</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FileReader</span><span class="p">();</span>
            <span class="nx">reader</span><span class="p">.</span><span class="nx">onloadend</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">data</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">result</span><span class="p">;</span>
              <span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;Read attachment&quot;</span><span class="p">);</span>
              <span class="nx">callback</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
            <span class="p">};</span>
            <span class="nx">reader</span><span class="p">.</span><span class="nx">readAsBinaryString</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
          <span class="p">},</span> <span class="nx">fileErrorHandler</span><span class="p">);</span>
        <span class="p">},</span> <span class="nx">fileErrorHandler</span><span class="p">);</span>
      <span class="p">},</span> <span class="nx">fileErrorHandler</span><span class="p">);</span>
    <span class="p">},</span> <span class="nx">fileErrorHandler</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">api</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">IdbPouch</span><span class="p">.</span><span class="nx">valid</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">idb_valid</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">host</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s1">&#39;indexedDB cannot be used in pages served from the filesystem&#39;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="o">!!</span><span class="nb">window</span><span class="p">.</span><span class="nx">indexedDB</span> <span class="o">&amp;&amp;</span> <span class="o">!!</span><span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">host</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">IdbPouch</span><span class="p">.</span><span class="nx">destroy</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">idb_destroy</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;: Delete Database&#39;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-196">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-196">&#182;</a>               </div>               <p>delete the db id from localStorage so it doesn't get reused.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">delete</span> <span class="nx">localStorage</span><span class="p">[</span><span class="nx">name</span><span class="o">+</span><span class="s2">&quot;_id&quot;</span><span class="p">];</span>
  <span class="nx">IdbPouch</span><span class="p">.</span><span class="nx">Changes</span><span class="p">.</span><span class="nx">clearListeners</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">req</span> <span class="o">=</span> <span class="nx">indexedDB</span><span class="p">.</span><span class="nx">deleteDatabase</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>

  <span class="nx">req</span><span class="p">.</span><span class="nx">onsuccess</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">call</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="nx">req</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="nx">idbError</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
<span class="p">};</span>

<span class="nx">IdbPouch</span><span class="p">.</span><span class="nx">Changes</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

  <span class="kd">var</span> <span class="nx">api</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="kd">var</span> <span class="nx">listeners</span> <span class="o">=</span> <span class="p">{};</span>

  <span class="nx">api</span><span class="p">.</span><span class="nx">addListener</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">db</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">listeners</span><span class="p">[</span><span class="nx">db</span><span class="p">])</span> <span class="p">{</span>
      <span class="nx">listeners</span><span class="p">[</span><span class="nx">db</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span>
    <span class="nx">listeners</span><span class="p">[</span><span class="nx">db</span><span class="p">][</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">api</span><span class="p">.</span><span class="nx">removeListener</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">db</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">delete</span> <span class="nx">listeners</span><span class="p">[</span><span class="nx">db</span><span class="p">][</span><span class="nx">id</span><span class="p">];</span>
  <span class="p">}</span>

  <span class="nx">api</span><span class="p">.</span><span class="nx">clearListeners</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">db</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">delete</span> <span class="nx">listeners</span><span class="p">[</span><span class="nx">db</span><span class="p">];</span>
  <span class="p">}</span>

  <span class="nx">api</span><span class="p">.</span><span class="nx">emitChange</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">db</span><span class="p">,</span> <span class="nx">change</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">listeners</span><span class="p">[</span><span class="nx">db</span><span class="p">])</span> <span class="p">{</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">listeners</span><span class="p">[</span><span class="nx">db</span><span class="p">])</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">opts</span> <span class="o">=</span> <span class="nx">listeners</span><span class="p">[</span><span class="nx">db</span><span class="p">][</span><span class="nx">i</span><span class="p">];</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">filter</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">opts</span><span class="p">.</span><span class="nx">filter</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">[</span><span class="nx">change</span><span class="p">.</span><span class="nx">doc</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">opts</span><span class="p">.</span><span class="nx">include_docs</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">delete</span> <span class="nx">change</span><span class="p">.</span><span class="nx">doc</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">opts</span><span class="p">.</span><span class="nx">onChange</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">onChange</span><span class="p">,</span> <span class="p">[</span><span class="nx">change</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">api</span><span class="p">;</span>
<span class="p">})();</span>

<span class="nx">Pouch</span><span class="p">.</span><span class="nx">adapter</span><span class="p">(</span><span class="s1">&#39;idb&#39;</span><span class="p">,</span> <span class="nx">IdbPouch</span><span class="p">);</span>
 <span class="p">})(</span><span class="k">this</span><span class="p">);</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 